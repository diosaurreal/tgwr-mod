add_namespace = ww1_firstbalkan

news_event = {
	id = ww1_firstbalkan.112
	title = ww1_firstbalkan.112.t
	desc = ww1_firstbalkan.112.d
	picture = GFX_news_event_extermination_of_muslims
	major = yes
	fire_only_once = yes
	trigger = {
		NOT = { has_global_flag = explusion_of_muslims_from_the_balkans }
		OR = {
			has_global_flag = kis_firstbalkanwar_victory
			AND = {
				TUR = {
					NOT = {
						owns_state = 345
						controls_state = 345
						owns_state = 184
						controls_state = 184
						owns_state = 731
						controls_state = 731
					}
				}
				any_country = {
					OR = {
						original_tag = BUL
						original_tag = SER
						original_tag = MNT
						original_tag = GRE
						original_tag = ROM
					}
					owns_state = 345
					controls_state = 345
					owns_state = 184
					controls_state = 184
					owns_state = 731
					controls_state = 731
				}
			}
		}
	}
	immediate = {
		set_global_flag = explusion_of_muslims_from_the_balkans
	}
	option = {
		name = ww1_firstbalkan.112.a
		trigger = {
			original_tag = TUR
		}
		add_popularity = {
			ideology = fascism
			popularity = 0.05
		}
	}
	option = {
		name = ww1_firstbalkan.112.b
		trigger = {
			OR = {
				original_tag = BUL
				original_tag = SER
				original_tag = MNT
				original_tag = GRE
				original_tag = ROM
			}
		}
	}
	option = {
		name = ww1_firstbalkan.112.c
		trigger = {
			NOT = {
				original_tag = TUR
				original_tag = BUL
				original_tag = SER
				original_tag = MNT
				original_tag = GRE
				original_tag = ROM
			}
		}
	}
}

#Balkan league ultimatum to ottoman empire
country_event = {
	id = ww1_firstbalkan.113
	title = ww1_firstbalkan.113.t
	desc = ww1_firstbalkan.113.d
	picture = GFX_report_event_bul_military_parade_vidin
	fire_only_once = yes
	is_triggered_only = yes
	option = {
		name = ww1_firstbalkan.113.a	#no
		trigger = {
			NOT = {
				has_game_rule = {
					rule = first_balkan_war_outcome
					option = TUR_FIRST_BALKAN_WAR_AVOIDED
				}
			}
		}
		FROM = {
			country_event = {
				id = ww1_firstbalkan.114
				days = 1
			}
		}
		ai_chance = {
			factor = 400
			modifier = {
				has_game_rule = {
					rule = first_balkan_war_outcome
					option = TUR_FIRST_BALKAN_WAR_AVOIDED
				}
				factor = 0
			}
		}
	}
	option = {
		name = ww1_firstbalkan.113.b	#yes
		trigger = {
			OR = {
				is_ai = yes
				is_debug = yes
				has_game_rule = {
					rule = first_balkan_war_outcome
					option = TUR_FIRST_BALKAN_WAR_AVOIDED
				}
			}
		}
		custom_effect_tooltip = TUR_dismantle_balkan_integrity
		FROM = {
			country_event = {
				id = ww1_firstbalkan.115
				days = 1
			}
		}
		ai_chance = {
			factor = 5
			modifier = {
				is_historical_focus_on = yes
				has_game_rule = {
					rule = first_balkan_war_outcome
					option = DEFAULT
				}
				factor = 0
			}
			modifier = {
				has_game_rule = {
					rule = first_balkan_war_outcome
					option = TUR_FIRST_BALKAN_WAR_AVOIDED
				}
				factor = 9999
			}
		}
	}
}

country_event = {
	id = ww1_firstbalkan.114
	title = ww1_firstbalkan.114.t
	desc = ww1_firstbalkan.114.d
	picture = GFX_report_event_bul_military_parade_vidin
	major = yes
	fire_only_once = yes
	is_triggered_only = yes
	option = {
		name = ww1_firstbalkan.114.a	#no
		clr_global_flag = attack_TUR
		set_global_flag = kis_firstbalkan_war
		every_country = {
			limit = {
				is_in_faction_with = BLL
			}
			declare_war_on = {
				target = TUR
				type = take_state_focus
			}
			if = {
				limit = {
					country_exists = ALB
					ALB = {
						is_subject_of = TUR
					}
				}
				declare_war_on = {
					target = ALB
					type = annex_everything
				}
			}
		}
		news_event = ww1_firstbalkan.2
		hidden_effect = {
			add_named_threat = {
				threat = 5
				name = kis_firstbalkan_war
			}
			756 = {
				add_claim_by = BUL
			}		
			SER = {
				add_state_claim = 106
				add_state_claim = 203
				add_state_claim = 1140
				country_event = {
					id = ww1_firstbalkan.118
					days = 10
				}
			}
			TUR = {
				country_event = {
					id = ww1_firstbalkan.3
					days = 42
				}
			}
		}
		BUL = {
			if = {
				limit = {
					has_country_flag = lozengradska_operacija
				}
				add_ideas = BUL_idea_lozengradska_operacija
			}
		}
		hidden_effect = {
			TUR = {
				country_event = {
					id = ottoman.212
					hours = 8
				}
			}
		}
	}
}

	
country_event = {
	id = ww1_firstbalkan.115
	title = ww1_firstbalkan.115.t
	desc = ww1_firstbalkan.115.d
	picture = GFX_report_event_bul_military_parade_vidin
	major = yes
	fire_only_once = yes
	is_triggered_only = yes
	immediate = {
		set_global_flag = BW1_avoided
	}
	option = {
		name = ww1_firstbalkan.115.a
		set_global_flag = kis_firstbalkanwar_victory
		every_country = {
			limit = {
				OR = {
					is_in_faction_with = BUL
					is_in_faction_with = SER
				}
			}
			set_country_flag = BW1_winner
		}
		hidden_effect = {
			if = {
				limit = {
					country_exists = IKR
				}
				TUR = { white_peace = IKR }
				GRE = {
					IKR = { get_current_government_type = yes }
					set_autonomy = {
						target = IKR
						autonomy_state = autonomy_tgwr_unilateral_union
					}
					IKR = {
						restore_previous_government_type = yes
						remove_ideas = standing_alone
					}
				}
			}
			TUR = {
				release_puppet = ALB
				TUR_ahmet_izzet = {
					set_nationality = ALB
					set_character_name = ALB_ahmet_izzet
					hidden_effect = {
						remove_country_leader_role = {
							ideology = authoritarian_democracy
						}
					}
					add_country_leader_role = {
						promote_leader = yes
						country_leader = {
							ideology = semi_constitutional_monarchy
							traits = { ottoman_prince }
						}
					}
				}
				ALB = {
					add_popularity = {
						ideology = neutrality
						popularity = 0.10
					}
					set_cosmetic_tag = ALB_sultanate
					set_politics={
						ruling_party = neutrality
						elections_allowed = no 
						long_name = ALB_neutrality_sultan_party
						name = ALB_neutrality_sultan_party
					}
				}
				every_owned_state = {
					limit = {
						OR = {
							is_core_of = ALB
							is_core_of = SER
							is_core_of = MNT
							state = 758
						}
						NOT = {
							is_core_of = TUR
						}
					}
					transfer_state_to = ALB
				}
				every_owned_state = {
					limit = {
						OR = {
							state = 106
							state = 203
							state = 731
							state = 826
							state = 345
							state = 759
							state = 225
							state = 788
							state = 184
							state = 1140
							state = 1141
						}
					}
					transfer_state_to = MAC
					add_core_of = MAC
				}
				826 = {
					transfer_state_to = MAC
				}
				MAC = {
					set_politics = {
						ruling_party = neutrality
						elections_allowed = no
					}
					set_popularities = {
						democratic = 30
						neutrality = 60
						fascism = 10
						communism = 0
					}
					set_country_flag = turkish_concession
					set_cosmetic_tag = MAC_ottoman
				}
			}
			TUR = {
				ALB = {
					set_country_flag = protectorate
					add_ideas = TUR_wavering_ottoman_influence
				}
				set_autonomy = {
					target = ALB
					autonomous_state = autonomy_tgwr_protectorate
				}
				MAC = {
					set_country_flag = protectorate
					add_ideas = TUR_wavering_ottoman_influence
				}
				set_autonomy = {
					target = MAC
					autonomous_state = autonomy_tgwr_integrated_protectorate
				}
			}
			every_country = {
				limit = {
					has_country_flag = BW1_winner
				}
				give_guarantee = ALB
				give_guarantee = MAC
				set_truce = {
					target = ALB
					days = 365
				}
				set_truce = {
					target = MAC
					days = 365
				}
				set_truce = {
					target = TUR
					days = 365
				}
			}
			every_state = {
				limit = {
					OWNER = {
						is_subject_of = TUR
					}
					OR = {
						is_core_of = SER
						is_core_of = BUL
						is_core_of = GRE
						is_core_of = MNT
						is_core_of = MAC
					}
					NOT = {
						state = 345 #solun
						state = 871 #vlore
						state = 44 #albania
						state = 974 #samos
						state = 975 #ikaria
					}
				}
				set_demilitarized_zone = yes
			}
			transfer_units_fraction= {
				target = MAC
				size = 0
				target_organization = 1
				source_organization = 1
				stockpile_ratio = 0.01
				army_ratio = 0
				navy_ratio = 0
				air_ratio = 0
			}
			MAC = {
				transfer_navy = {
					target = TUR
				}
				add_named_threat = {
					threat = 1
					name = ww1_firstbalkan.117.t
				}
			}
			if = {
				limit = {
					ALB = {
						has_army_manpower = {
							size < 15000
						}
					}
				}
				transfer_units_fraction= {
					target = ALB
					size = 0
					target_organization = 1
					source_organization = 1
					stockpile_ratio = 0.015
					army_ratio = 0.1
					navy_ratio = 0
					air_ratio = 0
				}
				ALB = {
					transfer_navy = {
						target = TUR
					}
				}
			}
			BLL = {
				if = {
					limit = { has_war = no }
					dismantle_faction = yes
				}
			}
			news_event = {
				id = ww1_firstbalkan.117
				hours = 3
			}
		}
	}
}

# Lone Liberator news
news_event = {
	id = ww1_firstbalkan.116
	title = ww1_firstbalkan.2.t
	desc = ww1_firstbalkan.116.d
	picture = GFX_news_event_bulgarian_troops
	is_triggered_only = yes
	major = yes
	option = {
		name = ww1_firstbalkan.2.a
	}
}

# Ottoman surrenders the Balkans news
news_event = {
	id = ww1_firstbalkan.117
	title = ww1_firstbalkan.117.t
	desc = ww1_firstbalkan.117.d
	picture = GFX_news_event_bulgarian_troops
	is_triggered_only = yes
	major = yes
	option = {
		name = ww1_firstbalkan.117.a
		trigger = {
			NOT = { original_tag = TUR }
		}
	}
	option = {
		name = ww1_firstbalkan.117.b
		trigger = {
			original_tag = TUR
		}
	}
}

# Serbian thieving notification
country_event = {
	id = ww1_firstbalkan.118
	title = ww1_firstbalkan.118.t
	desc = ww1_firstbalkan.118.d
	picture = GFX_report_event_yugoslavia_partisans
	is_triggered_only = yes
	trigger = {
		has_capitulated = no
		is_subject = no
		has_war = yes
		NOT = { owns_state = 203 }
		106 = { is_controlled_by_ROOT_or_ally = yes }
		203 = { is_controlled_by_ROOT_or_ally = yes }
	}
	option = {
		name = ww1_firstbalkan.118.a
		add_state_claim = 106
		add_state_claim = 203
		add_state_claim = 1140
		every_state = {
			limit = {
				OR = {
					state = 106
					state = 203
					state = 1140
				}
				is_controlled_by_ROOT_or_ally = yes
				NOT = { is_controlled_by = ROOT }
			}
			set_state_controller_to = ROOT
		}
	}
}