add_namespace = ww1_brest_litovsk
add_namespace = ww1_brest_litovsk_ukraine
####################	BREST-LITOVSK TREATY ####################
# SOVIETS OFFER TREATY. ANSWER OF GERMANY.
#######################
country_event = {
	id = ww1_brest_litovsk.1
	title = ww1_brest_litovsk.1.t
	desc = ww1_brest_litovsk.1.d
	picture = GFX_report_event_generic_conference
	is_triggered_only = yes
	trigger = {
		NOT = {
			has_global_flag = compiegne_armistice
		}
	}
	immediate = {
		set_global_flag = brest_litovsk_negotiations
	}
	fire_only_once = yes
	#At last...
	option = {
		name = ww1_brest_litovsk.1.a
		effect_tooltip = {
			add_ideas = RUS_idea_armistice_cp
		}
		FROM = {
			country_event = {
				id = ww1_brest_litovsk.2
				days = 1
			}
		}
		ai_chance = {
			base = 100
		}
	}
}
# Soviets - There will be annexations
country_event = {
	id = ww1_brest_litovsk.2
	title = ww1_brest_litovsk.2.t
	desc = ww1_brest_litovsk.2.d
	picture = GFX_report_event_generic_conference
	is_triggered_only = yes
	trigger = {
		NOT = {
			has_global_flag = compiegne_armistice
		}
		has_global_flag  = brest_litovsk_negotiations
	}
	fire_only_once = yes
	immediate = {
		hidden_effect = {
			add_ideas = RUS_idea_armistice_rus
			every_country = {
				limit = {
					OR = {
						tag = FROM
						is_in_faction_with = FROM
					}
				}
				add_ideas = RUS_idea_armistice_cp
			}
		}
	}
	#Worth a shot
	option = {
		name = ww1_brest_litovsk.2.a
		FROM = {
			country_event = {
				id = ww1_brest_litovsk.3
				days = 23
			}
		}
		effect_tooltip = {
			add_ideas = RUS_idea_armistice_rus
		}
		ai_chance = {
			base = 100
		}
	}
}
#Germany - Our demands
country_event = {
	id = ww1_brest_litovsk.3
	title = ww1_brest_litovsk.3.t
	desc = ww1_brest_litovsk.3.d
	picture = GFX_report_event_generic_conference
	is_triggered_only = yes
	trigger = {
		NOT = {
			has_global_flag = compiegne_armistice
		}
		has_global_flag  = brest_litovsk_negotiations
	}
	fire_only_once = yes
	#Send them at once!
	option = {
		name = ww1_brest_litovsk.3.a	
		FROM = {
			country_event = {
				id = ww1_brest_litovsk.4
				days = 1
			}
		}
		ai_chance = {
			base = 100
		}
	}
}
#Soviets - German demands
country_event = {
	id = ww1_brest_litovsk.4
	title = ww1_brest_litovsk.4.t
	desc = ww1_brest_litovsk.4.d
	picture = GFX_report_event_generic_conference
	is_triggered_only = yes
	trigger = {
		NOT = {
			has_global_flag = compiegne_armistice
		}
		has_global_flag  = brest_litovsk_negotiations
	}
	fire_only_once = yes
	#Trotsky stalls the negotiations
	option = {
		name = ww1_brest_litovsk.4.a
		FROM = {
			country_event = {
				id = ww1_brest_litovsk.5
				days = 23
			}
		}
		ai_chance = {
			base = 100
		}
	}
}
#Soviets stall the negotiations
country_event = {
	id = ww1_brest_litovsk.5
	title = ww1_brest_litovsk.5.t
	desc = ww1_brest_litovsk.5.d
	picture = GFX_report_event_generic_conference
	is_triggered_only = yes
	trigger = {
		NOT = {
			has_global_flag = compiegne_armistice
		}
		has_global_flag  = brest_litovsk_negotiations
	}
	fire_only_once = yes
	#Demand MORE
	option = {
		name = ww1_brest_litovsk.5.a
		set_global_flag = brest_litovsk_german_ultimatum
		FROM = {
			country_event = {
				id = ww1_brest_litovsk.6
				days = 1
			}
		}
		ai_chance = {
			base = 100
		}
	}
	#Send an ultimatum
	option = {
		name = ww1_brest_litovsk.6.b
		FROM = {
			country_event = {
				id = ww1_brest_litovsk.7
				days = 1
			}
		}
	}
}
#Germans demand more!
country_event = {
	id = ww1_brest_litovsk.6
	title = ww1_brest_litovsk.6.t
	desc = ww1_brest_litovsk.6.d
	picture = GFX_report_event_generic_conference
	is_triggered_only = yes
	trigger = {
		NOT = {
			has_global_flag = compiegne_armistice
		}
	}
	fire_only_once = yes
	#We reject this nonsense!
	option = {
		name = ww1_brest_litovsk.6.a
		set_global_flag = brest_litovsk_operation_faustschlag
		FROM = {
			country_event = {
				id = ww1_brest_litovsk.8
				days = 1
			}
		}
		ai_chance = {
			base = 100
		}
	}
	#we humbly bend over...
	option = {
		name = ww1_brest_litovsk.6.b
		FROM = {
			country_event = {
				id = ww1_brest_litovsk.11
				days = 1
			}
		}
	}
}
#Soviets - German ultimatum!
country_event = {
	id = ww1_brest_litovsk.7
	title = ww1_brest_litovsk.7.t
	desc = ww1_brest_litovsk.7.d
	picture = GFX_report_event_generic_conference
	is_triggered_only = yes
	trigger = {
		NOT = {
			has_global_flag = compiegne_armistice
		}
	}
	fire_only_once = yes
	#Alright alright we sign the peace!
	option = {
		name = ww1_brest_litovsk.7.a
		FROM = {
			country_event = {
				id = ww1_brest_litovsk.11
				days = 1
			}
		}
		ai_chance = {
			base = 100
		}
	}
	#Workers of the world, unite!
	option = {
		name = ww1_brest_litovsk.7.a
		FROM = {
			country_event = {
				id = ww1_brest_litovsk.8
				days = 1
			}
		}
	}
}
#Soviets reject the ultimatum!
country_event = {
	id = ww1_brest_litovsk.8
	title = ww1_brest_litovsk.8.t
	desc = ww1_brest_litovsk.8.d
	picture = GFX_report_event_generic_conference
	is_triggered_only = yes
	trigger = {
		NOT = {
			has_global_flag = compiegne_armistice
		}
	}
	fire_only_once = yes
	immediate = {
		hidden_effect = {
			every_country = {
				limit = {
					OR = {
						has_idea = RUS_idea_armistice_cp
						has_idea = RUS_idea_armistice_rus
					}
				}
				remove_ideas = {
					RUS_idea_armistice_cp
					RUS_idea_armistice_rus
				}
			}
		}
	}
	#They leave us no choice
	option = {
		name = ww1_brest_litovsk.8.a
		FROM = {
			country_event = {
				id = ww1_brest_litovsk.9
				days = 14
			}
		}
		ai_chance = {
			base = 100
		}
	}
}
#Germans advance!
country_event = {
	id = ww1_brest_litovsk.9
	title = ww1_brest_litovsk.9.t
	desc = ww1_brest_litovsk.9.d
	picture = GFX_report_event_generic_conference
	is_triggered_only = yes
	trigger = {
		NOT = {
			has_global_flag = compiegne_armistice
		}
	}
	fire_only_once = yes
	#Alright we agree
	option = {
		name = ww1_brest_litovsk.9.a
		FROM = {
			country_event = {
				id = ww1_brest_litovsk.11
				days = 1
			}
		}
		ai_chance = {
			base = 100
		}
	}
	#Workers of the world, unite!
	option = {
		name = ww1_brest_litovsk.9.b
	}
}
#Brest Litovsk negotiations conclude
country_event = {
	id = ww1_brest_litovsk.11
	title = ww1_brest_litovsk.11.t
	desc = ww1_brest_litovsk.11.d
	picture = GFX_report_event_generic_conference
	is_triggered_only = yes
	trigger = {
		NOT = {
			has_global_flag = compiegne_armistice
		}
	}
	fire_only_once = yes
	immediate = {
		hidden_effect = {
			if = {
				limit = {
					POL = {
						OR = {
							exists = no
							NOT = {
								is_subject_of = ROOT
							}
						}
					}
				}
				every_state = {
					limit = {
						owner = {
							OR = {
								tag = SOV
								is_subject_of = SOV
							}
						}
						OR = {
							state = 10
							state = 87
							state = 90
							state = 92
							state = 98
							state = 766
						}
					}
					transfer_state_to = ROOT
				}
			}
			every_state = {
				limit = {
					owner = {
						OR = {
							tag = SOV
							is_subject_of = SOV
						}
					}
					OR = {
						state = 11
						state = 12
						state = 97
						state = 189
						state = 190
						state = 773
						state = 784
						state = 946
						state = 948
						state = 949
						state = 951
						state = 954
						state = 1015
					}
				}
				transfer_state_to = ROOT
			}
			if = {
				limit = {
					OR = {
						has_global_flag = brest_litovsk_german_ultimatum
						has_global_flag = brest_litovsk_operation_faustschlag
					}
				}
				every_state = {
					limit = {
						owner = {
							OR = {
								tag = SOV
								is_subject_of = SOV
							}
						}
						OR = {
							state = 13
							state = 96
							state = 191
							state = 950
							state = 952
							state = 953
						}
					}
					transfer_state_to = ROOT
				}
			}
			if = {
				limit = {
					has_global_flag = brest_litovsk_operation_faustschlag
					UPR = {
						exists = yes
						is_subject_of = ROOT
					}
				}
				every_state = {
					limit = {
						owner = {
							OR = {
								tag = SOV
								is_subject_of = SOV
							}
						}
						OR = {
							state = 94
							state = 95
							state = 96
							state = 194
							state = 204
							state = 206
							state = 209
							state = 241
							state = 808
							state = 913
							state = 945
							state = 947
						}
					}
					transfer_state_to = ROOT
				}
			}
			if = {
				limit = {
					UPR = {
						exists = yes
						is_subject_of = ROOT
					}
				}
				every_country = {
					limit = {
						OR = {
							tag = USR
							tag = RUC
							tag = DKR
							original_tag = CRI
						}
					}
					SOV = {
						end_puppet = PREV
						remove_from_faction = PREV
					}
					every_country = {
						limit = {
							NOT = {
								tag = ROOT
								tag = UPR
								is_in_faction_with = ROOT
							}
							has_war_with = PREV
						}
						white_peace = PREV
					}
				}
				if = {
					limit = {
						has_global_flag = brest_litovsk_operation_faustschlag
					}
					every_state = {
						limit = {
							owner = {
								OR = {
									tag = SOV
									is_subject_of = SOV
									tag = ROOT
									is_subject_of = ROOT
								}
							}
							OR = {
								state = 94
								state = 194
								state = 241
								state = 808
							}
						}
						transfer_state_to = UPR
					}
				}
			}
			every_country = {
				limit = {
					has_war_with = ROOT
					OR = {
						original_tag = UKR
						tag = SOV
						is_in_faction_with = SOV
						is_subject_of = SOV
					}
				}
				every_country = {
					limit = {
						has_war_with = PREV
						OR = {
							tag = ROOT
							tag = ROM
							is_in_faction_with = ROOT
						}
					}
					white_peace = PREV
				}
			}
			set_global_flag = brest_litovsk_peace_concluded
			set_global_flag = russ_kapitulation
		}
	}
	#At last
	option = {
		name = ww1_brest_litovsk.11.a
		ai_chance = {
			base = 100
		}
	}
}
#Ukraine - Peace with Germany?
country_event = {
	id = ww1_brest_litovsk_ukraine.1
	title = ww1_brest_litovsk_ukraine.1.t
	desc = ww1_brest_litovsk_ukraine.1.d
	picture = GFX_report_event_generic_conference
	trigger = {
		tag = UKR
		has_war_with = GER
		has_country_flag = UKR_upr
		is_subject = no
		is_in_faction = no
		has_global_flag = brest_litovsk_negotiations
		NOT = {
			has_global_flag = brest_litovsk_peace_concluded
			has_global_flag = compiegne_armistice
		}
	}
	#There is nothing we can do
	option = {
		name = ww1_brest_litovsk_ukraine.1.a
		country_event = {
			id = ww1_brest_litovsk_ukraine.2
			days = 30
		}
	}	
}	
#Germany - Peace with Ukraine?
country_event = {
	id = ww1_brest_litovsk_ukraine.2
	title = ww1_brest_litovsk_ukraine.2.t
	desc = ww1_brest_litovsk_ukraine.2.d
	picture = GFX_report_event_generic_conference
	is_triggered_only = yes
	fire_only_once = yes
	#More!
	option = {
		name = ww1_brest_litovsk_ukraine.2.a
		effect_tooltip = {
			ROOT = {
				set_autonomy = {
					target = UPR
					autonomy_state = autonomy_tgwr_informal_protectorate
					end_civil_wars = no
					end_wars = no
				}
			}
		}
		hidden_effect = {
			every_country = {
				limit = {
					OR = {
						tag = ROOT
						is_in_faction_with = ROOT
					}
				}
				UPR = {
					white_peace = PREV
				}
			}
			set_global_flag = ukr_ger_bread_peace 
			UPR = {
				get_current_government_type = yes
				set_country_flag = protectorate
				ROOT = {
					set_autonomy = {
						target = PREV
						autonomy_state = autonomy_tgwr_informal_protectorate
						end_civil_wars = no
						end_wars = no
					}
				}
				restore_previous_government_type = yes
			}
			if = {
				limit = {
					has_active_mission = GER_mission_famine_timer_early
				}
				add_days_mission_timeout = {
					mission = GER_mission_famine_timer_early
					days = 90
				}
				else = {
					add_days_mission_timeout = {
						mission = GER_mission_famine_timer
						days = 70
					}
				}
			}
		}
		ai_chance = {
			base = 100
		}
	}
}