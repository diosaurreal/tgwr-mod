RCW_core_state_FROM = {
	add_state_core = FROM
	if = {
		limit = { 
			FROM = { is_claimed_by = PREV }
		}
		remove_state_claim = FROM
	}
	FROM = {
		if = {
			limit = { 
				OWNER = { is_russian_tag = yes }					
			}
			if = {
				limit = {
					is_capital = no
					OWNER = {
						any_owned_state = {
							NOT = { state = FROM }
						}
					}				
				}
				add_contested_owner = OWNER
				set_state_owner_to = PREV
			}
			else = {
				add_contested_owner = PREV
			}
		}
	}
	every_possible_country = {
		limit = {			
			original_tag = RUS
			NOT = { tag = PREV }
			FROM = { is_core_of = PREV }
		}
		remove_state_core = FROM
		if = {
			limit = { exists = yes }
			add_state_claim = FROM
		}		
	}
}
RCW_transfer_state_PREV = {
	every_other_country = {
		limit = {
			has_war_with = PREV.PREV.OWNER
			OR = {
				controls_state = PREV.PREV
				divisions_in_state = {
					state = PREV.PREV
					size > 0			
				}
			}			
		}
		PREV = { give_military_access = PREV }
	}
	PREV = { add_contested_owner = OWNER }
	transfer_state = PREV
}
RCW_core_state_PREV = {
	add_state_core = PREV
	every_other_country = {
		limit = {
			original_tag = RUS
			any_core_state = { state = PREV.PREV.PREV }
		}
		remove_state_core = PREV.PREV
		add_state_claim = PREV.PREV
	}
	PREV = {
		if = {
			limit = {
				NOT = { is_core_of = OWNER }
				has_resistance = no
			}
			start_resistance = yes
		}
	}
}
RCW_transfer_core_state_PREV = {
	RCW_transfer_state_PREV = yes
	RCW_core_state_PREV = yes
}
RCW_ROOT_release_PREV = {
	ROOT = {
		remove_state_claim = prev.prev
		remove_state_core = prev.prev
		remove_contested_owner = prev.prev
	}
	add_state_core = PREV
	if = {
		limit = {
			PREV = { OWNER = { tag = ROOT } }	
		}
		safe_transfer_state_to = yes
	}
	else = {
		add_contested_owner = PREV
	}
}
RCW_ROOT_fuze_with_FROM = {
	take_all_subjects_FROM = yes
	annex_country = {
		target = FROM
		transfer_troops = yes
	}
	hidden_effect = {
		FROM = {
			if = {
				limit = { 
					ROOT = {
						OR = {
							has_country_leader_ideology = vanguardism
							has_country_leader_ideology = revolutionary_socialism
						}
					}
				}
				every_unit_leader = {
					limit = {
						has_character_flag = soviet_character
					}
					set_nationality = ROOT
				}
			}
			else = {
				every_unit_leader = {
					limit = {
						NOT = {
							has_character_flag = soviet_character
						}			
					}
					set_nationality = ROOT
				}
			}
		}
		if = {
			limit = {
				is_ai = yes
				FROM = { is_ai = no }
			}
			change_tag_from = FROM
		}	
		every_state = {
			limit = {
				is_core_of = FROM
			}
			remove_core_of = FROM
			add_core_of = ROOT
		}
		every_state = {
			limit = {
				is_claimed_by = FROM
			}
			remove_claim_by = FROM
			add_claim_by = ROOT
		}
		every_state = {
			limit = {
				has_contested_owner = FROM
			}
			remove_contested_owner = FROM
			add_contested_owner = ROOT
		}
	}
}
RCW_THIS_fuze_with_PREV = {
	take_all_subjects_PREV = yes
	annex_country = {
		target = PREV
		transfer_troops = yes
	}
	hidden_effect = {
		PREV = {
			if = {
				limit = { 
					PREV = {
						OR = {
							has_country_leader_ideology = vanguardism
							has_country_leader_ideology = revolutionary_socialism
						}
					}
				}
				every_unit_leader = {
					limit = {
						is_generic_character = no
						has_character_flag = soviet_character
					}
					set_nationality = PREV.PREV
				}
			}
			else = {
				every_unit_leader = {
					limit = {
						is_generic_character = no
						NOT = {
							has_character_flag = soviet_character
						}			
					}
					set_nationality = PREV.PREV
				}
			}
		}
		if = {
			limit = {
				is_ai = yes
				FROM = { is_ai = no }
			}
			change_tag_from = PREV
		}	
		every_state = {
			limit = {
				is_core_of = PREV.PREV
			}
			remove_core_of = PREV.PREV
			add_core_of = PREV
		}
		every_state = {
			limit = {
				is_claimed_by = PREV.PREV
			}
			remove_claim_by = PREV.PREV
			add_claim_by = PREV
		}
		every_state = {
			limit = {
				has_contested_owner = PREV.PREV
			}
			remove_contested_owner = PREV.PREV
			add_contested_owner = PREV
		}
	}
}

improve_RCW_lack_of_officers = {
	if = {
		limit = { has_idea = RCW_lack_of_officers1 }
		swap_ideas = {
			remove_idea = RCW_lack_of_officers1
			add_idea = RCW_lack_of_officers2
		}
	}
	else_if = {
		limit = { has_idea = RCW_lack_of_officers2 }
		swap_ideas = {
			remove_idea = RCW_lack_of_officers2
			add_idea = RCW_lack_of_officers3
		}
	}
	else_if = {
		limit = { has_idea = RCW_lack_of_officers3 }
		remove_ideas = RCW_lack_of_officers3
		clr_country_flag = RCW_lack_of_officers3
	}
}

get_RCW_lack_of_officers = {
	if = {
		limit = { 
			has_country_flag = RCW_lack_of_officers3
		}
		add_ideas = RCW_lack_of_officers3  
	}
	else_if = {
		limit = { 
			has_country_flag = RCW_lack_of_officers2
		}
		add_ideas = RCW_lack_of_officers2 
	}
	else_if = {
		limit = {
			OR = {
				has_country_flag = RCW_lack_of_officers1
				has_focus_tree = white_guard_focus
			}		
		}
		add_ideas = RCW_lack_of_officers1
	}	
}	