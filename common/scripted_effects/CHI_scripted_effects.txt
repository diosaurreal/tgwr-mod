kmt_united_china_historical = {
	set_cosmetic_tag = CHI_united
	remove_ideas = CHI_idea_government_divided
	remove_ideas = CHI_idea_unstable_republic
	set_politics = {
		ruling_party = neutrality
		elections_allowed = no
	}
	set_popularities = {
		neutrality = 100
	}
	set_party_name = {
		ideology = neutrality
		long_name = CHI_kuomintang_party_long
		name = CHI_kuomintang_party
	}
	set_party_name = {
		ideology = democratic
		long_name = CHI_kuomintang_party_long
		name = CHI_kuomintang_party
	}
	set_party_name = {
		ideology = communism
		long_name = CHI_left_kuomintang_party_long
		name = CHI_left_kuomintang_party
	}
	set_party_name = {
		ideology = fascism
		long_name = CHI_kuomintang_party_long
		name = CHI_kuomintang_party
	}
	CHI = {
		CHI_chiang_kaishek = {
			set_nationality = PREV.PREV
			if = {
				limit = { has_ideology = civilian_dictatorship }
				promote_character = civilian_dictatorship
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						ideology = civilian_dictatorship
						traits = { anti_communist generallissimo }
					}
					promote_leader = yes
				}
			}
		}
		CHI_wang_jingwei = {
			set_nationality = PREV.PREV
			if = {
				limit = { has_ideology = fascism_ideology }
				promote_character = fascism_ideology
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						ideology = fascism_ideology
						traits = { japanizer }
					}
					promote_leader = yes
				}
			}
		}
		CHI_hu_hanmin = {
			set_nationality = PREV.PREV
			if = {
				limit = { has_ideology = tridemism }
				promote_character = tridemism
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						ideology = tridemism
						traits = { conservative_nationalist }
					}
					promote_leader = yes
				}
			}
		}
	}
	ANC = {
		ANC_deng_yanda = {
			set_nationality = PREV.PREV
			if = {
				limit = { has_ideology = reformist_socialism }
				promote_character = reformist_socialism
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						ideology = reformist_socialism
						traits = { anti_communist generallissimo }
					}
					promote_leader = yes
				}
			}
		}
	}
}

QIN_restore_xuantong = {
	if = {
		limit = {
			date > 1922.2.1
		}
		if = {
			limit = {
				NOT = { has_global_flag = puyi_age }
			}
			set_global_flag = puyi_age
		}
		if = {
			limit = {
				date > 1925.1.1
			}
			add_ideas = QIN_idea_xuantong
			else = {
				add_ideas = QIN_idea_xuantong_young
			}
		}
		hidden_effect = {
			QIN = {
				QIN_xuantong = {
					set_nationality = PREV.PREV
				}
			}
			if = {
				limit = {
					has_government = neutrality
					is_qing_monarchy = yes
					has_country_leader_ideology = semi_constitutional_monarchy
				}
				QIN_xuantong = {
					promote_character = semi_constitutional_monarchy
				}
			}
		}
	}
	else = {
		add_ideas = QIN_idea_xuantong_young
	}
}

reunited_chinese_name = {
	## COUNTRY NAME SELECTION ##
	# Qing
	## No more republic, but restorate the Great Qing
	if = {
		limit = {
			is_qing_monarchy = yes
		}
		set_cosmetic_tag = QIN
	}
	# United Provinces of China
	## Federalist Chen Jiongming
	else_if = {
		limit = {
			any_character = {
				is_country_leader = yes
				has_character_flag = federalist_allegiance
			}
		}
		set_cosmetic_tag = CHI_reformed_democratic
	}
	# Kuomintang
	## Republic of China
	else_if = {
		limit = {
			OR = {
				has_cosmetic_tag = KMT_BEIPING
				has_cosmetic_tag = KMT_WUHAN
				has_cosmetic_tag = KMT_NANJING
				has_cosmetic_tag = CPG
				has_cosmetic_tag = GXC_KMT
				AND = {
					any_character = {
						is_country_leader = yes
						has_character_flag = kmt_allegiance
					}
					has_government = democratic
				}
				is_kuomintang_state = yes
				has_country_leader_ideology = tridemism
			}
		}
		set_cosmetic_tag = CHI_united
	}
	# Communists
	## Chinese Soviet Republic or People's Republic of China
	else_if = {
		limit = {
			OR = {
				has_government = communism
				original_tag = PRC
			}
		}
		set_cosmetic_tag = CSR
	}
	# Major cliques
	## They would just unify China under the legitimate government of the Republic of China
	else_if = {
		limit = {
			OR = {
				original_tag = ANC
				original_tag = ZHC
				original_tag = FNG
				original_tag = GXC
				original_tag = SHX
			}
		}
		set_cosmetic_tag = CHI
	}
	# Other warlords
	else = {
		set_cosmetic_tag = CHI_reformed
	}
}

chinese_flag_replacement = {
	if = {
		limit = {
			original_tag = GXC
		}
		set_cosmetic_tag = GXC_KMT
	}
	else_if = {
		limit = {
			original_tag = YUN
		}
		set_cosmetic_tag = YUN_KMT
	}
	else_if = {
		limit = {
			original_tag = XSM
		}
		set_cosmetic_tag = XSM_KMT
	}
	else_if = {
		limit = {
			original_tag = FNG
		}
		set_cosmetic_tag = FNG_KMT
	}
	else_if = {
		limit = {
			original_tag = SCC
		}
		set_cosmetic_tag = SCC_KMT
	}
	else_if = {
		limit = {
			original_tag = XKC
		}
		set_cosmetic_tag = XKC_KMT
	}
	else_if = {
		limit = {
			original_tag = SHX
		}
		set_cosmetic_tag = SHX_KMT
	}
	else_if = {
		limit = {
			original_tag = GZC
		}
		set_cosmetic_tag = GZC_KMT
	}
	else_if = {
		limit = {
			original_tag = SIK
		}
		set_cosmetic_tag = SIK_KMT
	}
}

CHI_popular_support_increase = {
	if = {
		limit = {
			has_idea = CHI_idea_no_popular_support
		}
		swap_ideas = {
			remove_idea = CHI_idea_no_popular_support
			add_idea = CHI_idea_weak_popular_support
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_weak_popular_support
		}
		swap_ideas = {
			remove_idea = CHI_idea_weak_popular_support
			add_idea = CHI_idea_improved_popular_support
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_improved_popular_support
		}
		swap_ideas = {
			remove_idea = CHI_idea_improved_popular_support
			add_idea = CHI_idea_good_popular_support
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_good_popular_support
		}
		add_stability = 0.02
	}
	else = {
		add_ideas = CHI_idea_no_popular_support
	}
}

CHI_popular_support_decrease = {
	if = {
		limit = {
			has_idea = CHI_idea_good_popular_support
		}
		swap_ideas = {
			remove_idea = CHI_idea_good_popular_support
			add_idea = CHI_idea_improved_popular_support
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_improved_popular_support
		}
		swap_ideas = {
			remove_idea = CHI_idea_improved_popular_support
			add_idea = CHI_idea_weak_popular_support
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_weak_popular_support
		}
		
		swap_ideas = {
			remove_idea = CHI_idea_weak_popular_support
			add_idea = CHI_idea_no_popular_support
		}
	}
	else = {
		add_stability = -0.02
	}
}

CHI_army_support_increase = {
	if = {
		limit = {
			has_idea = CHI_idea_no_army_support
		}
		swap_ideas = {
			remove_idea = CHI_idea_no_army_support
			add_idea = CHI_idea_weak_army_support
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_weak_army_support
		}
		swap_ideas = {
			remove_idea = CHI_idea_weak_army_support
			add_idea = CHI_idea_improved_army_support
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_improved_army_support
		}
		swap_ideas = {
			remove_idea = CHI_idea_improved_army_support
			add_idea = CHI_idea_good_army_support
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_good_army_support
		}
		swap_ideas = {
			remove_idea = CHI_idea_good_army_support
			add_idea = CHI_idea_guaranteed_army_support
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_guaranteed_army_support
		}
		add_war_support = 0.02
	}
	else = {
		add_ideas = CHI_idea_no_army_support
	}
}

CHI_army_support_decrease = {
	if = {
		limit = {
			has_idea = CHI_idea_guaranteed_army_support
		}
		swap_ideas = {
			remove_idea = CHI_idea_guaranteed_army_support
			add_idea = CHI_idea_good_army_support
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_good_army_support
		}
		swap_ideas = {
			remove_idea = CHI_idea_good_army_support
			add_idea = CHI_idea_improved_army_support
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_improved_army_support
		}
		swap_ideas = {
			remove_idea = CHI_idea_improved_army_support
			add_idea = CHI_idea_weak_army_support
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_weak_army_support
		}
		
		swap_ideas = {
			remove_idea = CHI_idea_weak_army_support
			add_idea = CHI_idea_no_army_support
		}
	}
	else = {
		add_war_support = -0.02
	}
}

QIN_legitimacy_increase = {
	if = {
		limit = {
			has_idea = QIN_idea_low_legitimacy
		}
		swap_ideas = {
			remove_idea = QIN_idea_low_legitimacy
			add_idea = QIN_idea_low_legitimacy_2
		}
	}
	else_if = {
		limit = {
			has_idea = QIN_idea_low_legitimacy_2
		}
		swap_ideas = {
			remove_idea = QIN_idea_low_legitimacy_2
			add_idea = QIN_idea_low_legitimacy_3
		}
	}
	else_if = {
		limit = {
			has_idea = QIN_idea_low_legitimacy_3
		}
		swap_ideas = {
			remove_idea = QIN_idea_low_legitimacy_3
			add_idea = QIN_idea_low_legitimacy_4
		}
	}
	else_if = {
		limit = {
			has_idea = QIN_idea_low_legitimacy_4
		}
		swap_ideas = {
			remove_idea = QIN_idea_low_legitimacy_4
			add_idea = QIN_idea_low_legitimacy_5
		}
	}
	else = {
		remove_ideas = QIN_idea_low_legitimacy_5
	}
}

QIN_legitimacy_decrease = {

	if = {
		limit = {
			has_idea = QIN_idea_low_legitimacy_5
		}
		swap_ideas = {
			remove_idea = QIN_idea_low_legitimacy_5
			add_idea = QIN_idea_low_legitimacy_4
		}
	}
	else_if = {
		limit = {
			has_idea = QIN_idea_low_legitimacy_4
		}
		swap_ideas = {
			remove_idea = QIN_idea_low_legitimacy_4
			add_idea = QIN_idea_low_legitimacy_3
		}
	}
	else_if = {
		limit = {
			has_idea = QIN_idea_low_legitimacy_3
		}
		swap_ideas = {
			remove_idea = QIN_idea_low_legitimacy_3
			add_idea = QIN_idea_low_legitimacy_2
		}
	}
	else_if = {
		limit = {
			has_idea = QIN_idea_low_legitimacy_2
		}
		swap_ideas = {
			remove_idea = QIN_idea_low_legitimacy_2
			add_idea = QIN_idea_low_legitimacy
		}
	}
	else = {
		add_stability = -0.05
	}
}

boxer_protocol_ease = {
	if = {
		limit = {
			has_idea = QIN_idea_boxer_protocol_5
		}
		remove_ideas = QIN_idea_boxer_protocol_5
	}
	if = {
		limit = {
			has_idea = QIN_idea_boxer_protocol_4
		}
		swap_ideas = {
			add_idea = QIN_idea_boxer_protocol_5
			remove_idea = QIN_idea_boxer_protocol_4
		}
	}
	if = {
		limit = {
			has_idea = QIN_idea_boxer_protocol_3
		}
		swap_ideas = {
			add_idea = QIN_idea_boxer_protocol_4
			remove_idea = QIN_idea_boxer_protocol_3
		}
	}
	if = {
		limit = {
			has_idea = QIN_idea_boxer_protocol_2
		}
		swap_ideas = {
			add_idea = QIN_idea_boxer_protocol_3
			remove_idea = QIN_idea_boxer_protocol_2
		}
	}
	if = {
		limit = {
			has_idea = QIN_idea_boxer_protocol_1
		}
		swap_ideas = {
			add_idea = QIN_idea_boxer_protocol_2
			remove_idea = QIN_idea_boxer_protocol_1
		}
	}
	if = {
		limit = {
			has_idea = QIN_idea_boxer_protocol
		}
		swap_ideas = {
			add_idea = QIN_idea_boxer_protocol_2
			remove_idea = QIN_idea_boxer_protocol
		}
	}
}

clear_warlord_cores_and_claims = {
	custom_effect_tooltip = clear_warlord_cores_and_claims_tt
	hidden_effect = {
		every_possible_country = {
			limit = {
				is_china_or_warlord_no_tt = yes
				exists = no
			}
			every_state = {
				limit = {
					OR = {
						is_core_of = PREV
						is_claimed_by = PREV
						has_contested_owner = PREV
					}
				}
				remove_core_of = PREV
				remove_claim_by = PREV
				remove_contested_owner = PREV
			}
		}
	}
}

copy_warlord_problem = {
	# inflation
	if = {
		limit = {
			OVERLORD = {
				has_idea = CHI_idea_inflation5
			}
		}
		add_ideas = CHI_idea_inflation5
	}
	else_if = {
		limit = {
			OVERLORD = {
				has_idea = CHI_idea_inflation4
			}
		}
		add_ideas = CHI_idea_inflation4
	}
	else_if = {
		limit = {
			OVERLORD = {
				has_idea = CHI_idea_inflation3
			}
		}
		add_ideas = CHI_idea_inflation3
	}
	else_if = {
		limit = {
			OVERLORD = {
				has_idea = CHI_idea_inflation2
			}
		}
		add_ideas = CHI_idea_inflation2
	}
	else = {
		add_ideas = CHI_idea_inflation
	}

	# army problem
	if = {
		limit = {
			OVERLORD = {
				has_idea = CHI_idea_army_corruption3
			}
		}
		add_ideas = CHI_idea_army_corruption3
	}
	else_if = {
		limit = {
			OVERLORD = {
				has_idea = CHI_idea_army_corruption2
			}
		}
		add_ideas = CHI_idea_army_corruption2
	}
	else = {
		add_ideas = CHI_idea_army_corruption
	}
}

copy_unequal_treaties_ideas = {
	if = {
		limit = {
			QIN = { has_idea = QIN_idea_boxer_protocol }
		}
		add_ideas = QIN_idea_boxer_protocol
	}
	else_if = {
		limit = {
			QIN = { has_idea = QIN_idea_boxer_protocol_1 }
		}
		add_ideas = QIN_idea_boxer_protocol_1
	}
	else_if = {
		limit = {
			QIN = { has_idea = QIN_idea_boxer_protocol_2 }
		}
		add_ideas = QIN_idea_boxer_protocol_2
	}
	else_if = {
		limit = {
			QIN = { has_idea = QIN_idea_boxer_protocol_3 }
		}
		add_ideas = QIN_idea_boxer_protocol_3
	}
	else_if = {
		limit = {
			QIN = { has_idea = QIN_idea_boxer_protocol_4 }
		}
		add_ideas = QIN_idea_boxer_protocol_4
	}
	else_if = {
		limit = {
			QIN = { has_idea = QIN_idea_boxer_protocol_5 }
		}
		add_ideas = QIN_idea_boxer_protocol_5
	}
	if = {
		limit = {
			QIN = { has_idea = QIN_idea_payments_of_indemnities }
		}
		add_ideas = QIN_idea_payments_of_indemnities
	}
	else_if = {
		limit = {
			QIN = { has_idea = QIN_idea_payments_of_indemnities_2 }
		}
		add_ideas = QIN_idea_payments_of_indemnities_2
	}
	else_if = {
		limit = {
			QIN = { has_idea = QIN_idea_payments_of_indemnities_3 }
		}
		add_ideas = QIN_idea_payments_of_indemnities_3
	}
	else_if = {
		limit = {
			QIN = { has_idea = QIN_idea_payments_of_indemnities_4 }
		}
		add_ideas = QIN_idea_payments_of_indemnities_4
	}
	else_if = {
		limit = {
			QIN = { has_idea = QIN_idea_payments_of_indemnities_5 }
		}
		add_ideas = QIN_idea_payments_of_indemnities_5
	}
	else_if = {
		limit = {
			QIN = { has_idea = QIN_idea_payments_of_indemnities_6 }
		}
		add_ideas = QIN_idea_payments_of_indemnities_6
	}
	if = {
		limit = {
			QIN = { has_idea = unequal_treaties }
		}
		add_ideas = unequal_treaties
	}
}


copy_chinese_ideas = {
	if = {
		limit = {
			CHI = {
				OR = {
					has_idea = QIN_idea_boxer_protocol_1
					has_idea = QIN_idea_boxer_protocol_2
					has_idea = QIN_idea_boxer_protocol_3
					has_idea = QIN_idea_boxer_protocol_4
					has_idea = QIN_idea_boxer_protocol_5
				}
			}
		}
		add_ideas = unequal_treaties
		if = {
			limit = {
				CHI = { has_idea = QIN_idea_boxer_protocol_1 }
			}
			add_ideas = QIN_idea_boxer_protocol_1
		}
		if = {
			limit = {
				CHI = { has_idea = QIN_idea_boxer_protocol_2 }
			}
			add_ideas = QIN_idea_boxer_protocol_2
		}
		if = {
			limit = {
				CHI = { has_idea = QIN_idea_boxer_protocol_3 }
			}
			add_ideas = QIN_idea_boxer_protocol_3
		}
		if = {
			limit = {
				CHI = { has_idea = QIN_idea_boxer_protocol_4 }
			}
			add_ideas = QIN_idea_boxer_protocol_4
		}
		if = {
			limit = {
				CHI = { has_idea = QIN_idea_boxer_protocol_5 }
			}
			add_ideas = QIN_idea_boxer_protocol_5
		}
		add_timed_idea = {
			idea = QIN_idea_profit_transfer
			days = 365
		}
	}
	if = {
		limit = {
			CHI = {
				has_idea = QIN_idea_boxer_protocol
			}
		}
		add_ideas = QIN_idea_boxer_protocol
	}
	if = {
		limit = {
			CHI = {
				has_idea = QIN_idea_payments_of_indemnities_6
			}
		}
		add_ideas = QIN_idea_payments_of_indemnities_6
	}
	if = {
		limit = {
			CHI = {
				has_idea = QIN_idea_payments_of_indemnities_5
			}
		}
		add_ideas = QIN_idea_payments_of_indemnities_5
	}
	if = {
		limit = {
			CHI = {
				has_idea = QIN_idea_payments_of_indemnities_4
			}
		}
		add_ideas = QIN_idea_payments_of_indemnities_4
	}
	if = {
		limit = {
			CHI = {
				has_idea = QIN_idea_payments_of_indemnities_3
			}
		}
		add_ideas = QIN_idea_payments_of_indemnities_3
	}
	if = {
		limit = {
			CHI = {
				has_idea = QIN_idea_payments_of_indemnities_2
			}
		}
		add_ideas = QIN_idea_payments_of_indemnities_2
	}
	if = {
		limit = {
			CHI = {
				has_idea = QIN_idea_payments_of_indemnities
			}
		}
		add_ideas = QIN_idea_payments_of_indemnities
	}
	if = {
		limit = {
			CHI = { 
				has_idea = CHI_idea_inflation5
			}
		}
		add_ideas = CHI_idea_inflation5
	}
	if = {
		limit = {
			CHI = { 
				has_idea = CHI_idea_inflation4
			}
		}
		add_ideas = CHI_idea_inflation4
	}
	if = {
		limit = {
			CHI = { 
				has_idea = CHI_idea_inflation3
			}
		}
		add_ideas = CHI_idea_inflation3
	}
	if = {
		limit = {
			CHI = { 
				has_idea = CHI_idea_inflation2
			}
		}
		add_ideas = CHI_idea_inflation2
	}
	if = {
		limit = {
			CHI = { 
				has_idea = CHI_idea_inflation
			}
		}
		add_ideas = CHI_idea_inflation
	}
}

CHI_idea_weak_industry_upgrade = {
	if = {
		limit = {
			has_idea = CHI_idea_weak_industry
		}
		swap_ideas = {
			remove_idea = CHI_idea_weak_industry
			add_idea = CHI_idea_weak_industry_2
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_weak_industry_2
		}
		swap_ideas = {
			remove_idea = CHI_idea_weak_industry_2
			add_idea = CHI_idea_weak_industry_3
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_weak_industry_3
		}
		remove_ideas = CHI_idea_weak_industry_3
	}
	else = {
		add_stability = 0.10
	}
}
CHI_idea_illiteracy_upgrade = {
	if = {
		limit = {
			has_idea = CHI_idea_illiteracy
		}
		swap_ideas = {
			remove_idea = CHI_idea_illiteracy
			add_idea = CHI_idea_illiteracy2
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_illiteracy2
		}
		swap_ideas = {
			remove_idea = CHI_idea_illiteracy2
			add_idea = CHI_idea_illiteracy3
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_illiteracy3
		}
		remove_ideas = CHI_idea_illiteracy3
	}
	else = {
		add_research_slot = 1
	}
}

CHI_idea_inflation_fix = {
	if = {
		limit = {
			has_idea = CHI_idea_inflation5
		}
		swap_ideas = {
			remove_idea = CHI_idea_inflation5
			add_idea = CHI_idea_inflation4
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_inflation4
		}
		swap_ideas = {
			remove_idea = CHI_idea_inflation4
			add_idea = CHI_idea_inflation3
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_inflation3
		}
		swap_ideas = {
			remove_idea = CHI_idea_inflation3
			add_idea = CHI_idea_inflation2
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_inflation2
		}
		swap_ideas = {
			remove_idea = CHI_idea_inflation2
			add_idea = CHI_idea_inflation
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_inflation
		}
		remove_ideas = CHI_idea_inflation
	}
	else = {
		add_stability = 0.10
	}
}

CHI_idea_inflation_worsen = {
	if = {
		limit = {
			has_idea = CHI_idea_inflation5
		}
		add_political_power = -200
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_inflation4
		}
		swap_ideas = {
			remove_idea = CHI_idea_inflation4
			add_idea = CHI_idea_inflation5
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_inflation3
		}
		swap_ideas = {
			remove_idea = CHI_idea_inflation3
			add_idea = CHI_idea_inflation4
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_inflation2
		}
		swap_ideas = {
			remove_idea = CHI_idea_inflation2
			add_idea = CHI_idea_inflation3
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_inflation
		}
		swap_ideas = {
			remove_idea = CHI_idea_inflation
			add_idea = CHI_idea_inflation2
		}
	}
	else = {
		add_ideas = CHI_idea_inflation
	}
}

CHI_idea_army_corruption_fix = {
	if = {
		limit = {
			has_idea = CHI_idea_army_corruption3
		}
		swap_ideas = {
			remove_idea = CHI_idea_army_corruption3
			add_idea = CHI_idea_army_corruption2
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_army_corruption2
		}
		swap_ideas = {
			remove_idea = CHI_idea_army_corruption2
			add_idea = CHI_idea_army_corruption
		}
	}
	else_if = {
		limit = {
			has_idea = CHI_idea_army_corruption
		}
		remove_ideas = CHI_idea_army_corruption
	}
	else = {
		add_war_support = 0.10
	}
}

chinese_soviet_modifier_upgrade = {
	if = {
		limit = {
			has_dynamic_modifier = {
				modifier = chinese_soviet_heavy_modifier
			}
		}
		OWNER = {
			add_popularity = {
				ideology = communism
				popularity = 0.05
			}
			add_political_power = -40
		}
	}
	else_if = {
		limit = {
			has_dynamic_modifier = {
				modifier = chinese_soviet_normal_modifier
			}
		}
		hidden_effect = {
			remove_dynamic_modifier = {
				modifier = chinese_soviet_normal_modifier
			}
		}
		add_dynamic_modifier = {
			modifier = chinese_soviet_heavy_modifier
		}
	}
	else_if = {
		limit = {
			has_dynamic_modifier = {
				modifier = chinese_soviet_low_modifier
			}
		}
		hidden_effect = {
			remove_dynamic_modifier = {
				modifier = chinese_soviet_low_modifier
			}
		}
		add_dynamic_modifier = {
			modifier = chinese_soviet_normal_modifier
		}
	}
	else = {
		add_dynamic_modifier = {
			modifier = chinese_soviet_low_modifier
		}
	}
}

chinese_soviet_modifier_downgrade = {
	if = {
		limit = {
			has_dynamic_modifier = {
				modifier = chinese_soviet_heavy_modifier
			}
		}
		hidden_effect = {
			remove_dynamic_modifier = {
				modifier = chinese_soviet_heavy_modifier
			}
		}
		add_dynamic_modifier = {
			modifier = chinese_soviet_normal_modifier
		}
	}
	else_if = {
		limit = {
			has_dynamic_modifier = {
				modifier = chinese_soviet_normal_modifier
			}
		}
		hidden_effect = {
			remove_dynamic_modifier = {
				modifier = chinese_soviet_normal_modifier
			}
		}
		add_dynamic_modifier = {
			modifier = chinese_soviet_low_modifier
		}
	}
	else_if = {
		limit = {
			has_dynamic_modifier = {
				modifier = chinese_soviet_low_modifier
			}
		}
		remove_dynamic_modifier = {
			modifier = chinese_soviet_low_modifier
		}
	}
	else = {
		add_popularity = {
			ideology = communism
			popularity = -0.05
		}
	}
}

clear_xinhai_tags = {
	hidden_effect = {
		every_possible_country = {
			limit = {
				has_country_flag = xinhai_tag
			}
			clr_country_flag = xinhai_tag
			set_major = no
			load_focus_tree = {
				tree = china_warlord_focus
				keep_completed = no
			}
			delete_unit_template_and_units = {
				division_template = "Wuchang Qiyijun"
				disband = no
			}
			delete_unit_template_and_units = {
				division_template = "Geming Qiyijun"
				disband = no
			}
			delete_unit_template_and_units = {
				division_template = "Minbing"
				disband = no
			}
			delete_unit_template_and_units = {
				division_template = "Manchu Banner"
				disband = no
			}
			delete_unit_template_and_units = {
				division_template = "Loyalist Qiyijun"
				disband = no
			}
			every_core_state = {
				remove_core_of = PREV
			}
			every_state = {
				limit = {
					is_claimed_by = PREV
				}
				remove_claim_by = PREV
			}
			if = {
				limit = {
					original_tag = HNC
				}
				set_party_name = {
					ideology = democratic
					long_name = HNC_neutrality_party
					name = HNC_neutrality_party
				}
			}
			else = {
				set_politics = {
					ruling_party = neutrality
					elections_allowed = no
				}

				if = {
					limit = {
						original_tag = SHN
					}
					set_party_name = {
						ideology = democratic
						long_name = SHN_neutrality_party
						name = SHN_neutrality_party
					}
					SHN_zhang_fenghui = {
						remove_country_leader_role = {
							ideology = conservatism
						}
					}
				}
				else_if = {
					limit = {
						original_tag = GZC
					}
					set_party_name = {
						ideology = democratic
						long_name = GZC_neutrality_party
						name = GZC_neutrality_party
					}
					GZC_yang_jincheng = {
						remove_country_leader_role = {
							ideology = tridemism
						}
					}
				}
				else_if = {
					limit = {
						original_tag = SCC
					}
					set_party_name = {
						ideology = democratic
						long_name = SCC_neutrality_party
						name = SCC_neutrality_party
					}
					SCC_pu_dianjun = {
						remove_country_leader_role = {
							ideology = conservatism
						}
					}
				}
				else_if = {
					limit = {
						original_tag = SDC
					}
					set_party_name = {
						ideology = democratic
						long_name = SDC_neutrality_party
						name = SDC_neutrality_party
					}
					SDC_hu_ying = {
						remove_country_leader_role = {
							ideology = tridemism
						}
					}
				}
				else_if = {
					limit = {
						original_tag = JXC
					}
					set_party_name = {
						ideology = democratic
						long_name = JXC_neutrality_party
						name = JXC_neutrality_party
					}
				}
				else_if = {
					limit = {
						original_tag = ZHE
					}
					ZHE_tang_shouqian = {
						remove_country_leader_role = {
							ideology = conservatism
						}
					}
				}
				else_if = {
					limit = {
						original_tag = YUN
					}
					set_party_name = {
						ideology = democratic
						long_name = YUN_neutrality_party
						name = YUN_neutrality_party
					}
				}
				else_if = {
					limit = {
						original_tag = GDC
					}
					set_party_name = {
						ideology = democratic
						long_name = GDC_neutrality_party
						name = GDC_neutrality_party
					}
				}
			}
			PREV = {
				annex_country = {
					target = PREV
				}
			}
		}
		CHI = {
			CHI_li_yuanhong = {
				set_nationality = CHI
			}
			CHI_cai_e = {
				set_nationality = CHI
			}
			CHI_tang_jiyao = {
				set_nationality = CHI
			}
			CHI_hu_hanmin = {
				set_nationality = CHI
			}
			CHI_li_jishen = {
				set_nationality = CHI
			}
			CHI_yan_xishan = {
				set_nationality = CHI
			}
			CHI_huang_xing = {
				set_nationality = CHI
			}
			CHI_chen_jiongming = {
				set_nationality = CHI
			}
		}
	}
}

xinhai_end_effect = {
	hidden_effect = {
		QIN = {
			delete_unit_template_and_units = {
				division_template = "Xinjian Lujun (Beiyang Army)"
				disband = no
			}
			delete_unit_template_and_units = {
				division_template = "Xinjian Lujun Hùnchéngxié (South Provincial Army)"
				disband = no
			}
			delete_unit_template_and_units = {
				division_template = "Xinjian Lujun Hùnchéngxié (North Provincial Army)"
				disband = no
			}
			delete_unit_template_and_units = {
				division_template = "Feng Guozhang Army"
				disband = no
			}
			delete_unit_template_and_units = {
				division_template = "Manchu Banner"
				disband = no
			}
			delete_unit_template_and_units = {
				division_template = "Loyalist Qiyijun"
				disband = no
			}
			set_division_template_lock = {
				division_template = "Manchu Banner"
				is_locked = no
			}
			transfer_units_fraction = {
				target = CHI
				size = 1
				target_organization = 1
				source_organization = 1
				stockpile_ratio = 1
				army_ratio = 1
				navy_ratio = 1
				air_ratio = 1
				keep_unit_leaders_trigger = {
					always = yes
				}
			}
			transfer_navy = {
				target = CHI
			}
			every_character = {
				limit = {
					NOT = {
						is_character = QIN_yikuang
						is_character = QIN_kang_youwei
						is_character = QIN_zaitao
						is_character = QIN_liangbi
						is_character = QIN_tieliang
						is_character = QIN_zaifeng
						is_character = QIN_xuantong
						is_character = QIN_liang_hu
						is_character = QIN_zaize
						is_character = QIN_natong
						is_character = QIN_liang_dunyan
						is_character = QIN_wuzhen
						is_character = QIN_shouxun
						is_character = QIN_zaixun
						is_character = QIN_li_shenghe
					}
				}
				set_nationality = CHI
			}
			transfer_navy = {
				target = CHI
			}

			every_enemy_country = {
				every_other_country = {
					limit = {
						OR = {
							is_in_faction_with = QIN
							is_subject_of = QIN
						}
					}
					white_peace = PREV
				}
			}

			set_politics = {
				ruling_party = neutrality
				elections_allowed = no
			}
			set_party_name = {
				ideology = neutrality
				long_name = QIN_neutrality_cabinet_party
				name = QIN_neutrality_cabinet_party
			}
			remove_ideas = QIN_idea_beiyang_army
		}
		
		CHI = {
			annex_country = {
				target = QIN
				transfer_troops = no
			}
			
			add_timed_idea = {
				idea = CHI_idea_xinhai_revolution_ends
				days = 360
			}
			add_ideas = CHI_idea_inflation5
			add_ideas = CHI_idea_army_corruption3
			add_ideas = PRC_government_corruption
			add_ideas = CHI_idea_illiteracy
			add_ideas = CHI_idea_weak_industry
			add_ideas = CHI_banditry
			add_ideas = CHI_idea_unstable_republic

			if = {
				limit = {
					has_country_flag = yuan_shikai_presidency
				}
				CHI_yuan_shikai = {
					if = {
						limit = { has_ideology = authoritarian_democracy }
						promote_character = authoritarian_democracy
					}
					else = {
						add_country_leader_role = {
							country_leader = {
								ideology = authoritarian_democracy
								desc = CHI_yuan_shikai_desc
							}
							promote_leader = yes
						}
					}
					if = {
						limit = { has_ideology = stratocracy }
						promote_character = stratocracy
					}
					else = {
						add_country_leader_role = {
							country_leader = {
								ideology = stratocracy
							}
							promote_leader = yes
						}
					}
					if = {
						limit = { has_ideology = authoritarian_democracy }
						promote_character = authoritarian_democracy
					}
					else = {
						add_country_leader_role = {
							country_leader = {
								ideology = authoritarian_democracy
							}
							promote_leader = yes
						}
					}
				}

				set_party_name = {
					ideology = neutrality
					long_name = CHI_fascism_party
					name = CHI_fascism_party
				}
				set_politics = {
					ruling_party = neutrality
					elections_allowed = no
				}
				set_capital = {
					state = 608
				}

				drop_cosmetic_tag = yes
			}

			delete_unit_template_and_units = {
				division_template = "Xinjian Lujun (Beiyang Army)"
				disband = no
			}
			delete_unit_template_and_units = {
				division_template = "Xinjian Lujun Hùnchéngxié (South Provincial Army)"
				disband = no
			}
			delete_unit_template_and_units = {
				division_template = "Xinjian Lujun Hùnchéngxié (North Provincial Army)"
				disband = no
			}
			delete_unit_template_and_units = {
				division_template = "Feng Guozhang Army"
				disband = no
			}
			delete_unit_template_and_units = {
				division_template = "Loyalist Qiyijun"
				disband = no
			}
			delete_unit_template_and_units = {
				division_template = "Manchu Banner"
				disband = no
			}
			delete_unit_template_and_units = {
				division_template = "Minbing"
				disband = no
			}
			CHI = {
				load_oob = CHI_1912
			}

			every_owned_state = {
				limit = {
					OR = {
						region = 155
						state = 610
					}
					NOT = {
						has_dynamic_modifier = {
							modifier = mongolian_banners_modifier
						}
						has_dynamic_modifier = {
							modifier = gando_modifier
						}
					}
				}
				add_dynamic_modifier = {
					modifier = manchu_modifier
				}
			}

			set_global_flag = xinhai_revolution_ends
			set_country_flag = xinhai_victory
			
			news_event = {
				id = kis_news.119
				hours = 3
			}
			
			give_military_access = GER #Qingdao-Jinan Railway

			diplomatic_relation = {
				country = CER
				relation = military_access
				active = yes
			}
			diplomatic_relation = {
				country = CER
				relation = guarantee
				active = yes
			}
			CER = {
				set_cosmetic_tag = CER_xinhai
			}

			clear_xinhai_tags = yes

			if = {
				limit = {
					is_faction_leader = yes
				}
				dismantle_faction = yes
			}
		}

		every_state = {
			limit = {
				is_core_of = QIN
			}
			remove_core_of = QIN
		}
		every_state = {
			limit = {
				is_claimed_by = QIN
			}
			add_claim_by = CHI
			remove_claim_by = QIN
		}

		every_state = {
			limit = {
				OR = {
					is_owned_by = MON
					is_owned_by = TIB
				}
				NOT = {
					state = 322
					state = 329
					state = 330
					state = 434
					state = 618
					state = 982
					state = 985
				}
			}
			transfer_state_to = CHI
		}

		every_state = {
			CHI = {
				delete_unit = {
					state = PREV
				}
			}
		}
	}
}