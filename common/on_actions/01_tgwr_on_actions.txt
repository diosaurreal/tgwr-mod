 on_actions = {
	on_peaceconference_ended = {
		effect = {
			if = {
				limit = {
					tag = FRA
					FROM = {
						tag = GER
					}					#loser
					is_great_war_ongoing = yes
					NOT = {
						has_global_flag = FRA_surrender_alone
						has_country_flag = jaures_neutrality
						has_country_leader = {
							character = FRA_jean_jaures
						}
					}
				}
				set_global_flag = great_war_ends
				set_global_flag = versallies_treaty
				set_global_flag = GER_capitulation
				FROM = {
					GER_change_wilhelm_ii_portrait = yes
				}
				every_country = {
					limit = {
						OR = {
							tag = FROM
							is_subject_of = FROM
							AND = {
								is_in_faction_with = FROM
								NOT = {
									is_in_faction_with = ROOT
								}
							}
						}
						NOT = {
							has_country_flag = great_war_winner
						}
					}
					set_country_flag = great_war_loser
					add_ideas = idea_armistice
				}
				every_country = {
					limit = {
						OR = {
							tag = ROOT
							is_in_faction_with = ROOT
							is_subject_of = ROOT
						}
						NOT = {
							has_country_flag = great_war_loser
						}
					}
					set_country_flag = great_war_winner
					add_ideas = idea_armistice
				}
			}
			if = {
				limit = {
					tag = GER					#winner
					FROM = {
						tag = FRA
					}					#loser
					is_great_war_ongoing = yes
					NOT = {
						has_global_flag = FRA_surrender_alone
						has_country_flag = jaures_neutrality
						has_country_leader = {
							character = FRA_jean_jaures
						}
					}
				}
				set_global_flag = great_war_ends
				set_global_flag = frankfurt_treaty
				set_global_flag = FRA_capitulation
				GER_change_wilhelm_ii_portrait = yes
				every_country = {
					limit = {
						OR = {
							tag = FROM
							is_subject_of = FROM
							AND = {
								is_in_faction_with = FROM
								NOT = {
									is_in_faction_with = ROOT
								}
							}
						}
						NOT = {
							has_country_flag = great_war_winner
						}
					}
					set_country_flag = great_war_loser
					add_ideas = idea_armistice
				}
				every_country = {
					limit = {
						OR = {
							tag = ROOT
							is_in_faction_with = ROOT
							is_subject_of = ROOT
						}
						NOT = {
							has_country_flag = great_war_loser
						}
					}
					set_country_flag = great_war_winner
					add_ideas = idea_armistice
				}
			}
			if = {
				limit = {
					original_tag = QIN					#winner
					FROM = {
						original_tag = CHI
					}					#loser
				}
				QIN = {
					annex_country = {
						target = CHI
					}
				}
				if = {
					limit = {
						NOT = {
							has_country_flag = xinhai_victory
							has_global_flag = xinhai_revolution_ends
						}
					}
					set_global_flag = xinhai_revolution_ends
					set_country_flag = xinhai_victory
					add_timed_idea = {
						idea = CHI_idea_xinhai_revolution_ends
						days = 360
					}
					news_event = {
						id = kis_news.119
					}
					add_ideas = CHI_idea_inflation5
					add_ideas = CHI_idea_army_corruption3
				}
				every_state = {
					limit = {
						is_core_of = CHI
					}
					remove_core_of = CHI
				}
				every_state = {
					limit = {
						is_claimed_by = CHI
					}
					remove_claim_by = CHI
				}
			}
			if = {
				limit = {
					original_tag = CHI					#winner
					FROM = {
						original_tag = QIN
					}					#loser
				}
				if = {
					limit = {
						NOT = {
							has_country_flag = xinhai_victory
							has_global_flag = xinhai_revolution_ends
						}
					}
					QIN = {
						transfer_units_fraction = {
							target = CHI
							size = 1
							target_organization = 1
							source_organization = 1
							stockpile_ratio = 1
							army_ratio = 1
							navy_ratio = 1
							air_ratio = 1
						}
						every_character = {
							limit = {
								NOT = {
									is_character = QIN_yikuang
									is_character = QIN_kang_youwei
									is_character = QIN_zaitao
									is_character = QIN_liangbi
									is_character = QIN_tieliang
									is_character = QIN_zaifeng
									is_character = QIN_xuantong
									is_character = QIN_liang_hu
									is_character = QIN_zaize
									is_character = QIN_natong
									is_character = QIN_liang_dunyan
									is_character = QIN_wuzhen
									is_character = QIN_shouxun
									is_character = QIN_zaixun
									is_character = QIN_li_shenghe
								}
							}
							set_nationality = CHI
						}
						transfer_navy = {
							target = CHI
						}
					}
					CHI = {
						annex_country = {
							target = QIN
							transfer_troops = yes
						}
					}
					set_global_flag = xinhai_revolution_ends
					set_country_flag = xinhai_victory
					add_timed_idea = {
						idea = CHI_idea_xinhai_revolution_ends
						days = 360
					}
					news_event = {
						id = kis_news.119
					}
					copy_unequal_treaties_ideas = yes
					add_ideas = CHI_idea_inflation5
					add_ideas = CHI_idea_army_corruption3
					add_ideas = PRC_government_corruption
					add_ideas = CHI_idea_illiteracy
					add_ideas = CHI_idea_weak_industry
					add_ideas = CHI_banditry
					add_ideas = CHI_idea_unstable_republic
					promote_character = CHI_sun_yatsen
					give_military_access = GER #Qingdao-Jinan Railway
					diplomatic_relation = {
						country = CER
						relation = military_access
						active = yes
					}
					diplomatic_relation = {
						country = CER
						relation = guarantee
						active = yes
					}
					CER = {
						set_cosmetic_tag = CER_xinhai
					}
					delete_unit_template_and_units = {
						division_template = "Minbing"
						disband = no
					}
					delete_unit_template_and_units = {
						division_template = "Minbing"
						disband = no
					}
					delete_unit_template_and_units = {
						division_template = "Minbing"
						disband = no
					}
					delete_unit_template_and_units = {
						division_template = "Minbing"
						disband = no
					}
					delete_unit_template_and_units = {
						division_template = "Minbing 2"
						disband = no
					}
					delete_unit_template_and_units = {
						division_template = "Minbing 3"
						disband = no
					}
					delete_unit_template_and_units = {
						division_template = "Minbing 4"
						disband = no
					}
					delete_unit_template_and_units = {
						division_template = "Xinjian Lujun (Beiyang Army)"
						disband = no
					}
					delete_unit_template_and_units = {
						division_template = "Xinjian Lujun Hùnchéngxié (South Provincial Army)"
						disband = no
					}
					delete_unit_template_and_units = {
						division_template = "Xinjian Lujun Hùnchéngxié (North Provincial Army)"
						disband = no
					}
					delete_unit_template_and_units = {
						division_template = "Manchu Banner"
						disband = no
					}
					every_state = {
						CHI = {
							delete_unit = {
								state = PREV
							}
						}
					}
					CHI = {
						load_oob = CHI_1912
					}
					every_owned_state = {
						limit = {
							OR = {
								region = 155
								state = 610
							}
							NOT = {
								has_dynamic_modifier = {
									modifier = mongolian_banners_modifier
								}
								has_dynamic_modifier = {
									modifier = gando_modifier
								}
							}
						}
						add_dynamic_modifier = {
							modifier = manchu_modifier
						}
					}
				}
				else_if = {
					limit = {
						has_global_flag = manchu_restoration
					}
					QIN = {
						every_character = {
							limit = {
								has_character_flag = manchu_restoration
							}
							QIN_zhang_xun = {
								remove_country_leader_role = {
									ideology = stratocracy
								}
								remove_country_leader_role = {
									ideology = absolute_monarchy
								}
								remove_unit_leader_role = yes
							}
							set_nationality = CHI
						}
					}
					CHI = {
						annex_country = {
							target = QIN
							transfer_troops = no
						}
					}
					if = {
						limit = {
							has_completed_focus = CHI_ruling_of_yuan_shikai
						}
						CHI = {
							set_capital = { state = 608 }
						}
						country_event = {
							id = ww1_china.9
							hours = 3
						}
					}
				}
				every_state = {
					limit = {
						is_core_of = QIN
					}
					remove_core_of = QIN
				}
				every_state = {
					limit = {
						is_claimed_by = QIN
					}
					remove_claim_by = QIN
				}
			}
			if = {
				limit = {
					original_tag = JNC	#winner
					FROM = {
						original_tag = QIN
					}	#loser
				}
				FROM = {
					if = {
						limit = {
							is_faction_leader = yes
						}
						dismantle_faction = yes
					}
				}
			}
			if = {
				limit = {
					ROOT = {
						original_tag = CHI
						598 = {
							is_owned_by = PREV
						}
						608 = {
							is_owned_by = PREV
							is_capital = no
						}
						OR = {
							has_idea = CHI_idea_beiyang_government
							has_idea = CHI_idea_beiyang_government2
						}
					}
				}
				ROOT = {
					set_capital = { state = 608 }
				}
			}
			if = {
				limit = {
					ROOT = {
						original_tag = CZE
					}
					PREV = {
						has_country_flag = hungarian_romanian_war_loser
					}
					SLO = {
						is_subject_of = PREV
					}
				}
				every_state = {
					limit = {
						is_owned_by = SLO
					}
					transfer_state_to = ROOT
				}
			}
			if = {
				limit = {
					tag = SOV
				}
				if = { 
					limit = {
						FROM = {
							original_tag = RUS
						}
					}	
					SOV = {
						annex_country = {
							target = FROM
						}
					}
				}
				if = {
					limit = {
						has_government = communism
						NOT = { has_global_flag = russian_civil_war_ends }
						has_global_flag = russian_civil_war
						is_subject = no
						OR = {
							is_faction_leader = yes
							is_in_faction = no
						}
						NOT = {
							any_enemy_country = {
								NOT = {
									tag = FROM
								}	
								is_russian_tag = yes
							}
						}
					}
					set_country_flag = russian_civil_war_winner
					set_global_flag = russian_civil_war_ends
					news_event = rusrevolt.19
				}	
			}
			if = {
				limit = {
					original_tag = RUS					#winner
					FROM = {
						tag = SOV #loser
					}	
				}
				ROOT = {
					annex_country = {
						target = SOV
					}
				}
			}
			# USB DEAD
			if = {
				limit = {
					OR = {
						original_tag = USA
						original_tag = CSA
					}
					FROM = {
						original_tag = USB
					}					#loser
				}
				annex_country = {
					target = FROM
				}
				set_country_flag = USB_defeated
				every_state = {
					limit = {
						is_claimed_by = FROM
					}
					remove_claim_by = FROM
					add_claim_by = ROOT
				}
				every_state = {
					limit = {
						is_core_of = FROM
					}
					remove_core_of = FROM
					add_core_of = ROOT
				}
			}
			# CSA DEAD
			if = {
				limit = {
					OR = {
						original_tag = USA
						original_tag = USB
					}
					FROM = {
						original_tag = CSA
					}					#loser
				}
				annex_country = {
					target = FROM
				}
				set_country_flag = CSA_defeated
				every_state = {
					limit = {
						is_claimed_by = FROM
					}
					remove_claim_by = FROM
					add_claim_by = ROOT
				}
				every_state = {
					limit = {
						is_core_of = FROM
					}
					remove_core_of = FROM
					add_core_of = ROOT
				}
			}
			# USA DEAD
			if = {
				limit = {
					OR = {
						original_tag = CSA
						original_tag = USB
					}
					FROM = {
						original_tag = USA
					}					#loser
				}
				annex_country = {
					target = FROM
				}
				set_country_flag = USA_defeated
				every_state = {
					limit = {
						is_claimed_by = FROM
					}
					remove_claim_by = FROM
					add_claim_by = ROOT
				}
				every_state = {
					limit = {
						is_core_of = FROM
					}
					remove_core_of = FROM
					add_core_of = ROOT
				}
			}
			if = {
				limit = {
					tag = AUS
					FROM = {
						original_tag = HUN
					}
					HUN = {
						OR = {
							is_subject_of = AUS
							is_subject = no
						}
					}
				}
				release_puppet = HUN
				set_autonomy = {
					target = HUN
					autonomous_state = autonomy_tgwr_real_union
				}
				HUN = {
					set_politics = {
						ruling_party = neutrality
						elections_allowed = no
					}
				}
				every_owned_state = {
					limit = {
						region = 27
					}
					transfer_state_to = HUN
				}
			}
			# if = {
			# 	limit = {
			# 		original_tag = FRA
			# 		has_country_flag = FRA_nationalist_france_flag
			# 		FROM = {
			# 			original_tag = FRA
			# 			has_country_flag = FRA_socialist_france_flag
			# 			OR = {
			# 				is_subject = no
			# 				is_subject_of = ROOT
			# 			}		
			# 		}
			# 	}
			# 	annex_country = {
			# 		target = FRC
			# 	}
			# }
			if = {
				limit = {
					tag = TUR					#winner
					FROM = {
						tag = BUL
					}					#loser
					has_global_flag = kis_firstbalkan_war
					NOT = {
						has_global_flag = kis_firstbalkanwar_victory
						has_global_flag = kis_firstbalkanwar_lose
						has_global_flag = kis_secondbalkan_war
					}
				}
				set_global_flag = BUL_surrender_in_balkan_war
				BUL = {
					add_ideas = BUL_idea_first_national_catastrophe
					add_timed_idea = {
						idea = BUL_idea_refugee_crisis
						days = 200
					}
					set_country_flag = BW1_loser
				}
			}
			if = {
				limit = {
					tag = TUR					#winner
					FROM = {
						tag = SER
					}					#loser
					has_global_flag = kis_firstbalkan_war
					NOT = {
						has_global_flag = kis_firstbalkanwar_victory
						has_global_flag = kis_firstbalkanwar_lose
					}
				}
				set_global_flag = SER_surrender_in_balkan_war
				set_global_flag = kis_firstbalkanwar_lose
				SER = {
					remove_state_core = 106
					remove_state_core = 203
					remove_state_core = 1140
					remove_state_core = 1213
					set_country_flag = BW1_loser
				}
			}
			### To Prevent TRA/MOL/ROM from beinf released in the Carpathians ###
			if = {
				limit = {
					any_country = {
						owns_state = 867
						NOT = {
							any_owned_state = {
								NOT = {
									state = 867
									state = 868
									state = 866
								}
							}
						}
					}
				}
				random_country = {
					limit = {
						OR = {
							owns_state = 79
							owns_state = 80
						}	
					}
					transfer_state = 867
				}				
			}
			if = {
				limit = {
					any_country = {
						owns_state = 868
						NOT = {
							any_owned_state = {
								NOT = {
									state = 867
									state = 868
									state = 866
								}
							}
						}
					}
				}
				random_country = {
					limit = {
						OR = {
							owns_state = 778
							owns_state = 79						
						}	
					}
					transfer_state = 868
				}				
			}
			if = {
				limit = {
					any_country = {
						owns_state = 866
						NOT = {
							any_owned_state = {
								NOT = {
									state = 867
									state = 868
									state = 866
								}
							}
						}
					}
				}
				random_country = {
					limit = {
						OR = {							
							owns_state = 84
							owns_state = 81
						}	
					}
					transfer_state = 866
				}
				random_country = {
					limit = {
						OR = {
							AND = {
								owns_state = 82
								owns_state = 84
							}
							AND = {
								owns_state = 81
								owns_state = 46
							}							
						}	
					}
					transfer_state = 866
				}				
			}
			#######
			country_event = ww1_firstbalkan.101 #disabling major status during war
		}
	}	
	on_peace = {
		effect = {
			log = "[GetDateText]: [Root.GetName]: on_peace"
			if = {
				limit = {
					tag = RUS
					has_country_leader = {
						character = RUS_nikolai_ii
						ruling_only = yes
					}
					RUS_nikolai_ii = {
						NOT = {
							has_character_flag = RUS_nicholas_romanov_dictator
							has_character_flag = RUS_nicholas_romanov_democratic
						}
					}					
				}
				RUS_nikolai_ii = {
					set_portraits = {
						civilian = {
							large="gfx/leaders/RUS/RUS_nicholas_romanov.png"
						}
					}
				}				
			}
			if = {
				limit = {
					tag = MAF
					OR = {
						owns_state = 274
						owns_state = 547
						owns_state = 558
						owns_state = 1145
						owns_state = 792
					}
					has_idea = MAF_British_Settlers
				}
				every_state = {
					limit = {
						is_owned_by = MAF
						OR = {
							state = 274
							state = 547
							state = 558
							state = 1145
							state = 792
						}
					}
					set_demilitarized_zone = yes
				}
			}
			if = {
				limit = {
					tag = ASY
					has_cosmetic_tag = ASY_volunteers
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					is_in_faction = yes
					OR = {
						has_autonomy_state = autonomy_tgwr_protectorate
						has_autonomy_state = autonomy_tgwr_informal_protectorate
						has_autonomy_state = autonomy_tgwr_ottoman_emirate
						has_autonomy_state = autonomy_tgwr_concession
					}
				}
				leave_faction = yes
				OVERLORD = {
					diplomatic_relation = {
						country = PREV
						relation = military_access
						active = yes
					}
				}
				country_event = { id = ww1_political.7 hours = 1 } #needed if the faction leader is at war, don't ask
			}
			if = {
				limit = {
					tag = SER
					has_completed_focus = SER_war_preparations
				}
				SER = {
					set_capital = { state = 107 }
					set_victory_points = {
						province = 11887
						value = 2
					}
					set_victory_points = {
						province = 11586
						value = 10
					}
				}
			}
			if = {
				limit = {
					OR = {				
						has_idea = service_by_requirement
						has_idea = all_adults_serve
						has_idea = scraping_the_barrel
					}
				}
				add_ideas = extensive_conscription
			}
			if = {
				limit = {
					OR = {				
						has_idea = war_economy
						has_idea = tot_economic_mobilisation
					}
				}
				add_ideas = partial_economic_mobilisation
			}
			#Demobilization check for the AI
			if = {
				limit = {
					is_ai = yes
					NOT = { has_country_flag = has_demobilization_check }
				}
				set_country_flag = { flag = has_demobilization_check days = 6 value = 1 }
				country_event = { id = ww1_political.5 days = 6 }
			}

			#Reduce units check for the AI
			if = {
				limit = {
					is_ai = yes
					NOT = { has_country_flag = has_reduce_units_check }
					OR = {
						has_global_flag = tgwr_show_division_limiter
						has_active_mission = RUS_demobilizing_army_timer
					}
				}
				set_country_flag = has_reduce_units_check
				country_event = { id = ww1_political.6 days = 7 random = 72 }
			}
			if = {
				limit = {
					has_character = SWE_harald_hjalmarson
				}
				if = {
					limit = {
						FIN = { has_civil_war = yes }
					}
					SWE_harald_hjalmarson = {
						set_nationality = FIN
					}
				}
				else = {
					SWE_harald_hjalmarson = {
						set_nationality = SWE
					}
				}
			}
		}
	}
	
	#ROOT is winner #FROM gets annexed
	on_annex = {
		effect = {
			if = {
				limit = {
					FROM = {
						tag = VLN
					}
				}
				every_state = {
					limit = {
						OR = {
							is_core_of = VLN
							is_claimed_by = VLN
						}
					}
					remove_core_of = VLN
					remove_claim_by = VLN
				}
			}
			if = {
				limit = {
					ROOT = {
						OR = {
							has_country_flag = ITA_republican_italy_flag
							has_country_flag = ITA_socialist_italy_flag
							has_country_flag = ITA_monarchist_italy_flag
						}
					}
					FROM = {
						OR = {
							has_country_flag = ITA_republican_italy_flag
							has_country_flag = ITA_socialist_italy_flag
							has_country_flag = ITA_monarchist_italy_flag
						}
					}
				}
				every_state = {
					limit = {
						OR = {
							is_core_of = FROM
							is_claimed_by = FROM
						}
					}
					remove_core_of = FROM
					remove_claim_by = FROM
				}
			}
			if = {
				limit = {
					ROOT = {
						OR = {
							has_country_flag = FRA_socialist_france_flag
							has_country_flag = FRA_nationalist_france_flag
						}
					}
					FROM = {
						OR = {
							has_country_flag = FRA_socialist_france_flag
							has_country_flag = FRA_nationalist_france_flag
						}
					}
				}
				every_state = {
					limit = {
						OR = {
							is_core_of = FROM
							is_claimed_by = FROM
						}
					}
					remove_core_of = FROM
					remove_claim_by = FROM
				}
			}
			if = {
				limit = {
					FROM = {
						has_country_flag = protectorate
					}
				}
				FROM = {
					clr_country_flag = protectorate
				}
			}
			if = {
				limit = {
					FROM = { is_league_of_nations_member = yes }
				}
				FROM = { leave_the_league_of_nations = yes }
			}
			log = "[GetDateText]: [ROOT.GetName] annexed [FROM.GetName]"
		}
	}
	on_new_term_election = {
		effect = {
			### Brazil ###
			if = {
				limit = {
					original_tag = BRA
				}
				country_event = ww1_brazil.1
				country_event = ww1_brazil.2
				country_event = ww1_brazil.3
				country_event = ww1_brazil.5
			}
			### Ecuador ###
			if = {
				limit = {
					original_tag = ECU
				}
				country_event = ww1_ecuador.5
				country_event = ww1_ecuador.6
			}
			### Argentina ###
			if = {
				limit = {
					original_tag = ARG
				}
				country_event = ww1_argentina.1
				country_event = ww1_argentina.3
			}

			### Chile ###
			if = {
				limit = { original_tag = CHL }
				country_event = ww1_chile.3 #1910
				country_event = ww1_chile.5 #1915
				country_event = ww1_chile.7 #1920
			}

			### Ottoman ###
			if = {
				limit = { original_tag = TUR }
				if = {
					limit = { NOT = { has_country_flag = TUR_hold_mock_elections } }
					country_event = ottoman.5
				}
			}
			### Serbia ###
			if = {
				limit = {
					original_tag = SER
				}
				country_event = ww1_serbia.2
				country_event = ww1_serbia.44
			}
			### China ###
			if = {
				limit = {
					tag = CHI
					has_focus_tree = china_focus
				}
				if = {
					limit = {
						has_global_flag = warlord_era
						has_country_leader = {
							character = CHI_li_yuanhong
							ruling_only = yes
						}
						NOT = {
							has_global_flag = warlord_era_end
						}
					}
					country_event = ww1_china.153
				}
				else_if = {
					limit = {
						has_idea = CHI_idea_feng_guozhang_president
					}
					country_event = ww1_china.149
				}
				else_if = {
					limit = {
						OR = {
							has_completed_focus = CHI_ruling_of_yuan_shikai
							has_completed_focus = CHI_focus_democratic_presidential_election
						}
						NOT = { has_government = fascism }
					}
					country_event = ww1_china.123
				}
			}

			### Canada ###
			if = {
				limit = { original_tag = CAN }
				country_event = canada.67
			}
			
			### Korea ###
			if = {
				limit = {
					tag = KOR
				}
				if = {
					limit = {
						OR = {
							has_idea = KOR_idea_gwangmu
							has_idea = KOR_idea_yunghui
							has_idea = KOR_idea_uimin
							has_idea = KOR_idea_uihwa
						}
					}
					#constitutional elections; will do later
					else = {
						country_event = ww1_korea.17
					}
				}
				
			}

			### Bolivia ###
			if = {
				limit = {
					tag = BOL
				}
				if = {
					limit = {
						has_government = neutrality
					}
					country_event = bolivia.1 #1913
					country_event = bolivia.2 #1917
				}
			}

			### Austria ###
			if = {
				limit = {
					tag = AUS
				}
				if = {
					limit = {
						has_country_leader = {
							character = AUS_michael_hainisch
						}
					}
					country_event = ww1_austria.10
					country_event = ww1_austria.2
				}
				else = {
					country_event = ww1_auh.158
				}
			}

			### Hungary ###
			if = {
				limit = {
					tag = HUN
				}
				country_event = ww1_hungary_auh.1
			}
			log = "[GetDateText]: [ROOT.GetName] has a new term election"
		}
		# USA EVENTS	
		random_events = {
		}
	}
	on_subject_free = {
		effect = {
			if = {
				limit = {
					tag = CMR
				}
				if = {
					limit = {
						has_character = CMR_karl_ebermaier
					}
					retire_character = CMR_karl_ebermaier
				}				
			}
			# by event
			# if = {
			# 	limit = {
			# 		original_tag = BLR
			# 		OR = {
			# 			BLR_genrikh = {
			# 				is_country_leader = yes
			# 			}
			# 			BLR_uladzimir = {
			# 				is_country_leader = yes
			# 			}
			# 		}
			# 	}
			# 	drop_cosmetic_tag = yes
			# 	set_party_name = {
			# 		ideology = neutrality
			# 		long_name = BLR_neutrality_party
			# 		name = BLR_neutrality_party
			# 	}
			# 	if = {
			# 		limit = {
			# 			has_character = BLR_genrikh
			# 		}
			# 		BLR_genrikh = { remove_country_leader_role = { ideology = semi_constitutional_monarchy } }
			# 	}
			# 	if = {
			# 		limit = {
			# 			has_character = BLR_uladzimir
			# 		}
			# 		BLR_uladzimir = { remove_country_leader_role = { ideology = semi_constitutional_monarchy } }
			# 	}
			# }
			if = {
				limit = {
					original_tag = BOS
					BOS_marijan_varesanin = {
						is_country_leader = yes
					}
				}
				drop_cosmetic_tag = yes
				retire_character = BOS_marijan_varesanin
			}
			if = {
				limit = {
					OR = {
						original_tag = ANC
						original_tag = FNG
						original_tag = GDC
						original_tag = GXC
						original_tag = GZC
						original_tag = JNC
						original_tag = JXC
						original_tag = SCC
						original_tag = SDC
						original_tag = SHN
						original_tag = YUN
						original_tag = ZHE
						original_tag = XSM
					}
					OR = {
						has_cosmetic_tag = ANC_QIN
						has_cosmetic_tag = FNG_QIN
						has_cosmetic_tag = GDC_QIN
						has_cosmetic_tag = GXC_QIN
						has_cosmetic_tag = GZC_QIN
						has_cosmetic_tag = JNC_QIN
						has_cosmetic_tag = JXC_QIN
						has_cosmetic_tag = SCC_QIN
						has_cosmetic_tag = SDC_QIN
						has_cosmetic_tag = SHN_QIN
						has_cosmetic_tag = YUN_QIN
						has_cosmetic_tag = ZHE_QIN
						has_cosmetic_tag = XSM_QIN
					}
					OR = {
						is_qing_monarchy = no
						NOT = {
							is_in_faction_with = QIN
							any_allied_country = {
								is_qing_monarchy = yes
							}
						}
					}
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					OR = {
						original_tag = GXC
						original_tag = YUN
						original_tag = XSM
						original_tag = FNG
						original_tag = SIK
						original_tag = SCC
					}
					OR = {
						has_cosmetic_tag = GXC_KMT
						has_cosmetic_tag = YUN_KMT
						has_cosmetic_tag = XSM_KMT
						has_cosmetic_tag = FNG_KMT
						has_cosmetic_tag = SIK_KMT
						has_cosmetic_tag = SCC_KMT
					}
					is_kuomintang_state = no
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					OR = {
						original_tag = MOR
						original_tag = TUN
						original_tag = ALG
					}
					OR = {
						has_cosmetic_tag = FRA_classic_blue
						has_cosmetic_tag = FRA_socialist_red_alone
						has_cosmetic_tag = ALG_FRA
						has_cosmetic_tag = TUN_FRA
					}
				}
				if = {
					limit = {
						has_country_leader_with_trait = foreign_leader
					}
					retire_ideology_leader = neutrality
				}
			}
			if = {
				limit = {
					ROOT = {
						has_country_flag = protectorate
					}
				}
				clr_country_flag = protectorate
			}
			abandon_puppet_tag = yes
			log = "[GetDateText]: [ROOT.GetName] has been released as a free country"
		}
	}
	on_release_as_free = {
		effect = {
			if = {
				limit = {
					OR = {
						original_tag = MOR
						original_tag = TUN
						original_tag = ALG
					}
					OR = {
						has_cosmetic_tag = FRA_classic_blue
						has_cosmetic_tag = FRA_socialist_red_alone
						has_cosmetic_tag = ALG_FRA
						has_cosmetic_tag = TUN_FRA
					}
				}
				if = {
					limit = {
						has_country_leader_with_trait = foreign_leader
					}
					retire_ideology_leader = neutrality
				}
			}
			if = {
				limit = {
					OR = {
						original_tag = RAJ
						original_tag = MAL
						original_tag = INS
						original_tag = VIN
					}
					is_subject = no
					NOT = {
						has_country_flag = RAJ_british_remnants_flag
					}
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					ROOT = {
						has_country_flag = protectorate
					}
				}
				ROOT = {
					clr_country_flag = protectorate
				}
			}
			if = {
				limit = {
					has_cosmetic_tag = SOV_puppet
					FROM = {
						NOT = {
							tag = SOV
							has_cosmetic_tag = SOV
						}
					}
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					original_tag = FIN
				}
				FIN_set_finnish_state_names = yes
			}
			abandon_puppet_tag = yes
			log = "[GetDateText]: [ROOT.GetName] has been released as a free country"
		}
	}
	#*evil laugh*
	on_puppet = {
		effect = {
			if = {
				limit = {
					OR = {
						original_tag = BLR
						original_tag = MOL
						original_tag = EST
						original_tag = LAT
						original_tag = LIT
						original_tag = COU
						original_tag = GEO
						original_tag = MOU
						original_tag = AZR
						original_tag = KAZ
						original_tag = TRK
						original_tag = FIN
						original_tag = GAL
						original_tag = WUK
						original_tag = BUK
						original_tag = KHI
						original_tag = PER
						original_tag = MON
						original_tag = TAN
					}			
					NOT = {
						has_cosmetic_tag = SOV_puppet
						has_cosmetic_tag = GEO_TSCN_commissariat
						has_cosmetic_tag = GEO_TSCN_committee
						has_cosmetic_tag = GEO_TSCN
						has_cosmetic_tag = GEO_TSCN_communism
						has_cosmetic_tag = LITBEL
					}
					FROM = {
						OR = {
							tag = SOV
							has_cosmetic_tag = SOV
						}
						has_government = communism
					}
				}
				set_cosmetic_tag = SOV_puppet
			}
			if = {
				limit = {
					has_cosmetic_tag = SOV_puppet
					FROM = {
						NOT = {
							tag = SOV
						}
					}
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					original_tag = CAN
					is_subject_of = ENG
				}
				set_cosmetic_tag = CAN_UK
			}
			if = {
				limit = {
					original_tag = NFL
					OR = {
						is_subject_of = ENG
						AND = {
							is_subject = yes
							OVERLORD = { has_country_flag = has_british_monarchy }
						}
					}
				}
				set_cosmetic_tag = NFL_UK
			}
			if = {
				limit = {
					original_tag = USA
					OR = {
						has_government = democratic
						has_government = neutrality
					}
					FROM = {
						original_tag = SER
					}
				}
				USA = {
					USA_nikola_tesla = {
						add_country_leader_role = {
							promote_leader = yes
							country_leader = {
								ideology = classical_liberalism
								traits = {
									tgwr_inventive_genius
								}
							}
						}
						add_country_leader_role = {
							promote_leader = yes
							country_leader = {
								ideology = authoritarian_democracy
								traits = {
									tgwr_inventive_genius
								}
							}
						}
					}				
				}
			}
			if = {
				limit = {
					original_tag = CAN
					FROM = {
						tag = USA
					}
				}
				set_cosmetic_tag = CAN_USA
			}
			if = {
				limit = {
					original_tag = ENG
					FROM = {
						tag = USA
					}
				}
				set_cosmetic_tag = ENG_USA
			}
			if = {
				limit = {
					original_tag = MEX
					FROM = {
						tag = ENG
					}
				}
				set_cosmetic_tag = MEX_ENG
			}
			if = {
				limit = {
					original_tag = USA
					FROM = {
						tag = ENG
					}
				}
				set_cosmetic_tag = USA_UK				#vanilla hoi4
			}
			if = {
				limit = {
					original_tag = USA
					FROM = {
						tag = GER
					}
				}
				USA = {
					set_cosmetic_tag = USA_GER
					USA_charles_john_hexamerk = {
						promote_character = yes
					}					
				}
			}
			if = {
				limit = {
					original_tag = USA
					FROM = {
						tag = RUS
					}
				}
				set_cosmetic_tag = USA_RUS				#историческая справедливость
			}
			if = {
				limit = {
					original_tag = POL
					FROM = {
						tag = RUS
					}
					RUS = {
						NOT = {
							has_completed_focus = RUS_self_determination_of_nations
						}
					}
				}
				set_cosmetic_tag = POL_RUS
			}
			if = {
				limit = {
					original_tag = KAZ
					FROM = {
						tag = RUS
					}
					RUS = {
						NOT = {
							has_completed_focus = RUS_self_determination_of_nations
						}
					}
				}
				set_cosmetic_tag = KAZ_RUS
			}
			if = {
				limit = {
					original_tag = TRK
					FROM = {
						tag = RUS
					}
					RUS = {
						NOT = {
							has_completed_focus = RUS_self_determination_of_nations
						}
					}
				}
				set_cosmetic_tag = TRK_RUS
			}
			#China/Qing
			if = {
				limit = {
					OR = {
						original_tag = CHI
						original_tag = QIN
					}
					FROM = {
						tag = GER
					}
				}
				set_cosmetic_tag = CHI_GER
			}
			if = {
				limit = {
					OR = {
						original_tag = CHI
						original_tag = QIN
					}
					FROM = {
						tag = ENG
					}
				}
				set_cosmetic_tag = CHI_ENG
			}
			if = {
				limit = {
					OR = {
						original_tag = CHI
						original_tag = QIN
					}
					FROM = {
						tag = RUS
					}
				}
				set_cosmetic_tag = CHI_RUS
			}
			if = {
				limit = {
					OR = {
						original_tag = CHI
						original_tag = QIN
					}
					FROM = {
						tag = KOR
						has_cosmetic_tag = KOR_joseon
					}
				}
				set_cosmetic_tag = CHI_ming
			}
			if = {
				limit = {
					OR = {
						original_tag = CHI
						original_tag = QIN
					}
					FROM = {
						tag = KOR
						NOT = { has_cosmetic_tag = KOR_joseon }
					}
				}
				set_cosmetic_tag = CHI_KOR
			}
			#Turks
			if = {
				limit = {
					original_tag = TUR
					NOT = {
						has_country_flag = TUR_national_movement_tag
						has_cosmetic_tag = TUR_republic
					}
					FROM = {
						tag = RUS
					}
				}
				set_cosmetic_tag = TUR_RUS
			}
			if = {
				limit = {
					original_tag = BUL
					FROM = {
						tag = TUR
					}
				}
				set_cosmetic_tag = BUL_TUR
			}
			if = {
				limit = {
					original_tag = SER
					FROM = {
						tag = TUR
					}
				}
				set_cosmetic_tag = SER_TUR
			}
			if = {
				limit = {
					original_tag = GRE
					FROM = {
						tag = TUR
					}
				}
				set_cosmetic_tag = GRE_TUR
			}
			if = {
				limit = {
					original_tag = MNT
					FROM = {
						tag = TUR
					}
				}
				set_cosmetic_tag = MNT_TUR
			}
			#Persia
			if = {
				limit = {
					original_tag = PER
					FROM = {
						tag = RUS
					}
				}
				set_cosmetic_tag = PER_RUS
			}
			if = {
				limit = {
					original_tag = PER
					FROM = {
						tag = ENG
					}
				}
				set_cosmetic_tag = PER_ENG
			}
			#Japan
			if = {
				limit = {
					original_tag = JAP
					NOT = {
						KOR = {
							has_cosmetic_tag = KOR_social
						}
					}
					FROM = {
						tag = KOR
						NOT = { has_cosmetic_tag = KOR_joseon }
					}
				}
				set_cosmetic_tag = JAP_KOR_original
			}
			if = {
				limit = {
					original_tag = JAP
					KOR = {
						has_cosmetic_tag = KOR_social
					}
					FROM = {
						tag = KOR
						NOT = { has_cosmetic_tag = KOR_joseon }
					}
				}
				set_cosmetic_tag = JAP_KOR_social
			}
			if = {
				limit = {
					original_tag = JAP
					NOT = {
						KOR = {
							has_cosmetic_tag = KOR_social
						}
					}
					FROM = {
						tag = KOR
						has_cosmetic_tag = KOR_joseon
					}
				}
				set_cosmetic_tag = JAP_KOR_joseon
			}
			#Manchuria
			if = {
				limit = {
					original_tag = MAN
					FROM = {
						tag = KOR
						has_cosmetic_tag = KOR_joseon
					}
				}
				set_cosmetic_tag = MAN_jurchen
			}
			#Transamur
			if = {
				limit = {
					original_tag = FER
					FROM = {
						tag = KOR
						has_cosmetic_tag = KOR_joseon
					}
				}
				set_cosmetic_tag = FER_jurchen
			}
			if = {
				limit = {
					original_tag = FER
					FROM = {
						tag = KOR
						NOT = { has_cosmetic_tag = KOR_joseon }
					}
				}
				set_cosmetic_tag = FER_KOR
			}
			if = {
				limit = {
					original_tag = FER
					FROM = {
						tag = JAP
					}
				}
				set_cosmetic_tag = FER_JAP
			}
			#Mengjiang
			if = {
				limit = {
					original_tag = MEN
					FROM = {
						tag = KOR
						has_cosmetic_tag = KOR_joseon
					}
				}
				set_cosmetic_tag = MEN_korchin
			}
			#Vietnam
			if = {
				limit = {
					original_tag = IND
					FROM = {
						tag = KOR
						NOT = { has_cosmetic_tag = KOR_joseon }
					}
				}
				set_cosmetic_tag = IND_KOR
			}
			#Tannu Tuva
			if = {
				limit = {
					original_tag = TAN
					FROM = {
						tag = KOR
						has_cosmetic_tag = KOR_joseon
					}
				}
				set_cosmetic_tag = TAN_oirat
			}
			if = {
				limit = {
					has_country_flag = ITA_republican_italy_flag
					FROM = {
						has_country_flag = ITA_monarchist_italy_flag
					}
				}
				ITS = {
					annex_country = {
						target = ROI
					}
				}
			}
			if = {
				limit = {
					has_country_flag = ITA_republican_italy_flag
					FROM = {
						has_country_flag = ITA_socialist_italy_flag
					}
				}
				SRI = {
					annex_country = {
						target = ROI
					}
				}
			}
			if = {
				limit = {
					has_country_flag = ITA_socialist_italy_flag
					FROM = {
						has_country_flag = ITA_republican_italy_flag
					}
				}
				ROI = {
					annex_country = {
						target = SRI
					}
				}
			}
			if = {
				limit = {
					has_country_flag = ITA_socialist_italy_flag
					FROM = {
						has_country_flag = ITA_monarchist_italy_flag
					}
				}
				ITS = {
					annex_country = {
						target = SRI
					}
				}
			}
			if = {
				limit = {
					tag = ITS
					FROM = {
						has_country_flag = ITA_republican_italy_flag
					}
				}
				ROI = {
					annex_country = {
						target = ITS
					}
				}
			}
			if = {
				limit = {
					tag = ITS
					FROM = {
						has_country_flag = ITA_socialist_italy_flag
					}
				}
				SRI = {
					annex_country = {
						target = ITS
					}
				}
			}
			if = {
				limit = {
					original_tag = FRA
					OR = {
						has_country_flag = FRA_socialist_france_flag
						has_country_flag = FRA_nationalist_france_flag
					}
					FROM = {
						original_tag = FRA
						OR = {
							has_country_flag = FRA_socialist_france_flag
							has_country_flag = FRA_nationalist_france_flag
						}
					}
				}
				FROM = {
					annex_country = {
						target = ROOT
					}
				}
			}
			if = {
				limit = {
					tag = FNG
					MAN = {
						is_subject_of = KOR
					}
					FROM = {
						tag = KOR
					}
				}
				MAN = {
					annex_country = {
						target = FNG
						transfer_troops = yes
					}
				}
			}
			if = {
				limit = {
					ROOT = {
						has_country_flag = protectorate
					}
				}
				ROOT = {
					clr_country_flag = protectorate
				}
			}
			if = {
				limit = {
					original_tag = QBC
					is_subject_of = FRA
					FRA = {
						has_cosmetic_tag = FRA_THIRD_EMPIRE
					}
					has_government = neutrality
				}
				set_cosmetic_tag = QBC_FRA_EMPIRE
			}
			if = {
				limit = {
					original_tag = QBC
					is_subject_of = FRA
					NOT = {
						FRA = {
							has_cosmetic_tag = FRA_THIRD_EMPIRE
						}
					}
					has_government = neutrality
				}
				set_cosmetic_tag = QBC_FRA_KINGDOM
			}
			if = {
				limit = {
					original_tag = USA
					FROM = {
						tag = FRA
					}
				}
				set_cosmetic_tag = USA_FRA
			}
			if = {
				limit = {
					original_tag = TUN
					FROM = {
						tag = FRA
					}
				}
				set_cosmetic_tag = TUN_FRA
			}
			if = {
				limit = {
					tag = HUN
					FROM = {
						tag = AUS
					}
					is_greater_german_cosmetic = no
				}
				AUH_create_habsburg = yes
			}
			if = {
				limit = {
					original_tag = VNC
					is_subject_of = AUS
				}
				set_cosmetic_tag = VNC_AUS
				VNC_eugen_von_osterreich_teschen = {
					if = {
						limit = {
							has_ideology = semi_constitutional_monarchy
						}
						promote_character = semi_constitutional_monarchy
					}
					else = {
						add_country_leader_role = {
							promote_leader = yes
							country_leader = {
								ideology = semi_constitutional_monarchy
								traits = { foreign_leader }
							}
						}
					}
				}
				set_party_name = {
					ideology = neutrality 
					long_name = VNC_neutrality_AUH_party_long 
					name = VNC_neutrality_AUH_party 
				}
				add_state_core = 159
				add_ideas = AUH_ww1_House_Habsburg_Lorraine
			}
			if = {
				limit = {
					original_tag = SLV
					is_subject_of = AUS
				}
				set_cosmetic_tag = SLV_AUS
			}
			if = {
				limit = {
					original_tag = SLO
					is_subject_of = AUS
				}
				set_cosmetic_tag = SLO_AUS
			}
			if = {
				limit = {
					original_tag = TRA
					is_subject_of = AUS
				}
				set_cosmetic_tag = TRA_AUS
			}
			if = {
				limit = {
					original_tag = WUK
					is_subject_of = AUS
				}
				set_cosmetic_tag = WUK_AUS
			}
			if = {
				limit = {
					tag = UKR
					is_subject_of = AUS
					has_government = neutrality
				}
				UKR_vasyl_i = {
					set_character_name = UKR_vasyl_i
					if = {
						limit = { has_ideology = semi_constitutional_monarchy }
						promote_character = semi_constitutional_monarchy
					}
					else = {
						add_country_leader_role = {
							country_leader = {
								ideology = semi_constitutional_monarchy
								traits = { knyaz_vasyl }
							}
							promote_leader = yes
						}
					}
				}
				set_cosmetic_tag = UKR_KNG
				set_party_name = {
					ideology = neutrality
					long_name = UKR_monarchy_party
					name = UKR_monarchy_party
				}
			}
			if = {
				limit = {
					original_tag = SER
					FROM = { tag = AUS }
					NOT = {
						has_autonomy_state = autonomy_dominion
						has_autonomy_state = autonomy_tgwr_real_union
					}
				}
				AUH_puppet_SER = yes
			}
			if = {
				limit = {
					original_tag = LIT
					has_government = neutrality
					OR = {
						AND = {
							is_subject_of = GER
							# GER = {
							# 	has_completed_focus = GER_puppet_kingdoms
							# }
						}
						AND = {
							is_subject_of = AUS
							GER = {
								OR = {
									exists = no
									is_subject_of = AUS
								}
							}
						}
					}
				}
				set_cosmetic_tag = LIT_GER
				set_party_name = {
					ideology = neutrality
					long_name = LIT_kingdom_party
					name = LIT_kingdom_party
				}
				set_country_flag = released_by_germany
				if = {
					limit = {
						date < 1928.3.24
					}
					GER = {
						GER_wilhelm_karl_von_urach = {
							set_character_name = LIT_mindaugas_ii
							promote_leader = yes
							set_nationality = LIT
							if = {
								limit = { has_ideology = semi_constitutional_monarchy }
								promote_character = semi_constitutional_monarchy
							}
							else = {
								add_country_leader_role = {
									country_leader = {
										ideology = semi_constitutional_monarchy
										traits = { german_agent  }
									}
									promote_leader = yes
								}
							}
						}
					}
					else = {
						LIT_vytautas_ii = {
							if = {
								limit = { has_ideology = semi_constitutional_monarchy }
								promote_character = semi_constitutional_monarchy
							}
							else = {
								add_country_leader_role = {
									country_leader = {
										ideology = semi_constitutional_monarchy
										traits = { german_agent  }
									}
									promote_leader = yes
								}
							}
						}
					}
				}
				set_party_name = {
					ideology = neutrality
					long_name = LIT_kingdom_party
					name = LIT_kingdom_party
				}
				set_country_flag = released_by_germany
			}
			if = {
				limit = {
					original_tag = LAT
					is_subject_of = GER
					has_government = neutrality
					# GER = {
					# 	has_completed_focus = GER_puppet_kingdoms
					# }
				}
				UBD = {
					annex_country = {
						target = LAT
					}
				}
				every_state = {
					limit = {
						is_owned_by = UBD
						is_core_of = LAT
					}
					add_core_of = UBD
				}
				if = {
					limit = {
						NOT = {
							UBD = {
								is_subject_of = GER
							}
						}
					}
					GER = {
						puppet = UBD
					}
				}
			}
			if = {
				limit = {
					original_tag = EST
					is_subject_of = GER
					has_government = neutrality
					# GER = {
					# 	has_completed_focus = GER_puppet_kingdoms
					# }
				}
				UBD = {
					annex_country = {
						target = EST
					}
				}
				every_state = {
					limit = {
						is_owned_by = UBD
						is_core_of = EST
					}
					add_core_of = UBD
				}
				if = {
					limit = {
						NOT = {
							UBD = {
								is_subject_of = GER
							}
						}
					}
					GER = {
						puppet = UBD
					}
				}
			}
			if = {
				limit = {
					original_tag = BLR
					OR = {
						is_subject_of = GER
						is_subject_of = AUS
					}
				}
				set_cosmetic_tag = BLR_WHR
				set_party_name = {
					ideology = neutrality
					long_name = GER_neutrality_party
					name = GER_neutrality_party
				}
				if = {
					limit = {
						date < 1929.4.20
					}
					BLR_genrikh = {
						if = {
							limit = { has_ideology = semi_constitutional_monarchy }
							promote_character = semi_constitutional_monarchy
						}
						else = {
							add_country_leader_role = {
								promote_leader = yes
								country_leader = {
									ideology = semi_constitutional_monarchy
									traits = { german_agent }
								}
							}
						}
					}	
					GER = {
						GER_albert_wilhelm_heinrich = {
							set_character_name = BLR_genrikh
							set_nationality = BLR
						}
					}
				}
				else = {
					BLR_uladzimir = {
						if = {
							limit = { has_ideology = semi_constitutional_monarchy }
							promote_character = semi_constitutional_monarchy
						}
						else = {
							add_country_leader_role = {
								promote_leader = yes
								country_leader = {
									ideology = semi_constitutional_monarchy	
									traits = { german_agent }
								}
							}
						}
					}
					GER = {
						retire_character = GER_albert_wilhelm_heinrich
					}
				}
			}
			if = {
				limit = {
					original_tag = FRA
					is_subject_of = GER
					NOT = {
						any_country = {
							has_cosmetic_tag = FRP
						}
					}
				}
				if = {
					limit = {
						GER = {
							NOT = {
								has_government = communism
								has_country_leader_ideology = national_syndicalism
							}
						}
					}
					set_cosmetic_tag = FRP
					else = {
						set_cosmetic_tag = FRA_socialism
					}
				}
				create_country_leader = {
					name = "GER_erich_ludendorff"
					picture = "gfx/leaders/GER/GER_erich_ludendorff.png" 
					ideology = stratocracy
					traits = { foreign_leader german_agent }
				}
				create_country_leader = {
					name = "FRA_gouvernement_provisoire"
					picture = "gfx/leaders/FRA/FRA_provisional_government.png"
					ideology = authoritarian_democracy
					traits = {
						german_agent
					}
				}
				create_country_leader = {
					name = "FRA_gouvernement_provisoire"
					picture = "gfx/leaders/FRA/FRA_provisional_government.png"
					ideology = conservatism
					traits = {
						german_agent
					}
				}
				set_party_name = {
					ideology = democratic
					long_name = NFA_fascism_party_long
					name = NFA_fascism_party
				}
				set_party_name = {
					ideology = neutrality
					long_name = NFA_fascism_party_long
					name = NFA_fascism_party
				}
				set_party_name = {
					ideology = fascism
					long_name = GER_fascism_party_long
					name = GER_fascism_party
				}
				if = {
					limit = {
						GER = {
							is_GER_a_monarchy = yes
						}
					}
					if = {
						limit = {
							has_character = FRA_victoire
						}
						FRA_victoire = {
							if = {
								limit = {
									is_country_leader = yes
								}
								promote_character = personalistic_dictatorship
							}
							else = {
								add_country_leader_role = {
									promote_leader = yes
									country_leader = {
										ideology = personalistic_dictatorship
										traits = { victoria_iii foreign_leader german_agent }
									}
								}
							}
						}
						else = {
							create_country_leader = {
								name = "FRA_victoire"
								picture = "gfx/leaders/GER/GER_Victoria_Louise.png"
								ideology = personalistic_dictatorship
								female = yes
								traits = {
									victoria_iii
									foreign_leader
									german_agent
								}
							}
						}
					}
					set_party_name = {
						ideology = neutrality
						long_name = GER_neutrality_party
						name = GER_neutrality_party
					}
					set_politics = {
						ruling_party = neutrality
						elections_allowed = no
					}
					set_popularities = {
						democratic = 14
						neutrality = 52
						fascism = 34
						communism = 10
					}
					else_if = {
						limit = {
							NOT = { has_government = communism }
						}
						set_politics = {
							ruling_party = fascism
							elections_allowed = no
						}
						set_popularities = {
							democratic = 30
							neutrality = 32
							fascism = 38
							communism = 10
						}
					}
				}
			}
			if = {
				limit = {
					original_tag = POL
					is_subject_of = SOV
					has_government = communism
				}
				set_cosmetic_tag = POL_SOVIET
				every_possible_country = {
					limit = {
						has_character = SOV_felix_dzerzhinsky
					}	
					SOV_felix_dzerzhinsky = {
						set_nationality = POL
						set_character_name = POL_felix_dzerzhinsky
						promote_character = vanguardism
					}			
				}
				set_party_name = {
					ideology = communism
					name = POL_polrewkom_party
					long_name = POL_polrewkom_party_long
				}
				set_cosmetic_tag = POL_SOVIET
			}
			if = {
				limit = {
					original_tag = UKR
					FROM = {
						OR = {
							tag = SOV
							has_cosmetic_tag = SOV
						}
					}
					has_government = communism
					NOT = {
						tag = RUC
						has_cosmetic_tag = UKR_communism
						has_cosmetic_tag = UKR_SOV_provisional
					}	
				}
				UKR = {
					UKR_yuriy_pyatakov = { 
						set_nationality = PREV.PREV 
						promote_character = yes
					}
				}
				SOV = {
					SOV_christian_rakovsky = { 
						set_nationality = PREV.PREV 
						promote_character = yes
					}
				}
				set_party_name = {
					ideology = communism
					name = UKR_communist_party
					long_name = UKR_communist_party_long
				}
				set_cosmetic_tag = UKR_SOV
			}
			if = {
				limit = {
					original_tag = ARM
					FROM = {
						OR = {
							tag = SOV
							has_cosmetic_tag = SOV
						}
					}	
					has_government = communism
				}
				ARM_sarkis_kasyan = {
					promote_character = yes
				}
				set_party_name = {
					ideology = communism
					name = ARM_communist_party
					long_name = ARM_communist_party_long
				}
				set_cosmetic_tag = ARM_SOV
			}
			if = {
				limit = {
					OR = {
						original_tag = SLV
						original_tag = CRO
						original_tag = TRA
						original_tag = BOS
						original_tag = GAL
						original_tag = MOL
						original_tag = MNT
						original_tag = WUK
					}
					is_subject_of = HUN
					has_government = communism
				}
				set_cosmetic_tag = HUN_socialism_puppet
			}
			if = {
				limit = {
					OR = {
						original_tag = SLV
						is_constituent_of_germany = yes
					}
					OR = {
						is_subject_of = GER
						is_subject_of = BAY
					}
					has_government = communism
				}
				set_cosmetic_tag = GER_socialism
			}
			#Crete
			if = {
				limit = {
					original_tag = CRE
					is_subject_of = TUR
				}
				set_cosmetic_tag = CRE_TUR
			}
			if = {
				limit = {
					original_tag = CRI
					GER = {
						has_subject = PREV
						is_GER_a_monarchy = yes
					}
				}
				set_cosmetic_tag = CRI_GER
				set_politics = {
					ruling_party = neutrality
					elections_allowed = no
				}
				set_popularities = {
					democratic = 21
					neutrality = 39
					fascism = 10
					communism = 30
				}
				set_party_name = {
					ideology = neutrality
					long_name = CRI_regional_government
					name = CRI_regional_government
				}
				RUS = {
					RUS_matvei_sulkevich = {
						set_character_name = CRI_maciej_sulkiewicz
						set_nationality = CRI
					}
				}
				if = {
					limit = {
						has_character = RUS_matvei_sulkevich
					}
					RUS_matvei_sulkevich = {
						add_country_leader_role = {
							country_leader = {
								ideology = authoritarian_democracy
							}
						}
						promote_character = authoritarian_democracy
					}
				}
			}
			if = {
				limit = {
					original_tag = ALS
					is_subject_of = GER
					has_government = neutrality
				}
				set_cosmetic_tag = ALS_GER
			}
			if = {
				limit = {
					original_tag = ANC
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = ANC_QIN
				}
			}
			if = {
				limit = {
					original_tag = FNG
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = FNG_QIN
				}
			}
			if = {
				limit = {
					original_tag = GDC
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = GDC_QIN
				}
			}
			if = {
				limit = {
					original_tag = GXC
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = GXC_QIN
				}
			}
			if = {
				limit = {
					original_tag = GZC
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = GZC_QIN
				}
			}
			if = {
				limit = {
					original_tag = JNC
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
						NOT = {
							has_cosmetic_tag = NPA_clique
							has_cosmetic_tag = LEP
						}
					}
					set_cosmetic_tag = JNC_QIN
				}
			}
			if = {
				limit = {
					original_tag = JXC
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = JXC_QIN
				}
			}
			if = {
				limit = {
					original_tag = SCC
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = SCC_QIN
				}
			}
			if = {
				limit = {
					original_tag = SDC
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = SDC_QIN
				}
			}
			if = {
				limit = {
					original_tag = SHN
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = SHN_QIN
				}
			}
			if = {
				limit = {
					original_tag = YUN
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = YUN_QIN
				}
			}
			if = {
				limit = {
					original_tag = ZHE
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = ZHE_QIN
				}
			}
			if = {
				limit = {
					original_tag = XSM
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = XSM_QIN
				}
			}
			if = {
				limit = {
					original_tag = GXC
				}
				if = {
					limit = {
						FROM = {
							is_kuomintang_state = yes
						}
					}
					set_cosmetic_tag = GXC_KMT
				}
			}
			if = {
				limit = {
					original_tag = YUN
				}
				if = {
					limit = {
						FROM = {
							is_kuomintang_state = yes
						}
					}
					set_cosmetic_tag = YUN_KMT
				}
			}
			if = {
				limit = {
					original_tag = XSM
				}
				if = {
					limit = {
						FROM = {
							is_kuomintang_state = yes
						}
					}
					set_cosmetic_tag = XSM_KMT
				}
			}
			if = {
				limit = {
					original_tag = FNG
				}
				if = {
					limit = {
						FROM = {
							is_kuomintang_state = yes
						}
					}
					set_cosmetic_tag = FNG_KMT
				}
			}
			if = {
				limit = {
					original_tag = SIK
				}
				if = {
					limit = {
						FROM = {
							is_kuomintang_state = yes
						}
					}
					set_cosmetic_tag = SIK_KMT
				}
			}
			if = {
				limit = {
					original_tag = SCC
				}
				if = {
					limit = {
						FROM = {
							is_kuomintang_state = yes
						}
					}
					set_cosmetic_tag = SCC_KMT
				}
			}
			if = {
				limit = {
					original_tag = SRL
					FROM = {
						tag = ENG
					}
				}
				set_cosmetic_tag = SRL_ENG
			}
			if = {
				limit = {
					original_tag = LBA
					FROM = {
						tag = TUR
					}
				}
				set_cosmetic_tag = LBA_TUR
			}
			if = {
				limit = {
					original_tag = HJZ
					is_subject_of = TUR
					NOT = {
						has_cosmetic_tag = HJZ_sharifate
						has_cosmetic_tag = HJZ_arabia
					}
				}
				set_cosmetic_tag = HJZ_sharifate
			}
			if = {
				limit = {
					tag = SPR
					FROM = {
						is_subject = no
						OR = {
							has_country_leader = {
								character = FRA_jacques_i
								ruling_only = yes
							}
							has_country_leader = {
								character = FRA_charles_xii
								ruling_only = yes
							}
							has_idea = FRA_jacques_i
						}
						has_monarchy = yes
					}
				}
				set_country_flag = monarchist_puppet
				FROM = {
					set_autonomy = {
						target = ROOT
						autonomy_state = autonomy_tgwr_personal_union
					}
				}
				set_politics = {
					ruling_party = neutrality
					long_name = SPR_neutrality_party
					name = SPR_neutrality_party
				}
				set_cosmetic_tag = SPR_carlist_spain
				set_popularities = {
					democratic = 43
					neutrality = 39
					fascism = 10
					communism = 8
				}
				if = {
					limit = {
						NOT = { has_character = SPR_alfonso_carlos_i }
					}
					every_possible_country = {
						limit = { has_character = SPR_alfonso_carlos_i }
						SPR_alfonso_carlos_i = {
							set_nationality = PREV.PREV
						}
					}
				}
				if = {
					limit = {
						NOT = { has_character = SPR_jaime_iii }
					}
					every_possible_country = {
						limit = { has_character = SPR_jaime_iii }
						SPR_jaime_iii = {
							set_nationality = PREV.PREV
						}
					}
				}
				SPR_alfonso_carlos_i = {
					if = {
						limit = { has_ideology = semi_constitutional_monarchy }
						promote_character = semi_constitutional_monarchy
					}
					else = {
						add_country_leader_role = {
							promote_leader = yes
							country_leader = {
								ideology = semi_constitutional_monarchy
							}
						}
					}
				}
				if = {
					limit = {
						FROM = {
							OR = {
								has_country_leader = {
									character = FRA_jacques_i
									ruling_only = yes
								}
								has_idea = FRA_jacques_i
							}
						}
					}
					SPR_jaime_iii = {
						if = {
							limit = { has_ideology = semi_constitutional_monarchy }
							promote_character = semi_constitutional_monarchy
						}
						else = {
							add_country_leader_role = {
								promote_leader = yes
								country_leader = {
									ideology = semi_constitutional_monarchy
								}
							}
						}
					}
				}
			}
			# League of Nations
			if = {
				limit = {
					is_league_of_nations_member = yes
					OVERLORD = {
						is_league_of_nations_member = no
					}
				}
				leave_the_league_of_nations = yes
			}
			if = {
				limit = {
					is_league_of_nations_member = no
					OVERLORD = {
						is_league_of_nations_member = yes
					}
					# Puppets won't join
					NOT = {
						is_puppet = yes
						has_autonomy_state = autonomy_tgwr_informal_protectorate
						has_autonomy_state = autonomy_wtt_imperial_subject
						has_autonomy_state = autonomy_tgwr_ottoman_emirate #they have no diplomatic rights
						has_autonomy_state = autonomy_tgwr_unilateral_union #they don't want to be a independent nation
						has_autonomy_state = autonomy_tgwr_regional_government
					}	
				}
				join_the_league_of_nations = yes
			}
			if = {
				limit = {
					is_in_faction = yes
					has_war = no
					OR = {
						has_autonomy_state = autonomy_tgwr_protectorate
						has_autonomy_state = autonomy_tgwr_informal_protectorate
						has_autonomy_state = autonomy_tgwr_ottoman_emirate
						has_autonomy_state = autonomy_tgwr_concession
					}
				}
				leave_faction = yes	
				OVERLORD = {
					diplomatic_relation = {
						country = PREV
						relation = military_access
						active = yes
					}
				}
			}
			log = "[GetDateText]: [ROOT.GetName] has been puppeted by [FROM.GetName]"
		}
	}
	on_release_as_puppet = {
		effect = {
			if = {
				limit = {
					OR = {
						original_tag = BLR
						original_tag = MOL
						original_tag = EST
						original_tag = LAT
						original_tag = LIT
						original_tag = COU
						original_tag = GEO
						original_tag = MOU
						original_tag = AZR
						original_tag = KAZ
						original_tag = TRK
						original_tag = FIN
						original_tag = GAL
						original_tag = WUK
						original_tag = BUK
						original_tag = KHI
						original_tag = PER
						original_tag = MON
						original_tag = TAN
					}			
					NOT = {
						has_cosmetic_tag = SOV_puppet
						has_cosmetic_tag = GEO_TSCN_commissariat
						has_cosmetic_tag = GEO_TSCN_committee
						has_cosmetic_tag = GEO_TSCN
						has_cosmetic_tag = GEO_TSCN_communism
						has_cosmetic_tag = LITBEL
					}
					FROM = {
						OR = {
							tag = SOV
							has_cosmetic_tag = SOV
						}
						has_government = communism
					}
				}
				set_cosmetic_tag = SOV_puppet
			}
			if = {
				limit = {
					has_cosmetic_tag = SOV_puppet
					FROM = {
						NOT = {
							tag = SOV
						}
					}
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					original_tag = CAN
					is_subject_of = ENG
				}
				set_cosmetic_tag = CAN_UK
			}
			if = {
				limit = {
					original_tag = NFL
					OR = {
						is_subject_of = ENG
						AND = {
							is_subject = yes
							OVERLORD = { has_country_flag = has_british_monarchy }
						}
					}
				}
				set_cosmetic_tag = NFL_UK
			}
			if = {
				limit = {
					original_tag = USA
					OR = {
						has_government = democratic
						has_government = neutrality
					}
					FROM = {
						original_tag = SER
					}
				}
				USA = {
					USA_nikola_tesla = {
						add_country_leader_role = {
							promote_leader = yes
							country_leader = {
								ideology = classical_liberalism
								traits = {
									tgwr_inventive_genius
								}
							}
						}
						add_country_leader_role = {
							promote_leader = yes
							country_leader = {
								ideology = authoritarian_democracy
								traits = {
									tgwr_inventive_genius
								}
							}
						}
					}				
				}
			}
			if = {
				limit = {
					original_tag = CAN
					FROM = {
						tag = USA
					}
				}
				set_cosmetic_tag = CAN_USA
			}
			if = {
				limit = {
					original_tag = ENG
					FROM = {
						tag = USA
					}
				}
				set_cosmetic_tag = ENG_USA
			}
			if = {
				limit = {
					original_tag = MEX
					FROM = {
						tag = ENG
					}
				}
				set_cosmetic_tag = MEX_ENG
			}
			if = {
				limit = {
					original_tag = USA
					FROM = {
						tag = ENG
					}
				}
				set_cosmetic_tag = USA_UK				#vanilla hoi4
			}
			if = {
				limit = {
					original_tag = USA
					FROM = {
						tag = GER
					}
				}
				USA = {
					set_cosmetic_tag = USA_GER
					USA_charles_john_hexamerk = {
						promote_character = yes
					}					
				}
			}
			if = {
				limit = {
					original_tag = USA
					FROM = {
						tag = RUS
					}
				}
				set_cosmetic_tag = USA_RUS				#историческая справедливость
			}
			if = {
				limit = {
					original_tag = POL
					FROM = {
						tag = RUS
					}
					RUS = {
						NOT = {
							has_completed_focus = RUS_self_determination_of_nations
						}
					}
				}
				set_cosmetic_tag = POL_RUS
			}
			if = {
				limit = {
					original_tag = KAZ
					FROM = {
						tag = RUS
					}
					RUS = {
						NOT = {
							has_completed_focus = RUS_self_determination_of_nations
						}
					}
				}
				set_cosmetic_tag = KAZ_RUS
			}
			if = {
				limit = {
					original_tag = TRK
					FROM = {
						tag = RUS
					}
					RUS = {
						NOT = {
							has_completed_focus = RUS_self_determination_of_nations
						}
					}
				}
				set_cosmetic_tag = TRK_RUS
			}
			#China/Qing
			if = {
				limit = {
					OR = {
						original_tag = CHI
						original_tag = QIN
					}
					FROM = {
						tag = GER
					}
				}
				set_cosmetic_tag = CHI_GER
			}
			if = {
				limit = {
					OR = {
						original_tag = CHI
						original_tag = QIN
					}
					FROM = {
						tag = ENG
					}
				}
				set_cosmetic_tag = CHI_ENG
			}
			if = {
				limit = {
					OR = {
						original_tag = CHI
						original_tag = QIN
					}
					FROM = {
						tag = RUS
					}
				}
				set_cosmetic_tag = CHI_RUS
			}
			if = {
				limit = {
					OR = {
						original_tag = CHI
						original_tag = QIN
					}
					FROM = {
						tag = KOR
						has_cosmetic_tag = KOR_joseon
					}
				}
				set_cosmetic_tag = CHI_ming
			}
			if = {
				limit = {
					OR = {
						original_tag = CHI
						original_tag = QIN
					}
					FROM = {
						tag = KOR
						NOT = { has_cosmetic_tag = KOR_joseon }
					}
				}
				set_cosmetic_tag = CHI_KOR
			}
			#Turks
			if = {
				limit = {
					original_tag = TUR
					NOT = {
						has_country_flag = TUR_national_movement_tag
						has_cosmetic_tag = TUR_republic
					}
					FROM = {
						tag = RUS
					}
				}
				set_cosmetic_tag = TUR_RUS
			}
			if = {
				limit = {
					original_tag = BUL
					FROM = {
						tag = TUR
					}
				}
				set_cosmetic_tag = BUL_TUR
			}
			if = {
				limit = {
					original_tag = SER
					FROM = {
						tag = TUR
					}
				}
				set_cosmetic_tag = SER_TUR
			}
			if = {
				limit = {
					original_tag = GRE
					NOT = {
						has_cosmetic_tag = GRE_national_defense
						has_cosmetic_tag = GRE_balkan_federation
						has_cosmetic_tag = BYZ
					}
					FROM = {
						tag = TUR
					}
				}
				set_cosmetic_tag = GRE_TUR
			}
			if = {
				limit = {
					original_tag = MNT
					FROM = {
						tag = TUR
					}
				}
				set_cosmetic_tag = MNT_TUR
			}
			#Persia
			if = {
				limit = {
					original_tag = PER
					FROM = {
						tag = RUS
					}
				}
				set_cosmetic_tag = PER_RUS
			}
			if = {
				limit = {
					original_tag = PER
					FROM = {
						tag = ENG
					}
				}
				set_cosmetic_tag = PER_ENG
			}
			#Japan
			if = {
				limit = {
					original_tag = JAP
					NOT = {
						KOR = {
							has_cosmetic_tag = KOR_social
						}
					}
					FROM = {
						tag = KOR
						NOT = { has_cosmetic_tag = KOR_joseon }
					}
				}
				set_cosmetic_tag = JAP_KOR_original
			}
			if = {
				limit = {
					original_tag = JAP
					KOR = {
						has_cosmetic_tag = KOR_social
					}
					FROM = {
						tag = KOR
						NOT = { has_cosmetic_tag = KOR_joseon }
					}
				}
				set_cosmetic_tag = JAP_KOR_social
			}
			if = {
				limit = {
					original_tag = JAP
					NOT = {
						KOR = {
							has_cosmetic_tag = KOR_social
						}
					}
					FROM = {
						tag = KOR
						has_cosmetic_tag = KOR_joseon
					}
				}
				set_cosmetic_tag = JAP_KOR_joseon
			}
			#Manchuria
			if = {
				limit = {
					original_tag = MAN
					FROM = {
						tag = KOR
						has_cosmetic_tag = KOR_joseon
					}
				}
				set_cosmetic_tag = MAN_jurchen
			}
			#Transamur
			if = {
				limit = {
					original_tag = FER
					FROM = {
						tag = KOR
						has_cosmetic_tag = KOR_joseon
					}
				}
				set_cosmetic_tag = FER_jurchen
			}
			if = {
				limit = {
					original_tag = FER
					FROM = {
						tag = KOR
						NOT = { has_cosmetic_tag = KOR_joseon }
					}
				}
				set_cosmetic_tag = FER_KOR
			}
			if = {
				limit = {
					original_tag = FER
					FROM = {
						tag = JAP
					}
				}
				set_cosmetic_tag = FER_JAP
			}
			#Mengjiang
			if = {
				limit = {
					original_tag = MEN
					FROM = {
						tag = KOR
						has_cosmetic_tag = KOR_joseon
					}
				}
				set_cosmetic_tag = MEN_korchin
			}
			#Vietnam
			if = {
				limit = {
					original_tag = IND
					FROM = {
						tag = KOR
						NOT = { has_cosmetic_tag = KOR_joseon }
					}
				}
				set_cosmetic_tag = IND_KOR
			}
			#Tannu Tuva
			if = {
				limit = {
					original_tag = TAN
					FROM = {
						tag = KOR
						has_cosmetic_tag = KOR_joseon
					}
				}
				set_cosmetic_tag = TAN_oirat
			}
			if = {
				limit = {
					ROOT = {
						has_country_flag = protectorate
					}
				}
				ROOT = {
					clr_country_flag = protectorate
				}
			}
			if = {
				limit = {
					original_tag = QBC
					FROM = { tag = FRA }
					FRA = {
						has_cosmetic_tag = FRA_THIRD_EMPIRE
					}
					has_government = neutrality
				}
				set_cosmetic_tag = QBC_FRA_EMPIRE
			}
			if = {
				limit = {
					original_tag = QBC
					FROM = { tag = FRA }
					NOT = {
						FRA = {
							has_cosmetic_tag = FRA_THIRD_EMPIRE
						}
					}
					has_government = neutrality
				}
				set_cosmetic_tag = QBC_FRA_KINGDOM
			}
			if = {
				limit = {
					original_tag = USA
					FROM = {
						tag = FRA
					}
				}
				set_cosmetic_tag = USA_FRA
			}
			if = {
				limit = {
					original_tag = TUN
					FROM = {
						tag = FRA
					}
				}
				set_cosmetic_tag = TUN_FRA
			}
			if = {
				limit = {
					tag = HUN
					FROM = {
						tag = AUS	
						NOT = {
							has_country_flag = AUS_republic_flag
						}
					}
					is_greater_german_cosmetic = no
				}
				AUH_create_habsburg = yes
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					original_tag = VNC
					FROM = {
						tag = AUS	
						NOT = {
							has_country_flag = AUS_republic_flag
						}
					}
				}
				set_cosmetic_tag = VNC_LOM
				VNC_eugen_von_osterreich_teschen = {
					add_country_leader_role = {
						promote_leader = yes
						country_leader = {
							ideology = semi_constitutional_monarchy
							traits = { foreign_leader }
						}
					}
				}
				set_party_name = {
					ideology = neutrality 
					long_name = VNC_neutrality_AUH_party_long 
					name = VNC_neutrality_AUH_party 
				}
				add_state_core = 159
			}
			if = {
				limit = {
					tag = UKR
					FROM = { tag = AUS }
					has_government = neutrality
				}
				UKR_vasyl_i = {
					set_character_name = UKR_vasyl_i
					if = {
						limit = { has_ideology = semi_constitutional_monarchy }
						promote_character = semi_constitutional_monarchy
					}
					else = {
						add_country_leader_role = {
							country_leader = {
								ideology = semi_constitutional_monarchy
								traits = { knyaz_vasyl }
							}
							promote_leader = yes
						}
					}
				}
				set_cosmetic_tag = UKR_KNG
				set_party_name = {
					ideology = neutrality
					long_name = UKR_monarchy_party
					name = UKR_monarchy_party
				}
			}
			if = {
				limit = {
					original_tag = SER
					FROM = { tag = AUS }
					NOT = {
						has_autonomy_state = autonomy_dominion
						has_autonomy_state = autonomy_tgwr_real_union
					}
				}
				AUH_puppet_SER = yes
			}
			if = {
				limit = {
					original_tag = LIT
					has_government = neutrality
					OR = {
						AND = {
							is_subject_of = GER
							# GER = {
							# 	has_completed_focus = GER_puppet_kingdoms
							# }
						}
						AND = {
							is_subject_of = AUH
							GER = {
								OR = {
									exists = no
									is_subject_of = AUH
								}
							}
						}
					}
				}
				set_cosmetic_tag = LIT_GER
				set_party_name = {
					ideology = neutrality
					long_name = LIT_kingdom_party
					name = LIT_kingdom_party
				}
				set_country_flag = released_by_germany
				if = {
					limit = {
						date < 1928.3.24
					}
					GER = {
						GER_wilhelm_karl_von_urach = {
							set_character_name = LIT_mindaugas_ii
							promote_leader = yes
							set_nationality = LIT
							if = {
								limit = { has_ideology = semi_constitutional_monarchy }
								promote_character = semi_constitutional_monarchy
							}
							else = {
								add_country_leader_role = {
									country_leader = {
										ideology = semi_constitutional_monarchy
										traits = { german_agent  }
									}
									promote_leader = yes
								}
							}
						}
					}
					else = {
						LIT_vytautas_ii = {
							if = {
								limit = { has_ideology = semi_constitutional_monarchy }
								promote_character = semi_constitutional_monarchy
							}
							else = {
								add_country_leader_role = {
									country_leader = {
										ideology = semi_constitutional_monarchy
										traits = { german_agent  }
									}
									promote_leader = yes
								}
							}
						}
					}
				}
				set_party_name = {
					ideology = neutrality
					long_name = LIT_kingdom_party
					name = LIT_kingdom_party
				}
				set_country_flag = released_by_germany
			}
			if = {
				limit = {
					original_tag = LAT
					is_subject_of = GER
					has_government = neutrality
					# GER = {
					# 	has_completed_focus = GER_puppet_kingdoms
					# }
				}
				UBD = {
					annex_country = {
						target = LAT
					}
				}
				every_state = {
					limit = {
						is_owned_by = UBD
						is_core_of = LAT
					}
					add_core_of = UBD
				}
				if = {
					limit = {
						NOT = {
							UBD = {
								is_subject_of = GER
							}
						}
					}
					GER = {
						puppet = UBD
					}
				}
			}
			if = {
				limit = {
					original_tag = EST
					is_subject_of = GER
					has_government = neutrality
					# GER = {
					# 	has_completed_focus = GER_puppet_kingdoms
					# }
				}
				UBD = {
					annex_country = {
						target = EST
					}
				}
				every_state = {
					limit = {
						is_owned_by = UBD
						is_core_of = EST
					}
					add_core_of = UBD
				}
				if = {
					limit = {
						NOT = {
							UBD = {
								is_subject_of = GER
							}
						}
					}
					GER = {
						puppet = UBD
					}
				}
			}
			if = {
				limit = {
					original_tag = BLR
					FROM = {
						OR = {
							tag = GER
							tag = AUS
						}
					}
				}
				set_cosmetic_tag = BLR_WHR
				set_party_name = {
					ideology = neutrality
					long_name = GER_neutrality_party
					name = GER_neutrality_party
				}
				if = {
					limit = {
						date < 1929.4.20
					}
					BLR_genrikh = {
						if = {
							limit = { has_ideology = semi_constitutional_monarchy }
							promote_character = semi_constitutional_monarchy
						}
						else = {
							add_country_leader_role = {
								promote_leader = yes
								country_leader = {
									ideology = semi_constitutional_monarchy
									traits = { german_agent }
								}
							}
						}
					}	
					GER = {
						GER_albert_wilhelm_heinrich = {
							set_character_name = BLR_genrikh
							set_nationality = BLR
						}
					}
				}
				else = {
					BLR_uladzimir = {
						if = {
							limit = { has_ideology = semi_constitutional_monarchy }
							promote_character = semi_constitutional_monarchy
						}
						else = {
							add_country_leader_role = {
								promote_leader = yes
								country_leader = {
									ideology = semi_constitutional_monarchy	
									traits = { german_agent }
								}
							}
						}
					}
					GER = {
						retire_character = GER_albert_wilhelm_heinrich
					}
				}
			}
			if = {
				limit = {
					original_tag = FRA
					is_subject_of = GER
					NOT = {
						any_country = {
							has_cosmetic_tag = FRP
						}
					}
				}
				if = {
					limit = {
						GER = {
							NOT = {
								has_government = communism
								has_country_leader_ideology = national_syndicalism
							}
						}
					}
					set_cosmetic_tag = FRP
					else = {
						set_cosmetic_tag = FRA_socialism
					}
				}
				create_country_leader = {
					name = "GER_erich_ludendorff"
					picture = "gfx/leaders/GER/GER_erich_ludendorff.png" 
					ideology = stratocracy
					traits = { foreign_leader german_agent }
				}
				create_country_leader = {
					name = "FRA_gouvernement_provisoire"
					picture = "gfx/leaders/FRA/FRA_provisional_government.png"
					ideology = authoritarian_democracy
					traits = {
						german_agent
					}
				}
				create_country_leader = {
					name = "FRA_gouvernement_provisoire"
					picture = "gfx/leaders/FRA/FRA_provisional_government.png"
					ideology = conservatism
					traits = {
						german_agent
					}
				}
				set_party_name = {
					ideology = democratic
					long_name = NFA_fascism_party_long
					name = NFA_fascism_party
				}
				set_party_name = {
					ideology = neutrality
					long_name = NFA_fascism_party_long
					name = NFA_fascism_party
				}
				set_party_name = {
					ideology = fascism
					long_name = GER_fascism_party_long
					name = GER_fascism_party
				}
				if = {
					limit = {
						GER = {
							is_GER_a_monarchy = yes
						}
					}
					if = {
						limit = {
							has_character = FRA_victoire
						}
						FRA_victoire = {
							if = {
								limit = {
									is_country_leader = yes
								}
								promote_character = personalistic_dictatorship
							}
							else = {
								add_country_leader_role = {
									promote_leader = yes
									country_leader = {
										ideology = personalistic_dictatorship
										traits = { victoria_iii foreign_leader german_agent }
									}
								}
							}
						}
						else = {
							create_country_leader = {
								name = "FRA_victoire"
								picture = "gfx/leaders/GER/GER_Victoria_Louise.png"
								ideology = personalistic_dictatorship
								female = yes
								traits = {
									victoria_iii
									foreign_leader
									german_agent
								}
							}
						}
					}
					set_party_name = {
						ideology = neutrality
						long_name = GER_neutrality_party
						name = GER_neutrality_party
					}
					set_politics = {
						ruling_party = neutrality
						elections_allowed = no
					}
					set_popularities = {
						democratic = 14
						neutrality = 52
						fascism = 34
						communism = 10
					}
					else_if = {
						limit = {
							NOT = { has_government = communism }
						}
						set_politics = {
							ruling_party = fascism
							elections_allowed = no
						}
						set_popularities = {
							democratic = 30
							neutrality = 32
							fascism = 38
							communism = 10
						}
					}
				}
			}
			if = {
				limit = {
					original_tag = POL
					FROM = {
						OR = {
							tag = SOV
							has_cosmetic_tag = SOV
						}
					}
					has_government = communism
				}
				set_cosmetic_tag = POL_SOVIET
				every_possible_country = {
					limit = {
						has_character = SOV_felix_dzerzhinsky
					}	
					SOV_felix_dzerzhinsky = {
						set_nationality = POL
						set_character_name = POL_felix_dzerzhinsky
						promote_character = vanguardism
					}			
				}
				set_party_name = {
					ideology = communism
					name = POL_polrewkom_party
					long_name = POL_polrewkom_party_long
				}
			}
			if = {
				limit = {
					original_tag = UKR
					FROM = {
						OR = {
							tag = SOV
							has_cosmetic_tag = SOV
						}
					}
					has_government = communism
					NOT = {
						tag = RUC
						tag = DKR
						has_cosmetic_tag = UKR_SOV_provisional
					}	
				}
				UKR = {
					UKR_yuriy_pyatakov = { 
						set_nationality = PREV.PREV 
						promote_character = yes
					}
				}
				SOV = {
					SOV_christian_rakovsky = { 
						set_nationality = PREV.PREV 
						promote_character = yes
					}
				}
				set_party_name = {
					ideology = communism
					name = UKR_communist_party
					long_name = UKR_communist_party_long
				}
				set_cosmetic_tag = UKR_SOV
			}
			if = {
				limit = {
					original_tag = ARM
					FROM = {
						OR = {
							tag = SOV
							has_cosmetic_tag = SOV
						}
					}	
					has_government = communism
				}
				ARM_sarkis_kasyan = {
					promote_character = yes
				}
				set_party_name = {
					ideology = communism
					name = ARM_communist_party
					long_name = ARM_communist_party_long
				}
				set_cosmetic_tag = ARM_SOV
			}
			if = {
				limit = {
					OR = {
						original_tag = SLV
						original_tag = CRO
						original_tag = TRA
						original_tag = BOS
						original_tag = GAL
						original_tag = MOL
						original_tag = MNT
						original_tag = WUK
					}
					FROM = { tag = HUN }
					has_government = communism
				}
				set_cosmetic_tag = HUN_socialism_puppet
			}
			if = {
				limit = {
					OR = {
						original_tag = SLV
						is_constituent_of_germany = yes
					}
					OR = {
						is_subject_of = GER
						is_subject_of = BAY
					}
					has_government = communism
				}
				set_cosmetic_tag = GER_socialism
			}
			#Crete
			if = {
				limit = {
					original_tag = CRE
					FROM = { tag = TUR }
				}
				set_cosmetic_tag = CRE_TUR
			}
			if = {
				limit = {
					original_tag = CRI
					FROM = {
						tag = GER
						is_GER_a_monarchy = yes
					}
				}
				set_cosmetic_tag = CRI_GER
				set_politics = {
					ruling_party = neutrality
					elections_allowed = no
				}
				set_popularities = {
					democratic = 21
					neutrality = 39
					fascism = 10
					communism = 30
				}
				set_party_name = {
					ideology = neutrality
					long_name = CRI_regional_government
					name = CRI_regional_government
				}
				RUS = {
					RUS_matvei_sulkevich = {
						set_character_name = CRI_maciej_sulkiewicz
						set_nationality = CRI
					}
				}
				if = {
					limit = {
						has_character = RUS_matvei_sulkevich
					}
					RUS_matvei_sulkevich = {
						add_country_leader_role = {
							country_leader = {
								ideology = authoritarian_democracy
							}
						}
						promote_character = authoritarian_democracy
					}
				}
			}
			if = {
				limit = {
					original_tag = ALS
					is_subject_of = GER
					has_government = neutrality
				}
				set_cosmetic_tag = ALS_GER
			}
			if = {
				limit = {
					original_tag = ANC
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = ANC_QIN
				}
			}
			if = {
				limit = {
					original_tag = FNG
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = FNG_QIN
				}
			}
			if = {
				limit = {
					original_tag = GDC
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = GDC_QIN
				}
			}
			if = {
				limit = {
					original_tag = GXC
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = GXC_QIN
				}
			}
			if = {
				limit = {
					original_tag = GZC
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = GZC_QIN
				}
			}
			if = {
				limit = {
					original_tag = JNC
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
						NOT = {
							has_cosmetic_tag = NPA_clique
							has_cosmetic_tag = LEP
						}
					}
					set_cosmetic_tag = JNC_QIN
				}
			}
			if = {
				limit = {
					original_tag = JXC
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = JXC_QIN
				}
			}
			if = {
				limit = {
					original_tag = SCC
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = SCC_QIN
				}
			}
			if = {
				limit = {
					original_tag = SDC
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = SDC_QIN
				}
			}
			if = {
				limit = {
					original_tag = SHN
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = SHN_QIN
				}
			}
			if = {
				limit = {
					original_tag = YUN
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = YUN_QIN
				}
			}
			if = {
				limit = {
					original_tag = ZHE
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = ZHE_QIN
				}
			}
			if = {
				limit = {
					original_tag = XSM
				}
				if = {
					limit = {
						FROM = {
							is_qing_monarchy = yes
						}
					}
					set_cosmetic_tag = XSM_QIN
				}
			}
			if = {
				limit = {
					original_tag = GXC
				}
				if = {
					limit = {
						FROM = {
							is_kuomintang_state = yes
						}
					}
					set_cosmetic_tag = GXC_KMT
				}
			}
			if = {
				limit = {
					original_tag = YUN
				}
				if = {
					limit = {
						FROM = {
							is_kuomintang_state = yes
						}
					}
					set_cosmetic_tag = YUN_KMT
				}
			}
			if = {
				limit = {
					original_tag = XSM
				}
				if = {
					limit = {
						FROM = {
							is_kuomintang_state = yes
						}
					}
					set_cosmetic_tag = XSM_KMT
				}
			}
			if = {
				limit = {
					original_tag = FNG
				}
				if = {
					limit = {
						FROM = {
							is_kuomintang_state = yes
						}
					}
					set_cosmetic_tag = FNG_KMT
				}
			}
			if = {
				limit = {
					original_tag = SIK
				}
				if = {
					limit = {
						FROM = {
							is_kuomintang_state = yes
						}
					}
					set_cosmetic_tag = SIK_KMT
				}
			}
			if = {
				limit = {
					original_tag = SCC
				}
				if = {
					limit = {
						FROM = {
							is_kuomintang_state = yes
						}
					}
					set_cosmetic_tag = SCC_KMT
				}
			}
			if = {
				limit = {
					original_tag = SRL
					FROM = {
						tag = ENG
					}
				}
				set_cosmetic_tag = SRL_ENG
			}
			if = {
				limit = {
					original_tag = LBA
					FROM = {
						tag = TUR
					}
				}
				set_cosmetic_tag = LBA_TUR
			}
			if = {
				limit = {
					original_tag = HJZ
					is_subject_of = TUR
					NOT = {
						has_cosmetic_tag = HJZ_sharifate
						has_cosmetic_tag = HJZ_arabia
					}
				}
				set_cosmetic_tag = HJZ_sharifate
			}
			if = {
				limit = {
					tag = SPR
					FROM = {
						is_subject = no
						OR = {
							has_country_leader = {
								character = FRA_jacques_i
								ruling_only = yes
							}
							has_country_leader = {
								character = FRA_charles_xii
								ruling_only = yes
							}
							has_idea = FRA_jacques_i
						}
						has_monarchy = yes
					}
				}
				set_country_flag = monarchist_puppet
				FROM = {
					set_autonomy = {
						target = ROOT
						autonomy_state = autonomy_tgwr_personal_union
					}
				}
				set_politics = {
					ruling_party = neutrality
					long_name = SPR_neutrality_party
					name = SPR_neutrality_party
				}
				set_cosmetic_tag = SPR_carlist_spain
				set_popularities = {
					democratic = 43
					neutrality = 39
					fascism = 10
					communism = 8
				}
				if = {
					limit = {
						NOT = { has_character = SPR_alfonso_carlos_i }
					}
					every_possible_country = {
						limit = { has_character = SPR_alfonso_carlos_i }
						SPR_alfonso_carlos_i = {
							set_nationality = PREV.PREV
						}
					}
				}
				if = {
					limit = {
						NOT = { has_character = SPR_jaime_iii }
					}
					every_possible_country = {
						limit = { has_character = SPR_jaime_iii }
						SPR_jaime_iii = {
							set_nationality = PREV.PREV
						}
					}
				}
				SPR_alfonso_carlos_i = {
					if = {
						limit = { has_ideology = semi_constitutional_monarchy }
						promote_character = semi_constitutional_monarchy
					}
					else = {
						add_country_leader_role = {
							promote_leader = yes
							country_leader = {
								ideology = semi_constitutional_monarchy
							}
						}
					}
				}
				if = {
					limit = {
						FROM = {
							OR = {
								has_country_leader = {
									character = FRA_jacques_i
									ruling_only = yes
								}
								has_idea = FRA_jacques_i
							}
						}
					}
					SPR_jaime_iii = {
						if = {
							limit = { has_ideology = semi_constitutional_monarchy }
							promote_character = semi_constitutional_monarchy
						}
						else = {
							add_country_leader_role = {
								promote_leader = yes
								country_leader = {
									ideology = semi_constitutional_monarchy
								}
							}
						}
					}
				}
			}
			# League of Nations
			if = {
				limit = {
					is_league_of_nations_member = yes
					OVERLORD = {
						is_league_of_nations_member = no
					}
				}
				leave_the_league_of_nations = yes
			}
			if = {
				limit = {
					is_league_of_nations_member = no
					OVERLORD = {
						is_league_of_nations_member = yes
					}
					# Puppets won't join
					NOT = {
						has_autonomy_state = autonomy_tgwr_protectorate
						has_autonomy_state = autonomy_tgwr_informal_protectorate
						has_autonomy_state = autonomy_tgwr_integrated_protectorate
						has_autonomy_state = autonomy_tgwr_concession
						has_autonomy_state = autonomy_integrated_puppet
						has_autonomy_state = autonomy_puppet
						has_autonomy_state = autonomy_wtt_imperial_subject
						has_autonomy_state = autonomy_wtt_imperial_protectorate
						has_autonomy_state = autonomy_colony
						has_autonomy_state = autonomy_tgwr_ottoman_emirate #they have no diplomatic rights
						has_autonomy_state = autonomy_tgwr_unilateral_union #they don't want to be a independent nation
					}
				}
				join_the_league_of_nations = yes
			}
			log = "[GetDateText]: [ROOT.GetName] has been released as puppet by [FROM.GetName]"
		}
	}
	on_startup = {
		effect = {
			every_possible_country = {
				#Unit Limits Setup
				update_mobilisation_bonus = yes
				country_event = ww1_political.4			
			}
			#setting up basic famine state for everyone
			AUS = {
				set_variable = {
					var = famine_manpower
					value = -500
				}
				set_variable = {
					var = famine_manpower_growth
					value = -0.75
				}
				set_variable = {
					var = famine_stability
					value = -0.0003
				}
				set_variable = {
					var = famine_war_support
					value = -0.0015
				}
				set_variable = {
					var = famine_army_org
					value = -0.25
				}
				set_variable = {
					var = famine_consumption_factor
					value = 0.25
				}
			}
			IND = {
				every_owned_state = {
					limit = {
						NOT = {
							is_core_of = IND
						}
					}
					add_resistance = 50
					add_compliance = -50
				}
			}
			#Effect to create 'territories' in Utah
			376 = {
				remove_core_of = MEX
				start_resistance = no
			}
			377 = {
				remove_core_of = MEX
				start_resistance = no
			}
			#The Empty Quarter
			678 = {
				remove_core_of = SAU
				start_resistance = no
			}
			#Kalmykia
			256 = {
				remove_core_of = RUS
				start_resistance = no
			}	
			#Kuwait zone of influence
			#905 = {
			#	remove_core_of = KUW
			#	start_resistance = no
			#}
			#904 = {
			#	remove_core_of = KUW
			#	start_resistance = no
			#}
			#Labrador
			1053 = {
				remove_core_of = CAN
				start_resistance = no
			}
			#Liberia
			862 = {
				remove_core_of = LIB
				start_resistance = yes
			}
			#Baja Mexico-Territory
			484 = {
				remove_core_of = MEX
				start_resistance = no
			}
			#Yucatan-Caste War & Mayan Revolt
			474 = {
				remove_core_of = MEX
				start_resistance = yes
			}
			#Canadian Lands of First Nations & Territories
			1052 = {
				remove_core_of = CAN
				start_resistance = no
			}
			1056 = {
				remove_core_of = CAN
				start_resistance = no
			}
			683 = {
				remove_core_of = CAN
				start_resistance = no
			}
			472 = {
				remove_core_of = CAN
				start_resistance = no
			}
			1054 = {
				remove_core_of = CAN
				start_resistance = no
			}
			1055 = {
				remove_core_of = CAN
				start_resistance = no
			}
			471 = {
				remove_core_of = CAN
				start_resistance = no
			}
			#Unexplored & Contested Amazon Lands
			1087 = {
				remove_core_of = COL
				start_resistance = no
			}
			1086 = {
				remove_core_of = COL
				start_resistance = no
			}
			1084 = {
				remove_core_of = PRU
				start_resistance = no
			}
			1085 = {
				remove_core_of = PRU
				start_resistance = no
			}
			1083 = {
				remove_core_of = PRU
				start_resistance = no
			}
			###
			every_state = {
				limit = {
					is_owned_by = RUS
					NOT = { region = 116 }
				}
				set_state_flag = imperial_russian_state
			}
			every_state = {
				limit = {
					is_core_of = QIN
				}
				set_state_flag = chinese_core_state
			}
			if = {
				limit = {
					has_start_date < 1914.1.1
				}
				115 = {
					damage_building = {
						type = infrastructure
						damage = 1
					}
					damage_building = {
						type = naval_base
						damage = 1
						province = 4159
					}
					damage_building = {
						type = dockyard
						damage = 1
					}
				}
				#North Dobrudja
				805 = {
					remove_core_of = ROM
					start_resistance = yes
					add_compliance = 70
					set_garrison_strength = 1
					OWNER = {
						ROM = { set_occupation_law_where_available = foreign_civilian_oversight } 
					}
				}
			}
			else = {
				ITA = {
					every_owned_state = {
						limit = {
							is_core_of = LBA
							impassable = no
							NOT = {
								state = 448
								state = 450
							}
						}
						add_resistance = 50
						add_compliance = -50
						add_dynamic_modifier = {
							modifier = LBA_tribal_resistance
						}
					}
				}
				FRA = {
					annex_country = {
						target = CHA
					}
					annex_country = {
						target = KUT
					}
					annex_country = {
						target = FUJ
					}
				}
				GRE = {
					annex_country = {
						target = CRE
					}
					annex_country = {
						target = SMS
					}
				}
				INS = {
					annex_country = {
						target = RIA
					}
				}
				JAP = {
					annex_country = {
						target = KOR
					}
				}
				SAF = {
					annex_country = {
						target = CAP
					}
					annex_country = {
						target = ORA
					}
					annex_country = {
						target = NAT
					}
				}
				USA = {
					annex_country = {
						target = NIC
					}
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = AUH_ai_behavior
						option = RANDOM
					}
				}
				random_list = {
					40 = { AUS = { set_country_flag = AUH_AI_HISTORICAL } }
					20 = { AUS = { set_country_flag = HUNGARIAN_REVOLUTION } }
					10 = { AUS = { set_country_flag = RULE_OPTION_AUH_TRIALISM } }
					20 = { AUS = { set_country_flag = RULE_OPTION_AUH_CONRAD } }
				}
			}
			# if = {
			# 	limit = {
			# 		has_game_rule = {
			# 			rule = FIRST_BALKAN_WAR_OUTCOME
			# 			option = TUR_TURKISH_VICTORY
			# 		}
			# 	}
			# 	set_global_flag = TUR_must_won_bw1
			# }
			if = {
				limit = {
					has_game_rule = {
						rule = SWE_ai_behavior
						option = RANDOM
					}
				}
				random_list = {
					30 = { SWE = { set_country_flag = SWE_AI_RANDOM_HISTORICAL } }
					20 = { SWE = { set_country_flag = SWE_AI_ENTENTE } }
					25 = { SWE = { set_country_flag = SWE_AI_CENTRAL_POWERS } }
					20 = { RUS = { set_country_flag = SWE_AI_MONARCHIST } }
					10 = { SWE = { set_country_flag = SWE_AI_FASCIST } }
					5 = { SWE = { set_country_flag = SWE_AI_SYNDICALIST } }
				}
			}
			BEL = {
				if = {
					limit = {
						has_game_rule = {
							rule = BEL_ai_behavior
							option = RANDOM
						}
					}
					random_list = {
						40 = { BEL = { set_country_flag = BEL_AI_DEMOCRATIC_HISTORICAL } }
						20 = { BEL = { set_country_flag = BEL_AI_DEMOCRATIC_LIBERAL } }
					}
				}
			}
			BRA = {
				if = {
					limit = {
						has_game_rule = {
							rule = BRA_ai_behavior
							option = RANDOM
						}
					}
					random_list = {
						30 = { BRA = { set_country_flag = BRA_AI_RANDOM_DEMOCRATIC_HISTORICAL } }
						17 = { BRA = { set_country_flag = BRA_AI_RANDOM_DEMOCRATIC_ALTERNATE } }
						33 = { BRA = { set_country_flag = BRA_AI_RANDOM_JUNTA } }
						33 = { BRA = { set_country_flag = BRA_AI_RANDOM_NEUTRALITY_MONARCHIST } }
					}
				}
			}
			ENG = {
				if = {
					limit = {
						has_game_rule = {
							rule = ENG_ai_behavior
							option = RANDOM
						}
					}
					random_list = {
						40 = { ENG = { set_country_flag = ENG_AI_DEMOCRATIC_HISTORICAL } }
						20 = { ENG = { set_country_flag = ENG_AI_RANDOM_COMMUNIST } }
						30 = { ENG = { set_country_flag = ENG_AI_RANDOM_NEUTRALITY } }
						20 = { ENG = { set_country_flag = ENG_AI_RANDOM_FASCIST } }
						15 = {
							random_list = {
								50 = { set_country_flag = ENG_AI_RANDOM_EDWARD }
								30 = { set_country_flag = ENG_AI_RANDOM_VICTORIA }
								15 = { set_country_flag = ENG_AI_RANDOM_AUWI }
							}
						}		
					}
				}
			}
			BUL = {
				if = {
					limit = {
						has_game_rule = {
							rule = BUL_ai_behavior
							option = RANDOM
						}
					}
					random_list = {
						40 = { BUL = { set_country_flag = BUL_AI_RANDOM_HISTORICAL } }
						20 = { BUL = { set_country_flag = BUL_AI_RANDOM_BORIS_III } }
						30 = { BUL = { set_country_flag = BUL_AI_RANDOM_LIBERALIST } }
						35 = {
							random_list = {
								50 = { set_country_flag = BUL_AI_RANDOM_AGRARIANIST }
								30 = { set_country_flag = BUL_AI_RANDOM_SOCILAIST }
								30 = { set_country_flag = BUL_AI_RANDOM_FASCIST }
							}
						}
					}
				}
			}
			GER = {
				if = {
					limit = {
						has_game_rule = {
							rule = GER_ai_behavior
							option = RANDOM
						}
					}
					random_list = {
						40 = { GER = { set_country_flag = GER_AI_RANDOM_HISTORICAL } }
						# 30 = { GER = { set_country_flag = GER_AI_RANDOM_DEMOCRATIC } }
						# 30 = { GER = { set_country_flag = GER_AI_RANDOM_BACKSTAB } }
						40 = { GER = { } }
					}
				}
				
				activate_mission = GER_election1
			}
			HOL = {
				if = {
					limit = {
						has_game_rule = {
							rule = HOL_ai_behavior
							option = RANDOM
						}
					}
					random_list = {
						40 = { HOL = { set_country_flag = HOL_AI_RANDOM_HISTORICAL } }
						20 = { HOL = { set_country_flag = HOL_AI_RANDOM_DEMOCRATIC_ALTERNATE } }
						25 = { HOL = { set_country_flag = HOL_AI_RANDOM_SYNDICALIST } }
						35 = { HOL = { set_country_flag = HOL_AI_RANDOM_NEUTRALITY } }
					}
				}
			}
			TUR = {
				if = {
					limit = {
						has_game_rule = {
							rule = TUR_ai_behavior
							option = RANDOM
						}
					}
					random_list = {
						15 = { TUR = { set_country_flag = HISTORICAL_TRIUMVIRATE } }
					}
				}
			}
			RUS = {
				if = {
					limit = {
						has_game_rule = {
							rule = RUS_ai_behavior
							option = RANDOM
						}
					}
					random_list = {
						30 = { RUS = { set_country_flag = RUS_AI_RANDOM_HISTORICAL } }
						13 = { RUS = { set_country_flag = RUS_AI_RANDOM_KAISER } }
						20 = { RUS = { set_country_flag = RUS_AI_RANDOM_TSAR } }
						15 = { RUS = { set_country_flag = RUS_AI_RANDOM_CONSTITUTIONALIST } }
						7 = { RUS = { set_country_flag = RUS_AI_RANDOM_CONSTITUTIONALIST_RADICAL } }
						15 = { RUS = { set_country_flag = RUS_AI_RANDOM_DEMOCRATIC_REPUBLIC } }
					}
				}
				if = {
					limit = {
						has_game_rule = {
							rule = russian_revolution_path
							option = RANDOM
						}
					}
					random_list = {
						30 = { RUS = { set_country_flag = RUS_REV_AI_RANDOM_HISTORICAL } }
						30 = { RUS = { set_country_flag = RUS_REV_AI_RANDOM_TSAR_MIKHAIL_CROWNED } }
						25 = { RUS = { set_country_flag = RUS_REV_AI_RANDOM_KORNILOV_IN_POWER } }
						15 = { RUS = { set_country_flag = RUS_REV_AI_RANDOM_KERENSKY_DICTATORSHIP } }
					}
				}
				if = {
					limit = {
						has_game_rule = {
							rule = SOV_ai_behavior
							option = RANDOM 
						}
					}
					random_list = {
						50 = { RUS = { set_country_flag = SOV_AI_RANDOM_HISTORICAL } }
						40 = { RUS = { set_country_flag = SOV_AI_RANDOM_REVISIONIST } }
						20 = { RUS = { set_country_flag = SOV_AI_RANDOM_MENSHEVIK } }
						10 = { RUS = { set_country_flag = SOV_AI_RANDOM_THIRD_FORCE } }
					}
				}
				if = {
					limit = {
						has_game_rule = {
							rule = rule_russian_flag
							option = AHISTORICAL_RUSSIAN_FLAG
						}
					}
					RUS = {
						set_cosmetic_tag = RUS_ahistorical_flag
					}
				}
				else_if = {
					limit = {
						has_game_rule = {
							rule = rule_russian_flag
							option = IMPERIAL_RUSSIAN_FLAG
						}
					}
					RUS = {
						set_cosmetic_tag = RUS_absolutism
					}
				}
			}
			FRA = {
				if = {
					limit = {
						has_game_rule = {
							rule = FRA_ai_behavior
							option = RANDOM
						}
					}
					random_list = {
						25 = { FRA = { set_country_flag = FRA_AI_RANDOM_HISTORICAL } }
						10 = { FRA = { set_country_flag = FRA_AI_RANDOM_SOCIALIST } }
						10 = { FRA = { set_country_flag = FRA_AI_RANDOM_SOCIALIST_REVOLUTIONNARY } }
						10 = { FRA = { set_country_flag = FRA_AI_RANDOM_DEMOCRATIC_RIGHT } }
						10 = { FRA = { set_country_flag = FRA_AI_RANDOM_DEMOCRATIC_RIGHT_NAPOLEON } }
						5 = { FRA = { set_country_flag = FRA_AI_RANDOM_DEMOCRATIC_ALTERNATE } }
						# 10 = { FRA = { set_country_flag = FRA_AI_RANDOM_NEUTRALITY_BONARPARTIST } }
						# 10 = { FRA = { set_country_flag = FRA_AI_RANDOM_NEUTRALITY_MONARCHIST } }
						# 15 = { FRA = { set_country_flag = FRA_AI_RANDOM_FASCIST } }
					}
				}
			}
			IND = {
				if = {
					limit = {
						has_game_rule = {
							rule = FRA_ai_behavior
							option = RANDOM
						}
					}
					random_list = {
						50 = { IND = { set_country_flag = IND_AI_RANDOM_COOPERATIVE_EMPIRE } }
						50 = { IND = { set_country_flag = IND_AI_RANDOM_HISTORICAL } }
					}
				}
			}
			MOR = {
				if = {
					limit = {
						has_game_rule = {
							rule = MOR_ai_behavior
							option = RANDOM
						}
					}
					random_list = {
						50 = { MOR = { set_country_flag = MOR_AI_RANDOM_SUCCESSFUL_ARMY_REFORM } }
						50 = { MOR = { set_country_flag = MOR_AI_SUCCESSFUL_ARMY_REFORM_PASSIVE } }
						50 = { MOR = { set_country_flag = MOR_AI_RANDOM_HISTORICAL } }
					}
				}
			}
			CAN = {
				if = {
					limit = {
						has_game_rule = {
							rule = CAN_ai_behavior
							option = RANDOM
						}
					}
					random_list = {
						40 =  {CAN = { set_country_flag = CAN_AI_RANDOM_DEMOCRATIC_HISTORICAL } }
						30 = { CAN = { set_country_flag = CAN_AI_RANDOM_BRITISH_COMPROMISE } }
						20 = { CAN = { set_country_flag = CAN_AI_RANDOM_REPUBLICAN } }
						10 = { CAN = { set_country_flag = CAN_AI_RANDOM_MONARCHIST } }
					}
				}
			}
			ITA = {
				if = {
					limit = {
						has_game_rule = {
							rule = ITA_ai_behavior
							option = RANDOM
						}
					}
					random_list = {
						60 = { ITA = { set_country_flag = ITA_AI_RANDOM_HISTORICAL } }
						40 = { ITA = { set_country_flag = ITA_AI_RANDOM_CP } }
					}
				}
			}
			SWE = {
				if = {
					limit = {
						has_game_rule = {
							rule = SWE_ai_behavior
							option = RANDOM
						}
					}
					random_list = {
						30 = { SWE = { set_country_flag = SWE_AI_RANDOM_HISTORICAL } }
						20 = { SWE = { set_country_flag = SWE_AI_ENTENTE } }
						25 = { SWE = { set_country_flag = SWE_AI_CENTRAL_POWERS } }
						20 = { RUS = { set_country_flag = SWE_AI_MONARCHIST } }
						10 = { SWE = { set_country_flag = SWE_AI_FASCIST } }
						5 = { SWE = { set_country_flag = SWE_AI_SYNDICALIST } }
					}
				}
			}
			CHI = {
				if = {
					limit = {
						has_game_rule = {
							rule = CHI_ai_behavior
							option = RANDOM
						}
					}
					random_list = {
						60 = { CAN = { set_country_flag = CHI_AI_HISTORICAL } }
						40 = { CAN = { set_country_flag = CHI_AI_DEMOCRATIC } }
					}
				}
			}
			GRE = {
				if = {
					limit = {
						has_game_rule = {
							rule = GRE_ai_behavior
							option = RANDOM
						}
					}
					random_list = {
						40 = { GRE = { set_country_flag = GRE_AI_RANDOM_HISTORICAL } }
						15 = { GRE = { set_country_flag = GRE_AI_RANDOM_NEUTRALITY_MONARCHIST } }
						5 = { GRE = { set_country_flag = GRE_AI_RANDOM_CENTRAL_POWERS } }
						10 = { GRE = { set_country_flag = GRE_AI_RANDOM_METAXAS } }
						20 = { GRE = { set_country_flag = GRE_AI_RANDOM_SOCIALIST } }
					}
				}
			}
			if = {
				limit = {
					has_start_date > 1914.1.1
				}
				88 = {
					add_resource = {
						type = steel
						amount = 4
					}
				}
				276 = {
					add_resource = {
						type = tungsten
						amount = 5
					}
					add_resource = {
						type = oil
						amount = 8
					}
				}
				280 = {
					add_resource = {
						type = rubber
						amount = 15
					}
				}
				334 = {
					add_resource = {
						type = rubber
						amount = 8
					}
				}
				335 = {
					add_resource = {
						type = rubber
						amount = 34
					}
				}
				466 = {
					add_resource = {
						type = steel
						amount = 17
					}
				}
				466 = {
					add_resource = {
						type = tungsten
						amount = 4
					}
				}
				470 = {
					add_resource = {
						type = oil
						amount = 5
					}
					add_resource = {
						type = oil
						amount = 26
					}
				}
				471 = {
					add_resource = {
						type = tungsten
						amount = 24
					}
					add_resource = {
						type = oil
						amount = 20
					}
				}
				473 = {
					add_resource = {
						type = chromium
						amount = 12
					}
				}
				562 = {
					add_resource = {
						type = steel
						amount = 4
					}
				}
				672 = {
					add_resource = {
						type = rubber
						amount = 30
					}
				}
				682 = {
					add_resource = {
						type = steel
						amount = 8
					}
				}
				1056 = {
					add_resource = {
						type = steel
						amount = 11
					}
				}
				740 = {
					add_resource = {
						type = chromium
						amount = 8
					}
				}
				811 = {
					add_resource = {
						type = steel
						amount = 10
					}
				}
				291 = {
					add_resource = {
						type = oil
						amount = 6
					}
				}
				413 = {
					add_resource = {
						type = oil
						amount = 4
					}
				}
				TUR = {
					add_days_mission_timeout = {
						mission = ITA_return_ottoman_islands_mission
						days = -210
					}
				}
				ITA = {
					add_days_mission_timeout = {
						mission = ITA_return_ottoman_islands_mission
						days = -210
					}
				}
			}
			every_country = {
				limit = {
					is_in_faction = yes
					has_war = no					
					OR = {
						has_autonomy_state = autonomy_tgwr_protectorate
						has_autonomy_state = autonomy_tgwr_informal_protectorate
						has_autonomy_state = autonomy_tgwr_ottoman_emirate
						has_autonomy_state = autonomy_tgwr_concession
					}
				}
				leave_faction = yes			
				OVERLORD = {
					diplomatic_relation = {
						country = PREV
						relation = military_access
						active = yes
					}
				}
			}
		}
	}
	on_capitulation = {
		effect = {
			if = {
				limit = {
					GRE = {
						has_completed_focus = GRE_recapture_northern_epirus
						has_country_flag = GRE_ITA_arrangement_about_albania_flag
						GRE_eleftherios_venizelos = {
							is_country_leader = yes
						}
					}
					original_tag = ALB
					has_war_with = GRE
					has_war_with = ITA
				}
				GRE = {
					white_peace = {
						tag = ALB
					}
					transfer_state = 803
				}
                ITA = {
					white_peace = {
						tag = ALB
					}
					puppet = {
						target = ALB
						end_wars = yes
					}
				}
				ALB = {
					transfer_state = 871
				}
			}
			if = {
				limit = {
					has_global_flag = great_war
					original_tag = BEL
					has_war_with = GER
					is_in_faction_with = FRA
					is_ai = yes
				}
				every_state = {
					teleport_armies = {
						limit = { 
							tag = BEL
						}
						to_state = 16
					}
				}
				add_equipment_to_stockpile = {
					type = convoy
					amount = 20
				}
			}
			if = {
				limit = {
					GRE = {
						has_completed_focus = GRE_recapture_northern_epirus
					}
					original_tag = ALB
					has_war_with = GRE
				}
				GRE = {
					white_peace = {
						tag = ALB
					}
					transfer_state = 803
				}
			}
			if = {
				limit = {
					tag = USR
					has_war_with = UPR
					NOT = {
						has_country_flag = brest_litovsk_capture
					}
				}
				if = {
					limit = { 
						has_character = SOV_vladimir_ovseenko
					}
					SOV_vladimir_ovseenko = {
						set_nationality = SOV
					}
				}
				UPR = {
					set_country_flag = brest_litovsk_capture
					annex_country= {
						target = UPR
					}
				}
			}
			if = {
				limit = {
					tag = LAT
					has_war_with = UBD
				}
				become_exiled_in = {
					target = EST
					legitimacy = 30
				}
			}
			if = {
				limit = {
					has_country_flag = UKR_rumcherod
					UKR = {
						exists = yes
						NOT = {
							tag = RUC
							has_country_flag = UKR_rumcherod
						}
					}
				}
				ROOT = {
					every_owned_state = {
						remove_core_of = PREV
						set_state_owner_to = UKR
					}
					reserve_dynamic_country = no
				}
			}
			if = {
				limit = {
					tag = KUB
					any_enemy_country = {
						tag = SOV
					}
					SOV = {
						is_subject = no
						has_government = communism
					}
					NOT = {
						has_country_flag = communist_takeover
					}
				}
				SOV = {
					puppet = KUB
				}
				KUB = {
					set_politics = {
						ruling_party = communism
						elections_allowed = no
					}
					add_popularity = {
						ideology = communism
						popularity = 0.25
					}
					set_country_flag = KUB_soviet_tag
					country_lock_all_division_template = yes
					add_ideas = SOV_idea_red_guard
					remove_ideas = {
						standing_alone
					}
					set_country_flag = communist_takeover
					division_template = {
						name = "Krasnaya Gvardiya"
						regiments = {
							militia = { x = 0 y = 0 }
							militia = { x = 0 y = 1 }
							militia = { x = 1 y = 0 }
						}
					}
					every_owned_state = {
						KUB = {
							set_state_controller = PREV
						}	
					}
					234 = {
						create_unit = {
							division = "division_template = \"Krasnaya Gvardiya\" start_experience_factor = 0.2" 
							owner = KUB
							allow_spawning_on_enemy_provs = yes
							count = 4
						}
					}
				}
			}
			if = {
				limit = {
					tag = DON
					has_war_with = SOV					
				}		
				if = {
					limit = {
						NOT = {
							country_exists = SRA
							has_global_flag = RUS_SRA_spawned
						}
					}
					DON = {
						country_event = ww1_sra.9
					}
				}
				if = {
					limit = {
						SOV = {
							is_subject = no
							has_government = communism
						}
						NOT = {
							has_country_flag = communist_takeover
						}
					}
					SOV = {
						puppet = DON
					}
					DON = {
						add_popularity = {
							ideology = communism
							popularity = 0.25
						}
						retire_character = RUS_alexei_kaledin
						retire_character = DON_anatoliy_nazarov
						set_country_flag = DON_soviet_tag
						country_lock_all_division_template = yes
						set_country_flag = communist_takeover
						add_ideas = SOV_idea_red_guard
						remove_ideas = {
							standing_alone
						}			
						division_template = {
							name = "Krasnaya Gvardiya"
							regiments = {
								militia = { x = 0 y = 0 }
								militia = { x = 0 y = 1 }
								militia = { x = 1 y = 0 }
							}
						}
						every_owned_state = {
							DON = {
								set_state_controller = PREV
							}	
						}
						capital_scope = {
							create_unit = {
								division = "division_template = \"Krasnaya Gvardiya\" start_experience_factor = 0.2" 
								owner = DON
								allow_spawning_on_enemy_provs = yes
								count = 5
							}
						}
					}
				}
				# SOV = {
				# 	if = {
				# 		limit = {
				# 			NOT = {
				# 				has_idea = SOV_war_in_the_caucasus_1
				# 			}
				# 		}
				# 		add_ideas = SOV_war_in_the_caucasus_2
				# 	}
				# 	else = {
				# 		swap_ideas = {
				# 			remove_idea = SOV_war_in_the_caucasus_1
				# 			add_idea = SOV_war_in_the_caucasus_2
				# 		}
				# 	}
				# }
			}	
			if = {
				limit = { 
					is_russian_tag = yes
					has_war_with = SOV
					has_character = RUS_sergej_vojcechovsky			
				}
				if = {
					limit = {
						NOT = {
							original_tag = TBK
						}
						TBK = {
							has_capitulated = no
							has_war_with = SOV
							NOT = {
								has_government = communism
							}
						}
					}
					RUS_sergej_vojcechovsky = {
						set_nationality = TBK
					}
					else_if = {
						limit = {
							NOT = {
								tag = SRA
							}
							SRA = {
								has_capitulated = no
								has_war_with = SOV
								NOT = {
									has_government = communism
								}
							}				
						}
						RUS_sergej_vojcechovsky = {
							set_nationality = SRA
						}
						else = {
							RUS_sergej_vojcechovsky = {
								set_nationality = CZE
								set_character_name = CZE_sergej_vojcechovsky
							}
						}
					}
				}
			}
			if = {
				limit = {
					is_balkan_nation = yes
					has_war_with = GRE
					is_in_faction = no		
					is_subject = no	
					has_civil_war = no	
					FROM = {
						original_tag = GRE
						is_subject = no
						has_completed_focus = GRE_ligdopoulos_ascendant
						has_government = communism
					}
				}
				FROM = {
					white_peace = {
						tag = ROOT
					}
					set_autonomy = {
						target = ROOT
						autonomous_state = autonomy_tgwr_balkan_federal_subject
						freedom_level = 0.5
					}
				}
			}
			if = {
				limit = {
					original_tag = PAR
					any_enemy_country = {
						original_tag = BRA
					}
					BOL = {
						has_war = no
						exists = yes
						owns_state = 487
					}
					PAR = {
						owns_state = 688
					}
				}
				BOL = {
					transfer_state = 688
				}
			}
			if = {
				limit = {
					OR = {
						tag = USA
						tag = CSA
						tag = USB
					}
					FROM = {
						OR = {
							tag = ENG
							is_subject_of = ENG
							AND = {
								ENG = {
									is_faction_leader = yes
								}
								is_in_faction_with = ENG
							}
						}
					}
				}
				ENG = {
					news_event = {
						id = eng_news.24
						hours = 5
					}
				}
			}
			if = {
				limit = {
					original_tag = QIN
					any_enemy_country = {
						original_tag = CHI
					}
					NOT = {
						has_country_flag = tibet_released
					}
				}
				every_state = {
					limit = {
						is_core_of = TIB
						OR = {
							is_owned_by = QIN
							is_owned_by = CHI
						}
						region = 146
					}
					TIB = {
						transfer_state = PREV
					}
				}
				set_country_flag = tibet_released
				if = {
					limit = {
						TIB = {
							OR = {
								is_subject_of = QIN
								is_subject_of = CHI
							}
						}
					}
					end_puppet = TIB
				}
			}
			if = {
				limit = {
					tag = ITA
					has_war_with = AUS
					OR = {
						NOT = {
							has_global_flag = great_war
						}
						has_global_flag = interbellum
					}
				}
				ITA = {
					if = {
						limit = {
							has_global_flag = brothers_war
							is_faction_leader = yes
						}
						every_other_country = {
							limit = {
								has_war_with = AUS
							}
							set_country_flag = joined_brothers_war
						}
					}
					leave_faction = yes
					white_peace = AUS
				}
				AUS = {
					country_event = ww1_auh.29
				}
			}
			if = {
				limit = {
					tag = GER
					has_war_with = AUS
					OR = {
						NOT = {
							has_global_flag = great_war
						}
						has_global_flag = interbellum
					}
				}
				set_global_flag = brothers_war_ends
				GER = {
					if = {
						limit = {
							is_in_faction_with = ITA
							AUS = {
								has_war_with = ITA
							}
						}
						if = {
							limit = {
								ITA = {
									is_major = yes
								}
							}
							ITA = {
								set_faction_leader = yes
							}
							leave_faction = yes
							white_peace = AUS	
						}
					}
					else = {
						leave_faction = yes
						white_peace = AUS
						ITA = {
							leave_faction = yes
							white_peace = AUS
						}
						AUS = {
							country_event = ww1_auh.29
						}
					}
				}
				AUS = {
					country_event = ww1_auh.36
				}
			}
			if = {
				limit = {
					tag = AUS
					has_war_with = GER
					OR = {
						NOT = {
							has_global_flag = great_war
						}
						has_global_flag = interbellum
					}
				}
				every_country = {
					limit = {
						has_war_with = AUS
					}
					white_peace = AUS
					set_country_flag = joined_brothers_war
				}
				GER = {
					country_event = ww1_bruderkrieg.7
				}
			}
			if = {
				limit = {
					tag = PRG
				}
				if = {
					limit = {
						ENG = {
							has_war_with = PRG
							is_subject = no
							NOT = {
								has_country_flag = great_war_loser
							}
						}
					}
					every_state = {
						limit = {
							is_owned_by = PRG
							is_claimed_by = ENG
						}
						ENG = {
							transfer_state = PREV
						}
					}
				}
				if = {
					limit = {
						RUS = {
							has_war_with = PRG
							is_subject = no
							NOT = {
								has_country_flag = great_war_loser
								tag = SOV
								has_war_with = SOV
							}
						}
					}
					every_state = {
						limit = {
							is_owned_by = PRG
							is_claimed_by = RUS
						}
						RUS = {
							transfer_state = PREV
						}
					}
				}
			}
			if = {
				limit = {
					has_country_flag = TUR_kostantiniye_government_tag
					any_enemy_country = {
						has_country_flag = TUR_national_movement_tag
					}
				}
				OTT = {
					transfer_navy = {
						target = TRR
					}
					if = {
						limit = {
							TRR = { has_war_with = ENG }
						}
						become_exiled_in = {
							target = ENG
							legitimacy = 30
						}
					}
					else_if = {
						limit = {
							TRR = { has_war_with = RUS }
						}
						become_exiled_in = {
							target = RUS
							legitimacy = 30
						}
					}
					else_if = {
						limit = {
							TRR = { has_war_with = GRE }
						}
						become_exiled_in = {
							target = GRE
							legitimacy = 30
						}
					}
					else = {
						every_state = {
							remove_core_of = PREV
							remove_claim_by = PREV
						}
						TRR = {
							annex_country = {
								target = PREV
							}
						}
					}
				}
			}
			if = {
				limit = {
					original_tag = TUR
					has_country_flag = TUR_national_movement_tag
					any_enemy_country = {
						has_country_flag = TUR_kostantiniye_government_tag
					}
				}
				TRR = {
					transfer_navy = {
						target = OTT
					}
					every_state = {
						remove_core_of = PREV
						remove_claim_by = PREV
					}
					OTT = {
						annex_country = {
							target = PREV
						}
					}
				}
			}
			if = {
				limit = {
					original_tag = ENG
					has_country_flag = ENG_socialist_britain_flag
					FROM = {
						original_tag = CAN
						has_country_flag = has_british_monarchy
					}
				}
				FROM = {
					annex_country = {
						target = ROOT
					}
				}
			}
			if = {
				limit = {
					tag = RUS
					is_in_faction = yes
					is_faction_leader = no
					has_global_flag = great_war
					GER = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
					NOT = {
						#has_global_flag = great_war_ends
						has_global_flag = russ_kapitulation
						tag = SOV
					}
				}
				GER = {
					news_event = ww1_russia.98
				}
			}
			if = {
				limit = {
					tag = ENG
					is_in_faction = yes
					is_faction_leader = no
					is_great_war_ongoing = yes
					GER = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
						any_enemy_country = {
							has_war_with = PREV
							is_in_faction_with = ROOT
						}
					}
				}
				GER = { country_event = ww1_england.233 }
				if = {
					limit = {
						NOT = {
							has_global_flag = irish_war_of_independence
							country_exists = IRE
						}
					}
					country_event = orange.17
				}
			}
			if = {
				limit = {
					tag = JAP
					any_other_country = {
						original_tag = JAP
						has_war_with = PREV
						has_country_leader = {
							character = JAP_tokugawa_iesato
							ruling_only = yes
						}
					}
				}
				random_other_country = {
					limit = {
						original_tag = JAP
						has_war_with = PREV
						has_country_leader = {
							character = JAP_tokugawa_iesato
							ruling_only = yes
						}
					}
					every_state = {
						remove_core_of = ROOT
						remove_claim_by = ROOT
					}
					every_character = {
						set_nationality = PREV.PREV
					}
					transfer_units_fraction = {
						target = PREV
						size = 1.0
						target_organization = 1
						source_organization = 1
						keep_unit_leaders_trigger = {
							always = no
						}
					}
					transfer_navy = {
						target = PREV
					}
					PREV = {
						JAP_mutsuhito = {
							promote_character = reactionism
						}
						JAP_yoshihito = {
							promote_character = reactionism
						}
						JAP_hirohito = {
							promote_character = fascism_ideology
						}
						set_politics = {
							ruling_party = fascism
							elections_allowed = no
						}
						set_popularities = {
							fascism = 57
							neutrality = 33
							democratic = 10
						}
						annex_country = {
							target = PREV
							transfer_troops = yes
						}
						change_tag_from = PREV
					}
				}
			}
			if = {
				limit = {
					tag = CHA
					is_in_faction = no
					is_subject = no
					has_war_with = FRA
					NOT = { has_global_flag = wadai_war_end }
					FRA = {
						OR = {
							owns_state = 969
							owns_state = 1059
						}
					}	
				}
				if = {
					limit = {
						has_war_with = CHF
					}
					CHF = {
						annex_country = {
							target = CHA
							transfer_troops = yes
						}
					}
					else = {
						FRA = {
							annex_country = {
								target = CHA
							}
						}
					}
				}
			}
			if = {
				limit = {
					tag = KUT
					is_in_faction = no
					is_subject = no
					660 = {
						OWNER = {
							has_war_with = KUT
						}
					}
				}
				660 = {
					OWNER = {
						annex_country = {
							target = KUT
						}
					}					
				}
			}
			if = {
				limit = {
					tag = RMO
					is_subject = no
					has_war_with = FRA
					MOR = {
						is_subject_of = FRA
					}
				}
				MOR = {
					annex_country = {
						target = RMO
						transfer_troops = no
					}
				}
			}
			# empire of china victorious
			if = {
				limit = {
					tag = YUN
					FROM = { tag = CHI }
					has_country_flag = CHI_national_protection_flag
					has_global_flag = national_protection_war
					NOT = {
						has_global_flag = hongxian_failed
					}
				}
				if = {
					limit = {
						has_global_flag = hongxian_failed
					}
					every_core_state = {
						limit = {
							NOT = { state = 325 }
						}
						remove_core_of = PREV
					}
				}
				else_if = {
					limit = {
						has_cosmetic_tag = CHI_hongxian_empire
					}
					set_global_flag = CHI_empire_won_npw
					country_event = ww1_china.155
				}
				else = {
					set_global_flag = hongxian_failed
					country_event = ww1_china.38
					unlock_national_focus = CHI_beiyang_meditator
				}
			}
			# national protection army victorious
			if = {
				limit = {
					tag = CHI
					FROM = {
						has_country_flag = CHI_national_protection_flag
					}
				}
				FROM = {
					if = {
						limit = {
							tag = YUN
						}
						if = {
							limit = {
								is_ai = no
								PREV = { is_ai = yes }
							}
							PREV = {
								country_event = ww1_china.154
								change_tag_from = PREV
							}
						}
					}
					#beiyang npa
					else = {
						every_state = {
							limit = {
								OR = {
									is_core_of = PREV
									is_claimed_by = PREV
								}
							}
							remove_core_of = PREV
							remove_claim_by = PREV
						}
						every_owned_state = {
							transfer_state_to = ROOT
						}
						every_character = {
							set_nationality = ROOT
						}
						transfer_navy = {
							target = PREV
						}
						transfer_units_fraction = {
							target = PREV
							size = 1
							target_organization = 1
							source_organization = 1
						}
						set_politics = {
							ruling_party = neutrality
							elections_allowed = yes
						}
						set_popularities = {
							fascism = 23
							neutrality = 67
							democratic = 10
						}
						if = {
							limit = { has_character = CHI_li_yuanhong }
							CHI_duan_qirui = {
								promote_character = stratocracy
								promote_character = authoritarian_democracy
							}
						}
						if = {
							limit = { has_character = CHI_li_yuanhong }
							CHI_li_yuanhong = {
								promote_character = authoritarian_democrac
							}
						}
						if = {
							limit = { has_character = CHI_yuan_shikai }
							CHI_yuan_shikai = {
								promote_character = authoritarian_democrac
								promote_character = stratocracy
							}
						}
					}
				}
			}
			if = {
				limit = {
					original_tag = DAR
					ENG = {
						has_war_with = PREV
						owns_state = 549
					}
				}
				ENG = {
					annex_country = {
						target = DAR
					}
					country_event = ww1_england.190
				}
			}
			if = {
				limit = {
					tag = RSO
					SOV = {
						has_war_with = PREV
					}
				}
				SOV = {
					annex_country = {
						target = RSO
					}
				}
				RSO = {
					every_state = {
						limit = {
							OR = {
								is_core_of = PREV
								is_claimed_by = PREV
							}
						}
						remove_core_of = PREV
						remove_claim_by = PREV
					}
				}
			}
			# Baku Commune
			if = {
				limit = {
					tag = BAK
				}
				every_state = {
					limit = {
						OR = {
							is_core_of = BAK
							is_claimed_by = BAK
						}
					}
					remove_core_of = BAK
					remove_claim_by = BAK
				}
				random_other_country = {
					limit = {
						original_tag = AZR
						has_war_with = BAK
					}
					annex_country = {
						target = BAK
					}
				}
			}
			# Ottoman-Greece checker
			if = {
				limit = {
					tag = GRE
					is_great_war_ongoing = yes
					OR = {
						has_war_together_with = GER
						has_war_together_with = FRA
						has_war_with = BUL
						has_war_with = TUR
					}
				}
				set_global_flag = greek_defeated_in_ww1
			}
			if = {
				limit = {
					original_tag = ALB
					has_country_flag = military_access_to_serbia
					is_great_war_ongoing = yes
					has_war_with = AUS
					FROM = {
						OR = {
							tag = AUS
							any_country = {
								OR = {
									is_in_faction_with = AUS
									is_subject_of = AUS
								}								
							}
						}
					}

				}
				ALB = {
					remove_ideas = standing_alone
					set_country_flag = AUH_occupation_of_ALB
					set_politics = {
						ruling_party = neutrality
						long_name = ALB_neutrality_durres_party
						name = ALB_neutrality_durres_party
						elections_allowed = no
					}
					set_popularities = {
						democratic = 40
						neutrality = 60
					}
					promote_character = ALB_turhan_permeti
					set_cosmetic_tag = ALB_principality
					remove_ideas = ALB_idea_unstable_regime
				}
				AUS = {
					annex_country = {
						target = ALB
					}
				}
			}
			if = {
				limit = {
					original_tag = SYR
					is_in_faction = no
					is_subject = no
					FROM = {
						tag = FRA
						has_country_flag = franco_syrian_war
					}
				}
				FROM = {
					set_country_flag = franco_syrian_war_end
					annex_country = {
						target = ROOT
					}
					country_event = ww1_france.257
				}
			}
			if = {
				limit = {
					original_tag = PER
					FROM = {
						original_tag = PER
						has_country_flag = PER_gendarmerie_flag
					}
				}
				FROM = {
					transfer_navy = {
						target = ROOT
					}
					every_enemy_country = {
						ROOT = {
							add_to_war = {
								targeted_alliance = FROM
								enemy = PREV
							}
						}
					}
				}
				annex_country = {
					target = FROM
				}
				set_politics = {
					ruling_party = fascism
					elections_allowed = no
				}
				add_popularity = {
					ideology = fascism
					popularity = 0.35
				}
				create_country_leader = {
					name = PER_persian_central_government
					picture = "gfx/leaders/PER/PER_gendarmerie.png"					
					ideology = stratocracy
				}
				add_ideas = standing_alone
				set_country_flag = PER_gendarmerie_flag
				clear_all_relations = yes
				change_tag_from = FROM
			}
			if = {
				limit = {
					original_tag = PER
					has_country_flag = PER_gendarmerie_flag
				}
				transfer_navy = {
					target = PER
				}
				PER = {
					annex_country = {
						target = ROOT
					}
				}
			}
			if = {
				limit = {
					original_tag = JAP
					FROM = {
						original_tag = GER
					}
				}
				FROM = {
					set_country_flag = our_place_in_the_rising_sun_flag
				}
			}
			if = {
				limit = {
					original_tag = SAF
					has_country_flag = boer_rebellion
					FROM = {
						original_tag = SAF
					}
				}
				FROM = {
					country_event = {
						id = ww1_southafrica.3
					}
				}
			}
			if = {
				limit = {
					OR = {
						original_tag = ZIM
						original_tag = BOT
					}
					FROM = {
						original_tag = SAF
					}
				}
				FROM = {
					annex_country = {
						target = ROOT
					}
				}
			}
			if = {
				limit = {
					original_tag = LAT
					OR = {
						has_country_flag = LAT_iskolata
						has_cosmetic_tag = LAT_iskolata
					}
					is_in_faction = no
					has_war_with = GER
				}
				if = {
					limit = {
						owns_state = 12
					}
					191 = {
						owner = {
							set_state_owner = 12
						}
					}
				}
				if = {
					limit = {
						owns_state = 96
					}
					913 = {
						owner = {
							set_state_owner = 96
						}
					}
				}
				if = {
					limit = {
						country_exists = UBD
					}
					UBD = {
						annex_country = {
							target = ROOT
						}
						set_province_controller = 9340
					}
				}
				else = {
					12 = {
						owner = {
							every_state = {
								limit = { is_owned_by = ROOT }
								set_state_owner_to = PREV
							}
						}
					}
				}
				every_controlled_state = {
					set_state_controller_to = OWNER
				}
				clear_iskolata = yes
			}
			if = {
				limit = {
					original_tag = GEO
					OR = {
						has_cosmetic_tag = GEO_TSCN
						has_cosmetic_tag = GEO_TSCN_commissariat
						has_cosmetic_tag = GEO_TSCN_committee
					}
					has_war_with = TUR
				}
				country_event = ww1_georgia.11
			}
			if = {
				limit = {
					original_tag = UBD
					has_global_flag = compiegne_armistice
				}
				every_state = {
					limit = { is_core_of = UBD }
					remove_core_of = UBD
				}
				every_state = {
					limit = { is_claimed_by = UBD }
					remove_claim_by = UBD
				}
				every_enemy_country = {
					every_state = {
						limit = {
							is_owned_by = UBD
							is_core_of = PREV
						}
						transfer_state_to = PREV
					}
				}
				if = {
					limit = { has_character = GER_rudiger_von_der_goltz }
					GER_rudiger_von_der_goltz = {
						remove_country_leader_role = {
							ideology = stratocracy
						}
						demote_leader = yes
						set_nationality = GER
					}
				}
			}
			if = {
				limit = {
					has_character = SWE_harald_hjalmarson
				}
				if = {
					limit = {
						FIN = { has_civil_war = yes }
					}
					SWE_harald_hjalmarson = {
						set_nationality = FIN
					}
				}
				else = {
					SWE_harald_hjalmarson = {
						set_nationality = SWE
					}
				}
			}
			if = {
				limit = {
					original_tag = ARM
					has_country_leader = {
						character = ARM_andranik_ozanian
						ruling_only = yes
					}
				}
				every_state = {
					limit = {
						OR = {
							is_core_of = PREV
							is_claimed_by = PREV
						}
					}
					remove_core_of = PREV
					remove_claim_by = PREV
				}
				if = {
					limit = { has_war_with = AZR }
					every_owned_state = {
						transfer_state_to = AZR
					}
				}
				else = {
					random_other_country = {
						limit = {
							is_neighbor_of = PREV
							has_war_with = PREV
						}
						annex_country = {
							target = PREV
						}
					}
				}
			}
			if = {
				limit = {
					original_tag = ASY
					has_war_with = TUR
				}
				TUR = {
					annex_country = {
						target = ASY
					}
				}
			}
			if = {
				limit = {
					tag = MAC
					has_war_with = SER
				}
				SER = {
					annex_country = {
						target = MAC
						transfer_troops = no
					}
					country_event = ww1_serbia.60
				}
				if = {
					limit = {
						has_character = ALB_isa_boletini
					}
					ALB_isa_boletini = {
						set_nationality = ALB
					}
				}
				every_state = {
					limit = {
						is_core_of = MAC
					}
					remove_core_of = MAC
				}
			}
			if = {
				limit = {
					tag = MON
					has_country_leader = {
						character = RUS_roman_ungern_sternberg
						ruling_only = yes
					}
					has_war_with = SOV
					SOV = {
						has_government = communism
					}
				}
				SOV = {
					if = {
						limit = {
							MON = {
								owns_state = 329
							}
							TAN = {
								OR = {
									exists = no
									is_subject_of = MON
								}
							}
						}
						TAN = {
							transfer_state = 329
						}
						puppet = TAN
					}
					if = {
						limit = {
							MON = {
								is_in_faction = no
								is_ai = yes
							}
						}
						MON = {
							transfer_state = 330
							transfer_state = 982
							drop_cosmetic_tag = yes
							retire_character = RUS_roman_ungern_sternberg
							retire_character = TBK_boris_rezukhin
							swap_ideas = {
								remove_idea = MON_bogd_khan_sternberg
								add_idea = MON_bogd_khan_MAN
							}
							if = {
								limit = {
									has_character = ALT_aleksandr_kaygorodov
								}
								ALT_aleksandr_kaygorodov = {
									set_nationality = ALT
									promote_character = yes
								}
							}
							set_party_name = { 
								ideology = fascism 
								long_name = MON_fascism_party 
								name = MON_fascism_party 
							}						
						}
						set_province_name = {
							id = 4801
							name = ULANBATOR_PROV
						}
						SOV = {
							set_autonomy = {
								target = MON
								autonomy_state = autonomy_satellite
								freedom_level = 0.5
								end_wars = yes
							}
						}
					}	
				}
			}
			if = {
				limit = {
					original_tag = LBA
					has_war_with = ITA
					ITA = {
						has_war_with = TUR
					}
					has_global_flag = italo_turkish_war
					NOT = {
						has_global_flag = italo_turkish_war_ends
					}
				}
				white_peace = ITA
			}
			if = {
				limit = {
					tag = POL
					has_war_with = SOV
					SOV = {
						has_government = communism
					}
					is_subject = no
					is_in_faction = no
				}
				SOV = {
					white_peace = ROOT
					set_autonomy = {
						target = ROOT
						autonomy_state = autonomy_puppet
					}
				}
				ROOT = {
					set_politics = {
						ruling_party = communism
						elections_allowed = no
					}
					set_popularities = {
						communism = 75
						neutrality = 10
						democratic = 15
					}
					every_possible_country = {
						limit = {
							has_character = SOV_felix_dzerzhinsky
						}	
						SOV_felix_dzerzhinsky = {
							set_nationality = POL
							set_character_name = POL_felix_dzerzhinsky
							promote_character = vanguardism
						}			
					}
					set_party_name = { ideology = communism name = POL_polrewkom_party long_name = POL_polrewkom_party_long }
					set_cosmetic_tag = POL_SOVIET

					every_owned_state = {
						limit = {
							OR = {
								is_core_of = SOV
								is_core_of = UKR
								is_core_of = WUK
								is_core_of = BLR
								is_core_of = LIT
								is_core_of = GER
								region = 8
							}
							NOT = {
								state = 237
							}
						}
						random_country = {
							limit = {
								original_tag = UKR
								OR = {
									is_subject_of = SOV
									is_in_faction_with = SOV
								}
							}
							if = {
								limit = {
									PREV = { 
										is_owned_by = ROOT 
										OR = {
											is_core_of = UKR
											is_core_of = WUK 
										}
									}					
								}
								transfer_state = PREV
								add_state_core = PREV
							}
						}
						random_country = {
							limit = {
								original_tag = BLR
								OR = {
									is_subject_of = SOV
									is_in_faction_with = SOV
								}
							}
							if = {
								limit = {
									PREV = { is_owned_by = ROOT OR = { is_core_of = BLR state = 97 } }
								}
								transfer_state = PREV
							}
						}
						random_country = {
							limit = {
								original_tag = LIT
								OR = {
									is_subject_of = SOV
									is_in_faction_with = SOV
								}
							}
							if = {
								limit = {
									PREV = { is_owned_by = ROOT is_core_of = LIT }
								}
								transfer_state = PREV
							}
						}
						random_country = {
							limit = {
								original_tag = GER
								OR = {
									is_subject_of = SOV
									is_in_faction_with = SOV
								}
							}
							if = {
								limit = {
									PREV = {
										is_owned_by = ROOT
										OR = {
											is_core_of = GER
											region = 8
										}
									}
								}
								add_state_core = PREV
								transfer_state = PREV
							}
						}
						if = {
							limit = {
								is_owned_by = ROOT
								NOT = {
									is_core_of = GER
									region = 8
								}
							}
							transfer_state_to = SOV
						}
					}
				}
				SOV = {
					every_owned_state = {
						limit = {
							is_core_of = BLR
						}
						random_country = {
							limit = {
								original_tag = BLR
								OR = {
									is_in_faction_with = SOV
									is_subject_of = SOV
								}
							}
							transfer_state = PREV
						}
					}
					every_owned_state = {
						limit = {
							is_core_of = LIT
						}
						random_country = {
							limit = {
								original_tag = LIT
								OR = {
									is_in_faction_with = SOV
									is_subject_of = SOV
								}
							}
							transfer_state = PREV
						}
					}
					every_owned_state = {
						limit = {
							OR = {
								is_core_of = UKR
								is_core_of = WUK 
							}
						}
						random_country = {
							limit = {
								original_tag = UKR
								OR = {
									is_in_faction_with = SOV
									is_subject_of = SOV
								}
							}
							add_state_core = PREV
							transfer_state = PREV
						}
					}
				}
			}
			if = {
				limit = {
					tag = VIN
					has_war_with = IND
					is_subject = no
					is_in_faction = no
				}
				IND = {
					annex_country = {
						target = PREV
					}
				}
			}
			if = {
				limit = {
					tag = NWA				
					has_war_with = SOV
					has_country_flag = NWA_can_go_exile_in_EST
					EST = {
						exists = yes
						NOT = {
							has_war_with = ROOT
						}
					}
				}
				NWA = {
					become_exiled_in = {
						target = EST
						legitimacy = 5
					}
					clr_country_flag = NWA_can_go_exile_in_EST
				}
				EST = {				
					# load_oob = "EST_NWA"
					country_event = ww1_nwa.4
				}	
			}
			if = {
				limit = {
					tag = GXC
					has_war_with = CHI
					has_global_flag = constitutional_protection_war
					NOT = {
						has_global_flag = constitutional_protection_war_end
					}
				}
				set_global_flag = constitutional_protection_war_end
				white_peace = CHI
				every_owned_state = {
					limit = {
						NOT = { state = 599 }
					}
					transfer_state_to = CHI
				}
				transfer_navy = {
					target = CHI
				}
				CHI = {
					add_war_support = 0.10
					add_stability = 0.20
					remove_ideas = standing_alone
					annex_country = {
						target = GDC
					}
					set_autonomy = {
						target = GXC
						autonomy_state = autonomy_tgwr_regional_government
					}
					set_autonomy = {
						target = GZC
						autonomy_state = autonomy_tgwr_regional_government
					}
					set_autonomy = {
						target = YUN
						autonomy_state = autonomy_tgwr_regional_government
					}
					if = {
						limit = {
							any_subject_country = {
								original_tag = HNC
							}
						}
						random_other_country = {
							limit = {
								original_tag = HNC
								is_subject_of = PREV
							}
							annex_country = {
								target = HNC
								transfer_troops = yes
							}
						}
					}
					else = {
						set_autonomy = {
							target = HNC
							autonomy_state = autonomy_tgwr_regional_government
						}
					}
				}
			}
			if = {
				limit = {
					tag = LBA
					is_subject = no
					has_war_with = ENG
					ENG = { is_subject = no }
					is_great_war_ongoing = yes
					NOT = { 
						has_country_flag = LBA_modus_vivendi_of_acroma
					}
				}
				LBA_modus_vivendi = yes
			}
			if = {
				limit = {
					original_tag = LUX
					is_subject = no
					has_idea = LUX_london_treaty
					NOT = {
						has_government = communism
					}
					GER = {
						has_war_with = ROOT
						is_subject = no
						NOT = {
							has_government = communism
						}
					}
					has_global_flag = great_war
					NOT = {
						has_global_flag = luxembourg_submitted
						has_global_flag = GER_capitulation
						has_global_flag = FRA_capitulation
					}			
				}			
				GER = {
					ROOT = { 
						country_event = { id = ww1_luxembourg.5 } 
					}
				}
					
			}
			if = {
				limit = {
					tag = SER
					has_completed_focus = SER_war_preparations
				}
				SER = {
					set_capital = { state = 107 }
					set_victory_points = {
						province = 11887
						value = 2
					}
					set_victory_points = {
						province = 11586
						value = 10
					}
				}
			}
			if = {
				limit = {
					tag = JNC
					has_country_leader = {
						character = ZHC_qi_xieyuan
						ruling_only = yes
					}
					any_enemy_country = {
						is_china_or_warlord_no_tt = yes
					}
				}
				ZHC_qi_xieyuan = {
					remove_country_leader_role = {
						ideology = warlordism
					}
					remove_country_leader_role = {
						ideology = stratocracy
					}
					demote_leader = yes
					if = {
						limit = {
							country_exists = FNG
						}
						set_nationality = FNG
					}
				}
				if = {
					limit = {
						country_exists = FJN
						FJN = {
							any_character = {
								is_country_leader = yes
								has_character_flag = zhili_allegiance
							}
						}
					}
					transfer_units_fraction = {
						target = FJN
						size = 0.5
						keep_unit_leaders_trigger = {
							always = yes
						}
					}
					every_character = {
						set_nationality = FJN
					}
				}
				if = {
					limit = {
						has_war_with = FNG
					}
					transfer_units_fraction = {
						target = FNG
						size = 0.5
						keep_unit_leaders_trigger = {
							always = yes
						}
					}
					transfer_navy = {
						target = FNG
					}
					FNG = {
						annex_country = {
							target = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					tag = ZHC
					is_subject = no
					ANC = {
						is_subject = no
						has_war_with = ROOT
					}
					has_global_flag = zhili_anhui_war
					NOT = {
						has_global_flag = zhili_anhui_war_end
					}
				}
				transfer_navy = {
					target = ANC
				}
				transfer_units_fraction = {
					target = ANC
					size = 1
					keep_unit_leaders_trigger = {
						always = yes
					}
				}
				every_core_state = {
					remove_core_of = ROOT
				}
				every_state = {
					limit = {
						is_claimed_by = ROOT
					}
					remove_claim_by = ROOT
				}
				ANC = {
					annex_country = {
						target = ROOT
						transfer_troops = yes
					}
					news_event = {
						id = ww1_china.254
						hours = 3
					}
				}
			}
			# Entente leader transfer
			if = {
				limit = {
					has_country_flag = entente_leader
					is_great_war_ongoing = yes
				}
				clr_country_flag = entente_leader
				if = {
					limit = {
						any_allied_country = {
							has_war_with = GER
							is_major = yes
						}
					}
					random_other_country = {
						limit = {
							is_in_faction_with = ROOT
							has_war_with = GER
							is_major = yes
						}
						set_country_flag = entente_leader
						set_faction_leader = yes
					}
				}
				#why the hell italy keep stripped of from major
				else_if = {
					limit = {
						any_allied_country = {
							has_war_with = GER
							capital_scope = {
								is_on_continent = europe
							}
						}
					}
					random_other_country = {
						limit = {
							is_in_faction_with = ROOT
							has_war_with = GER
							capital_scope = {
								is_on_continent = europe
							}
						}
						set_country_flag = entente_leader
						set_faction_leader = yes
					}
				}
				#unlikly but failsafe
				else = {
					random_other_country = {
						limit = {
							is_in_faction_with = ROOT
							has_war_with = GER
						}
						set_country_flag = entente_leader
						set_faction_leader = yes
					}
				}
			}
			log = "[GetDateText]: [ROOT.GetName] has capitulated by [FROM.GetName]"
		}
	}
	on_civil_war_end = {
		effect = {
			if = {
				limit = {
					original_tag = ECU
				}
				set_cosmetic_tag = ECU
				set_capital = { state = 305 }
				if = {
					limit = {
						has_government = neutrality
					}
					set_politics = {
						ruling_party = neutrality
						elections_allowed = yes
					}
				}
			}			
			else_if = {
				limit = {
					original_tag = UKR
					has_cosmetic_tag = UKR_SOV_provisional
				}
				SOV = {
					SOV_christian_rakovsky = { 
						set_nationality = PREV.PREV 
						promote_character = yes
					}
				}
				set_cosmetic_tag = UKR_SOV
				if = {
					limit = {
						is_subject_of = SOV
					}
					if = {
						limit = {
							BLR = {
								exists = yes
								OR = {
									is_subject = no
									is_subject_of = SOV
								}	
							}
						}
						every_owned_state = {
							limit = {
								is_core_of = BLR
							}
							transfer_state_to = BLR
						}
					}
					every_owned_state = {
						limit = {
							is_core_of = SOV
						}
						transfer_state_to = SOV
					}					
				}
				set_capital = { state = 202 }
			}
			else_if = {
				limit = {
					original_tag = POR
					OR = {
						has_cosmetic_tag = POR_REP_provisional
						has_cosmetic_tag = POR_constitutional
					}
				}
				set_cosmetic_tag = POR_REP
			}
			else_if = {
				limit = {
					original_tag = MEX
				}
				FROM = {
					every_character = {
						limit = {
							OR = {
								can_be_country_leader = yes
								is_unit_leader = yes	
							}
						}
						set_nationality = ROOT
					}
				}
				if = {
					limit = {
						FROM = {
							has_country_flag = monroe_doctrine
						}
						country_exists = USA
						NOT = {
							has_war_with = USA
						} 
					}
					set_country_flag = monroe_doctrine
					USA = {
						give_guarantee = ROOT
					}	
				}
				if = {
					limit = {
						NOT = {
							has_government = communism
						}						
					}
					MEX_jesus_flores_magon = {
						promote_character = anarchism
					}
					MEX_ricardo_flores_magon = {
						promote_character = anarchism
					}
				}
				if = {
					limit = {
						has_cosmetic_tag = MXC
					}
					set_cosmetic_tag = MEX_third_federal_republic
				}	
				if = {
					limit = {
						has_country_flag = MXC
					}
					clr_country_flag = MXC
					set_country_flag = MEX_third_federal_republic
				}
				clr_country_flag = MXM
				if = {
					limit = {
						OR = {
							has_cosmetic_tag = MXM
							has_cosmetic_tag = ZAP
							has_cosmetic_tag = MCA
						}
					}
					if = {
						limit = {
							has_government = communism
						}
						set_cosmetic_tag = MEX_communism
						else = {
							set_cosmetic_tag = MEX
						}	
					}	
				}	
				set_capital = { state = 227 }
			}			
			else_if = {
				limit = {
					original_tag = CRI
				}
				set_capital = { state = 137 }
				FROM = {
					every_character = {
						set_nationality = ROOT
						if = {
							limit = {
								is_character = RUS_matvei_sulkevich
							}
							promote_character = authoritarian_democracy
							promote_character = stratocracy
						}
						if = {
							limit = {
								is_character = CRI_dmitri_ulyanov
							}
							promote_character = yes
						}
					}
					every_state = {
						limit = {
							OR = {
								is_core_of = PREV
								is_claimed_by = PREV
							}
						}
						remove_claim_by = PREV
						remove_core_of = PREV
					}
				}
				if = {
					limit = { has_cosmetic_tag = CRI_taurida }
					137 = { set_state_name = TAVRIDA_STATE }
					else = {
						137 = { reset_state_name = yes }
					}
				}
				if = {
					limit = { 
						has_government = democratic
						NOT = { has_cosmetic_tag = CRI_GER }
					}
					set_victory_points = {
						province = 3169
						value = 5
					}
					else = {
						set_victory_points = {
							province = 3169
							value = 1
						}
					}
				}
			}
			else_if = {
				limit = {
					original_tag = IRE
				}
				if = {
					limit = {
						has_country_flag = irish_civil_war
						has_cosmetic_tag = IRE_IRA
						has_government = fascism
					}
					set_politics = {
						ruling_party = democratic
						long_name = IRE_democratic_sinn_fein_party
						name = IRE_democratic_sinn_fein_party
						elections_allowed = yes
					}
					add_popularity = {
						ideology = democratic
						popularity = 0.2
					}
				}
				clr_country_flag = irish_civil_war
				FROM = {
					clr_country_flag = irish_civil_war
					every_unit_leader = {
						limit = {
							NOT = {
								is_character = IRE_liam_lynch
							}
						}
						set_nationality = ROOT
					}
					transfer_navy = {
						target = ROOT
					}
				}
				set_capital = { state = 113 }			
			}
			else_if = {
				limit = {
					original_tag = PER
				}
				set_capital = { state = 266 }
				if = {
					limit = {
						ARB = {
							OR = {
								is_subject = no
								is_subject_of = PER
							}
							OR = {
								is_in_faction = no
								is_in_faction_with = PER
								is_in_faction_with = ROOT
							}
							NOT = {
								is_subject_of = ROOT
								has_war_with = ROOT
								has_war_together_with = ENG
							}
						}
					}
					ARB = {
						get_current_government_type = yes
					}
					PER = {
						set_capital = { state = 266 }
						set_autonomy = {
							target = ARB
							autonomous_state = autonomy_integrated_puppet
							freedom_level = 0.9
						}
					}
					ARB = {
						restore_previous_government_type = yes
					}
				}
			}
			else_if = {
				limit = {
					original_tag = CHA
					has_country_flag = CHA_french_wadai_tag
				}				
				if = {
					limit = {
						is_subject_of = FRA
					}
					FRA = {
						annex_country = {
							target = ROOT
						}
					}
					every_state = {
						limit = {
							is_claimed_by = ROOT
						}
						remove_claim_by = ROOT
					}
					every_state = {
						limit = {
							is_core_of = ROOT
						}
						remove_core_of = ROOT
					}
					else = {
						set_cosmetic_tag = CHA
						set_capital = { state = 774 }
						clr_country_flag = empty_focus
						load_focus_tree = generic_focus
					}
				}
			}
			else_if = {
				limit = {
					original_tag = ROM
				}
				
				set_capital = { state = 46 }
				if = {
					limit = {
						has_cosmetic_tag = RMC
					}
					set_cosmetic_tag = ROM
				}
			}
			else_if = {
				limit = {
					original_tag = ALB
					FROM = {
						has_character = ALB_essad_pasha_toptani
					}
				}
				FROM = {
					ALB_essad_pasha_toptani = {
						set_nationality = ROOT
					}
				}
			}
			else_if = {
				limit = {
					original_tag = FIN
				}
				set_capital = { state = 111 }
				FROM = {
					every_character = {
						limit = {
							NOT = {
								ROOT = {
									has_character = PREV
								}
							}
						}
						set_nationality = ROOT
					}
				}
				if = {
					limit = {
						NOT = {
							tag = FNR
						}
					}
					promote_character = FIN_kullervo_manner
				}
				else = {
					FIN_pehr_evind_svinhufvud = {
						promote_character = authoritarian_democracy
					}
					FIN_nikolai_mexmontan = {
						promote_character = stratocracy
					}
					if = {
						limit = { has_cosmetic_tag = FIN_red }
						set_cosmetic_tag = FIN_socialist
					}
				}				
			}
			else_if = {
				limit = {
					original_tag = GRE
				}
				FROM = {
					every_character = { set_nationality = ROOT }
				}
				set_capital = { state = 898 }	
				if = {
					limit = { 
						has_character = TUR_avraam_benaroya
						NOT = {
							has_government = communism
							has_completed_focus = GRE_found_the_SEKE
						}
					}
					promote_character = TUR_avraam_benaroya
					set_party_name = { 
						ideology = communism
						long_name = GRE_federacion_party_long
						name = GRE_federacion_party
					}		
				}		
			}
			if = {
				limit = {
					has_idea = standing_alone
					has_war = no
				}
				remove_ideas = standing_alone
			}
			log = "[GetDateText]: [ROOT.GetName] has ended the civil war against [FROM.GetName]"
		}
	}
	#ROOT is winner, FROM gets annexed. It will also fire on_annex and on_civil_war_end.
	on_civil_war_end_before_annexation = {
		effect = {
			#British Civil War
			if = {
				limit = {
					tag = UOB
					FROM = { tag = GBR }
				}
				FROM = {
					if = {
						limit = { has_war_with = SCO }
						white_peace = SCO
					}
					every_other_country = {
						limit = {
							OR = {
								is_subject_of = PREV
								is_in_faction_with = PREV
								is_commonwealth_tag = yes
								AND = {
									is_subject = yes
									OVERLORD = {
										is_commonwealth_tag = yes
									}
								}
							}
						}
						if = {
							limit = {
								PREV = {
									is_faction_leader = yes
								}
							}
							dismantle_faction = yes
						}
						else = {
							PREV = { leave_faction = yes }
						}
						white_peace = ROOT #peace with union
						if = {
							limit = {
								is_subject_of = PREV
							}
							if = {
								limit = {
									NOT = {
										has_country_flag = has_british_monarchy
									}
									OR = {
										original_tag = CAN
										original_tag = NZL
										original_tag = AST
										original_tag = NFL
									}
								}
								country_event = {
									id = ww1_england.268
									days = 14
								}
							}
							PREV = { end_puppet = PREV }
						}
					}
					every_state = {
						limit = {
							OR = {
								is_core_of = PREV
								is_claimed_by = PREV
							}
						}
						remove_core_of = PREV
						remove_claim_by = PREV
					}
					every_owned_state = {
						limit = {
							is_core_of = IRE
						}
						transfer_state_to = IRE
					}
					every_owned_state = {
						limit = {
							is_core_of = CAN
						}
						transfer_state_to = CAN
					}
					delete_unit_template_and_units = {
						division_template = "White Guards"
						disband = no
					}
					clear_all_relations_except_wars = yes
					#surrenderers
					transfer_units_fraction = {
						target = ROOT
						size = 0.35
						keep_unit_leaders_trigger = {
							OR = {
								has_trait = trait_royal
								has_trait = trait_royalist
							}
						}
					}
					if = {
						limit = {
							has_character = ENG_herbert_george_wells
						}
						ENG_herbert_george_wells = {
							add_advisor_role = {
								advisor = {
									idea_token = ENG_herbert_george_wells
									slot = political_advisor
									traits = {
										ENG_socialist_author_h_g_wells
									}
								}
							}
							set_nationality = UOB
						}
					}
					if = {
						limit = {
							has_character = ENG_john_robert_clynes
						}
						ENG_john_robert_clynes = {
							add_advisor_role = {
								advisor = {
									idea_token = ENG_john_robert_clynes
									slot = political_advisor
									traits = {
										labour_man
									}
									cost = 40
								}
							}
							set_nationality = UOB
						}
					}
					if = {
						limit = {
							has_character = ENG_ramsay_macdonald
						}
						ENG_ramsay_macdonald = {
							add_advisor_role = {
								advisor = {
									idea_token = ENG_ramsay_macdonald
									slot = political_advisor
									traits = {
										pragmatic_labour
									}
								}
							}
							set_nationality = UOB
						}
					}
					if = {
						limit = {
							has_character = ENG_ramsay_macdonald
						}
						ENG_ramsay_macdonald = {
							set_nationality = UOB
						}
					}
					if = {
						limit = {
							NOT = {
								has_global_flag = British_Royals_flee_to_Canada
							}
						}
						if = {
							limit = {
								CAN = {
									exists = yes
									NOT = { has_government = communism }
								}
							}
							CAN = {
								country_event = canada.69
							}
						}
						else_if = {
							limit = {
								AST = {
									exists = yes
									NOT = { has_government = communism }
								}
							}
							AST = {
								country_event = ww1_australia.12
							}
						}
					}
				}
				set_capital = {
					state = 126
				}
			}
			# British Civil War
			if = {
				limit = {
					tag = GBR
					FROM = { tag = UOB }
				}
				FROM = {
					every_other_country = {
						limit = {
							OR = {
								is_subject_of = PREV
								is_in_faction_with = PREV
							}
						}
						if = {
							limit = {
								PREV = {
									is_faction_leader = yes
								}
							}
							dismantle_faction = yes
						}
						else = {
							PREV = { leave_faction = yes }
						}
						white_peace = ROOT #peace with london
					}
					every_state = {
						limit = {
							OR = {
								is_core_of = PREV
								is_claimed_by = PREV
							}
						}
						remove_core_of = PREV
						remove_claim_by = PREV
					}
					transfer_navy = {
						target = ROOT
					}
					delete_unit_template_and_units = {
						division_template = "Red Guards"
						disband = no
					}
					transfer_units_fraction = {
						target = ROOT
						size = 0.8
						keep_unit_leaders_trigger = {
							always = yes
						}
					}
					clear_all_relations_except_wars = yes
				}
			}
			# Chinese Second Revolution
			if = {
				limit = {
					tag = CHI
					FROM = {
						tag = CHR
					}
				}
				FROM = {
					transfer_navy = {
						target = ROOT
					}
					every_character = {
						set_nationality = ROOT
					}
				}
				if = {
					limit = { has_character = CHI_li_liejun }
					CHI_li_liejun = {
						set_nationality = YUN
					}
				}
				if = {
					limit = { has_character = CHI_yuan_shikai }
					CHI_yuan_shikai = {
						if = {
							limit = {
								has_ideology = authoritarian_democracy
							}
							promote_character = authoritarian_democracy
						}
						if = {
							limit = {
								has_ideology = civilian_dictatorship
							}
							promote_character = civilian_dictatorship
						}
						promote_character = stratocracy
					}
				}
				if = {
					limit = { has_character = CHI_sun_yatsen }
					CHI_sun_yatsen = {
						promote_character = tridemism
					}
				}
				if = {
					limit = { has_character = CHI_jiang_kanghu }
					promote_character = CHI_jiang_kanghu
				}
				if = {
					limit = { has_completed_focus = CHI_ruling_of_yuan_shikai }
					set_capital = { state = 608 }
				}
				# Chinese Revolutionary Party
				country_event = {
					id = ww1_china.132
					days = 280
				}
			}
			if = {
				limit = {
					tag = CHR
					FROM = { tag = CHI }
				}
				FROM = {
					transfer_navy = {
						target = ROOT
					}
					every_character = {
						set_nationality = ROOT
					}
				}
				if = {
					limit = { has_character = CHI_yuan_shikai }
					CHI_yuan_shikai = {
						if = {
							limit = {
								has_ideology = authoritarian_democracy
							}
							promote_character = authoritarian_democracy
						}
						if = {
							limit = {
								has_ideology = civilian_dictatorship
							}
							promote_character = civilian_dictatorship
						}
						promote_character = stratocracy
					}
				}
				if = {
					limit = { has_character = CHI_li_yuanhong }
					CHI_li_yuanhong = {
						if = {
							limit = { has_ideology = authoritarian_democracy }
							promote_character = authoritarian_democracy
						}
						else = {
							add_country_leader_role = {
								promote_leader = yes
								country_leader = {
									ideology = authoritarian_democracy
								}
							}
						}
					}
				}
				if = {
					limit = { has_character = CHI_sun_yatsen }
					CHI_sun_yatsen = {
						promote_character = tridemism
					}
				}
				if = {
					limit = { has_character = CHI_jiang_kanghu }
					promote_character = CHI_jiang_kanghu
				}
				set_popularities = {
					democratic = 78
					neutrality = 22
				}
				set_cosmetic_tag = CHI_kmt
				country_event = {
					id = ww1_china.123
					days = 30
				}
			}
		}
	}
	on_ruling_party_change = {
		effect = {					
			if = {
				limit = {
					has_government = communism
				}
				if = {
					limit = {
						original_tag = GER
						NOT = {
							has_cosmetic_tag = GER_socialism
							has_cosmetic_tag = GER_ruhr_revolt
							has_cosmetic_tag = BAY_germany
							has_cosmetic_tag = PRE
						}
					}
					if = {
						limit = {
							has_country_leader_ideology = reformist_socialism
						}
						set_cosmetic_tag = GER_republic
						else = {
							set_cosmetic_tag = GER_socialism
						}
					}
				}
				else_if = {
					limit = {
						original_tag = FRA
					}
					if = {
						limit = { 
							NOT = {
								has_cosmetic_tag = FRA_socialism
								has_cosmetic_tag = FRA_socialism_not_commune
								has_cosmetic_tag = FRA_socialism_syndicalist
								has_cosmetic_tag = FRA_socialism_republic_of
								has_cosmetic_tag = NFA
								has_country_flag = AEF
								has_country_flag = AOF
							}
						}
						set_cosmetic_tag = FRA_socialism
					}
					else_if = {
						limit = { has_cosmetic_tag = AEF }
						set_cosmetic_tag = AEF_communism
					}
					else_if = {
						limit = { has_cosmetic_tag = AOF }
						set_cosmetic_tag = AOF_communism
					}					
				}
				else_if = {
					limit = {
						original_tag = ITA
						NOT = {
							has_cosmetic_tag = ITA_socialism
							has_cosmetic_tag = SRI
							has_cosmetic_tag = ITS
							has_cosmetic_tag = ITS_bourbon
						}
					}
					set_cosmetic_tag = ITA_socialism
				}
				else_if = {
					limit = {
						original_tag = RUS						
					}
					if = {
						limit = {
							NOT = {
								has_cosmetic_tag = RUS_socialism
								has_cosmetic_tag = RUS_absolutism
								has_cosmetic_tag = RUS_eser
								has_cosmetic_tag = SOV
								has_cosmetic_tag = SOV_union
								has_cosmetic_tag = SRA
								has_cosmetic_tag = SRA_government 
								has_cosmetic_tag = SRA_wrangel
								has_cosmetic_tag = KOMUCH
								has_cosmetic_tag = URA
								has_cosmetic_tag = SIB
								has_cosmetic_tag = SIB_communism
								has_cosmetic_tag = RSO
								has_cosmetic_tag = STV
								has_cosmetic_tag = STV_communism
								has_cosmetic_tag = TRC
								has_cosmetic_tag = RUS_state
								has_cosmetic_tag = POLITCENTRE
								has_cosmetic_tag = PRI
								has_cosmetic_tag = PRI_communism
								has_cosmetic_tag = PRI_rozanov
							}							
						}
						if = {
							limit = {
								NOT = {
									has_country_leader_ideology = vanguardism
								}												
							}
							set_cosmetic_tag = RUS_socialism
							else = {
								set_cosmetic_tag = SOV
							}	
						}					
					}			
					else_if = {
						limit = {
							tag = URA
							has_cosmetic_tag = URA
						}
						set_cosmetic_tag = URA_communism
					}
					else_if = {
						limit = {
							tag = SIB								
						}
						if = {
							limit = {
								has_cosmetic_tag = SIB
							}
							set_cosmetic_tag = SIB_communism
						}			
						if = {
							limit = {
								has_cosmetic_tag = RUS_state																	
							}
							if = {
								limit = {
									has_country_flag = POLITCENTRE
								}
								set_cosmetic_tag = POLITCENTRE
								else_if = {
									limit = {
										has_country_flag = SIB_KOM_unification
									}						
									set_cosmetic_tag = RUS_state_communism
									else = {
										set_cosmetic_tag = SIB_communism
									}
								}
							}				
						}				
					}
					else_if = {
						limit = {
							tag = TRC
							has_cosmetic_tag = TRC
						}
						set_cosmetic_tag = TRC_communism
					}
					else_if = {
						limit = {
							tag = PRI
							OR = {
								has_cosmetic_tag = PRI
								has_cosmetic_tag = PRI_rozanov
							}	
						}
						set_cosmetic_tag = PRI_communism
					}
					else_if = {
						limit = {
							tag = STV
							has_cosmetic_tag = STV
						}
						set_cosmetic_tag = STV_communism
					}	
				}		
				else_if = {
					limit = {
						original_tag = DON
					}
					set_cosmetic_tag = DON_communism
				}
				else_if = {
					limit = {
						original_tag = ORE
					}
					set_cosmetic_tag = ORE_communism
				}
				else_if = {
					limit = {
						original_tag = CER
						NOT = {
							has_cosmetic_tag = CER_provisional_russia
							has_cosmetic_tag = CER_high_commission
						}
					}
					set_cosmetic_tag = CER_communism
				}
				else_if = {
					limit = {
						original_tag = KUB
						NOT = {
							has_cosmetic_tag = BSR_communism
							has_cosmetic_tag = KUB_north_caucasus_communism
							has_cosmetic_tag = KUB_communism
							has_cosmetic_tag = KUB_black_sea_communism
						}	
					}
					if = {
						limit = {
							has_cosmetic_tag = BSR
						}
						set_cosmetic_tag = BSR_communism
						else_if = {
							limit = {
								has_cosmetic_tag = KUB_north_caucasus
							}
							set_cosmetic_tag = KUB_north_caucasus_communism
							else = {
								set_cosmetic_tag = KUB_communism
							}
						}
					}
				}
				else_if = {
					limit = {
						original_tag = AMU
					}
					set_cosmetic_tag = AMU_communism
				}
				else_if = {
					limit = {
						original_tag = TER
					}
					set_cosmetic_tag = TER_communism
				}
				else_if = {
					limit = {
						original_tag = TBK
					}
					set_cosmetic_tag = TBK_communism
				}
				else_if = {
					limit = {
						original_tag = USS
					}
					set_cosmetic_tag = USS_communism
				}				
				else_if = {
					limit = {
						original_tag = FER
					}
					set_cosmetic_tag = FER_communism
				}
				else_if = {
					limit = {
						original_tag = UKR
					}
					if = {
						limit = {
							NOT = {
								tag = RUC
								tag = DKR
								has_cosmetic_tag = UKR_SOV_provisional
								has_cosmetic_tag = UKR_SOV
								has_cosmetic_tag = UKR_communism
							}
						}
						if = {
							limit = {
								NOT = {
									has_country_leader_ideology = vanguardism
								}	
							}
							set_cosmetic_tag = UKR_communism
							else = {
								set_cosmetic_tag = UKR_SOV
							}
						}		
					}
					else_if = {
						limit = {
							tag = RUC
						}
						if = {
							limit = {
								has_cosmetic_tag = RUC
							}
							set_cosmetic_tag = RUC_communism
							else_if = {
								limit = {
									has_cosmetic_tag = OSR
								}
								set_cosmetic_tag = OSR_communism
							}
						}	
					}
					else_if = {
						limit = {
							tag = DKR
						}
						set_cosmetic_tag = DKR_communism
					}
				}
				else_if = {
					limit = {
						original_tag = CRI
						NOT = {
							has_cosmetic_tag = CRI_taurida 
						}
					}
					set_cosmetic_tag = CRI_communism
				}
				else_if = {
					limit = {
						original_tag = FIN
						NOT = {
							has_cosmetic_tag = FIN_socialist
							has_cosmetic_tag = FIN_red
							has_cosmetic_tag = SOV_puppet
						}
					}
					set_cosmetic_tag = FIN_socialist
				}
				else_if = {
					limit = {
						original_tag = HUN
						NOT = {
							has_cosmetic_tag = HUN_socialism
						}
					}
					set_cosmetic_tag = HUN_socialism
				}
				else_if = {
					limit = {
						original_tag = BAY
						NOT = {
							has_cosmetic_tag = BAY_socialism
							has_cosmetic_tag = BAY_germany
						}
					}
					set_cosmetic_tag = BAY_socialism
				}
				else_if = {
					limit = {
						original_tag = USA
						NOT = {
							has_cosmetic_tag = USA_CSA_only_color
							has_cosmetic_tag = USA_CSA
							has_cosmetic_tag = USA_ancap
							has_cosmetic_tag = USA_theocratic
							has_cosmetic_tag = USA_REBEL
							has_cosmetic_tag = USA_republicans
							has_cosmetic_tag = USA_democrats
							has_cosmetic_tag = USA_1776
							has_cosmetic_tag = USA_NAU
						}
					}
					set_cosmetic_tag = USA_socialist_color_only
				}
				else_if = {
					limit = {
						OR = {
							original_tag = SLV
							original_tag = CRO
							original_tag = TRA
							original_tag = BOS
							original_tag = GAL
							original_tag = MOL
							original_tag = MNT
							original_tag = WUK
						}
						is_subject_of = HUN
						NOT = {
							has_cosmetic_tag = HUN_socialist_puppet
						}
					}
					set_cosmetic_tag = HUN_socialist_puppet
				}
				else_if = {
					limit = {
						OR = {
							original_tag = SLV
							is_constituent_of_germany = yes
						}
						OR = {
							is_subject_of = GER
							is_subject_of = BAY
						}
						NOT = {
							has_cosmetic_tag = GER_socialism
						}
					}
					set_cosmetic_tag = GER_socialism
				}
				else_if = {
					limit = {
						original_tag = POL
						has_country_leader = { character = POL_jozef_pilsudski ruling_only = yes }
					}
					POL_jozef_pilsudski = {
						set_portraits = {
							civilian = {
								large="gfx/leaders/POL/POL_jozef_pilsudski_socialist.png"
							}
						}
					}
				}
				else_if = {
					limit = {
						original_tag = ARM
						has_country_leader_ideology = vanguardism
					}
					set_cosmetic_tag = ARM_SOV
				}
				else_if = {
					limit = {
						has_cosmetic_tag = GEO_TSCN
					}
					set_cosmetic_tag = GEO_TSCN_communism
				}
				else_if = {
					limit = {
						original_tag = CZE
					}
					if = {
						limit = {
							has_cosmetic_tag = CZE_ONLY
						}
						set_cosmetic_tag = CZE_ONLY_communism
					}
					else = {
						set_cosmetic_tag = CZE_communism
					}
				}
				else_if = {
					limit = {
						original_tag = ROM
						NOT = {
							has_cosmetic_tag = WLC
						}	
					}
					set_cosmetic_tag = ROM_socialism
				}
				else_if = {
					limit = {
						original_tag = AUS	
					}
					if = {
						limit = {
							OR = {
								has_cosmetic_tag = AUH
								has_cosmetic_tag = AUH_conrad
							}			
						}
						set_cosmetic_tag = AUH_communism
						else_if = {
							limit = { 
								OR = {
									has_cosmetic_tag = AUR
									has_cosmetic_tag = AUR_vaterland
								}			
							}
							set_cosmetic_tag = AUR_communism
							else_if = {
								limit = { 
									has_cosmetic_tag = AUS_USGA			
								}
								set_cosmetic_tag = AUS_USGA_communism
								else_if = {
									limit = { 
										has_cosmetic_tag = AUS_HRE	
									}
									set_cosmetic_tag = AUS_HRE_communism
									else = {
										set_cosmetic_tag = AUS_communism
									}
								}
							}					
						}
					}			
				}
				else_if = {
					limit = {
						original_tag = SLO
					}
					set_cosmetic_tag = SLO_socialism
				}
				else_if= {
					limit = {
						original_tag = SER
					}
					if = {
						limit = {
							has_cosmetic_tag = YUG
						}
						set_cosmetic_tag = YUG_communism
					}
					else_if = {
						limit = {
							has_cosmetic_tag = SER_YUG
						}
						set_cosmetic_tag = SER_YUG_communism
					}
					else = {
						set_cosmetic_tag = SER_communism
					}
				}
				else_if = {
					limit = {
						original_tag = BUL
					}
					set_cosmetic_tag = BUL_socialism
				}
				else_if = {
					limit = {
						original_tag = BEL
					}
					if = {
						limit = {
							has_cosmetic_tag = BEL_netherlands_cosmetic_tag
						}
						set_cosmetic_tag = BEL_netherlands_cosmetic_tag_communism
						else_if = {
							limit = {
								has_cosmetic_tag = BEL_benelux_cosmetic_tag
							}
							set_cosmetic_tag = BEL_benelux_cosmetic_tag_communism
							else = {
								set_cosmetic_tag = BEL_communism
							}
						}
					}
				}
				else_if = {
					limit = {
						original_tag = HOL
					}
					set_cosmetic_tag = HOL_BAT
				}
				else_if = {
					limit = {
						original_tag = SPR
					}
					set_cosmetic_tag = SPR_socialism
				}
				else_if = {
					limit = {
						original_tag = GRE
						NOT = {
							has_cosmetic_tag = GRE_democratic
							has_cosmetic_tag = GRE_national_defense
							has_cosmetic_tag = GRE_balkan_federation
							has_cosmetic_tag = BYZ
							has_cosmetic_tag = GRE_TUR
						}
					}
					set_cosmetic_tag = GRE_communism
				}
				else_if = {
					limit = {
						original_tag = POR
					}
					set_cosmetic_tag = POR_socialism
				}
				else_if = {
					limit = {
						original_tag = SWE
					}
					if = {
						limit = {
							has_cosmetic_tag = SCA
						}
						set_cosmetic_tag = SCA_communism
					}
					else = {
						set_cosmetic_tag = SWE_socialism
					}
				}
				else_if = {
					limit = {
						original_tag = NOR
					}
					set_cosmetic_tag = NOR_socialism
				}
				else_if = {
					limit = {
						original_tag = DEN
					}
					set_cosmetic_tag = DEN_socialism
				}
				else_if = {
					limit = {
						original_tag = LUX
					}
					set_cosmetic_tag = GER_socialism
				}
				else_if = {
					limit = {
						original_tag = ALB
					}
					set_cosmetic_tag = ALB_socialism
				}
				else_if = {
					limit = {
						original_tag = KEN
						has_cosmetic_tag = KEN_colonial
					}
					drop_cosmetic_tag = yes	
					retire_ideology_leader = communism
					retire_ideology_leader = democratic
				}
				else_if = {
					limit = {
						original_tag = AZR
						has_cosmetic_tag = AZR_BAK
					}
					set_cosmetic_tag = AZR_BAK_communism
				}
				else_if = {
					limit = {
						OR = {
							original_tag = QIN
							original_tag = CHI
							has_country_flag = reunited_china
						}
						is_kuomintang_state = no
						OR = {
							has_country_leader_ideology = revolutionary_socialism
							has_country_leader_ideology = vanguardism
						}
						NOT = { has_country_flag = CHI_soviet_republic_flag }
					}
					set_cosmetic_tag = CSR
				}
				else_if = {
					limit = {
						is_chinese_warlord = yes
						NOT = {
							original_tag = QIN
							original_tag = CHI
							has_country_flag = reunited_china
						}
						is_kuomintang_state = no
						OR = {
							has_country_leader_ideology = revolutionary_socialism
							has_country_leader_ideology = vanguardism
						}
						NOT = { has_country_flag = CHI_soviet_republic_flag }
					}
					set_cosmetic_tag = CSR_color
				}
				else_if = {
					limit = {
						original_tag = MEX
						NOT = {
							has_cosmetic_tag = MCA
							has_cosmetic_tag = ZAP
							has_cosmetic_tag = ZAP_commune
							has_cosmetic_tag = MEX_ENG
						}
					}
					set_cosmetic_tag = MEX_communism
				}
				else_if = {
					limit = {
						OR = {
							original_tag = ANC
							original_tag = FNG
							original_tag = GDC
							original_tag = GXC
							original_tag = GZC
							original_tag = JNC
							original_tag = JXC
							original_tag = SCC
							original_tag = SDC
							original_tag = SHN
							original_tag = YUN
							original_tag = ZHE
						}
						OR = {
							has_cosmetic_tag = ANC_QIN
							has_cosmetic_tag = FNG_QIN
							has_cosmetic_tag = GDC_QIN
							has_cosmetic_tag = GXC_QIN
							has_cosmetic_tag = GZC_QIN
							has_cosmetic_tag = JNC_QIN
							has_cosmetic_tag = JXC_QIN
							has_cosmetic_tag = SCC_QIN
							has_cosmetic_tag = SDC_QIN
							has_cosmetic_tag = SHN_QIN
							has_cosmetic_tag = YUN_QIN
							has_cosmetic_tag = ZHE_QIN
						}
						OR = {
							is_qing_monarchy = no
							NOT = {
								is_in_faction_with = QIN
								any_allied_country = {
									is_qing_monarchy = yes
								}
							}
						}
					}
					drop_cosmetic_tag = yes
				}
				else_if = {
					limit = {
						OR = {
							original_tag = GXC
							original_tag = YUN
							original_tag = XSM
							original_tag = FNG
							original_tag = SIK
							original_tag = SCC
						}
						OR = {
							has_cosmetic_tag = GXC_KMT
							has_cosmetic_tag = YUN_KMT
							has_cosmetic_tag = XSM_KMT
							has_cosmetic_tag = FNG_KMT
							has_cosmetic_tag = SIK_KMT
							has_cosmetic_tag = SCC_KMT
						}
						is_kuomintang_state = no
					}
					drop_cosmetic_tag = yes
				}
				else_if = {
					limit = {
						original_tag = BRA
					}
					if = {
						limit = {
							has_cosmetic_tag = KPB_luso_brazilian_empire
						}
						set_cosmetic_tag = KPB_luso_brazilian_empire_communism	
						else = {
							set_cosmetic_tag = BRA_communism
						}
					}				
				}
				else_if = {
					limit = {
						original_tag = AST
					}
					if = {
						limit = {
							has_cosmetic_tag = AST_australasia
						}
						set_cosmetic_tag = AST_australasia_communism
					}
					else = {
						set_cosmetic_tag = AST_communism
					}
				}
			}
			else = {
				# limit = {
				# 	NOT = {
				# 		has_government = communism
				# 	}
				# }
				if = {
					limit = {
						OR = {
							AND = {
								NOT = { original_tag = GER}
								has_cosmetic_tag = GER_socialism
							}
							has_cosmetic_tag = FRA_socialism
							has_cosmetic_tag = FRA_socialism_not_commune
							has_cosmetic_tag = FRA_socialism_syndicalist
							has_cosmetic_tag = FRA_socialism_republic_of
							has_cosmetic_tag = FIN_socialist
							has_cosmetic_tag = FIN_red
							has_cosmetic_tag = SOV_puppet
							has_cosmetic_tag = TUR_SOC
							has_cosmetic_tag = BAY_socialism
							has_cosmetic_tag = LAT_iskolata
							has_cosmetic_tag = USA_socialist_color_only
							has_cosmetic_tag = USA_socialist
							has_cosmetic_tag = USB_socialist
							has_cosmetic_tag = HUN_socialism_puppet
							has_cosmetic_tag = UKR_communism
							has_cosmetic_tag = UKR_SOV
							has_cosmetic_tag = UKR_SOV_provisional
							has_cosmetic_tag = CZE_communism
							has_cosmetic_tag = CZE_ONLY_communism
							has_cosmetic_tag = SLO_socialism
							has_cosmetic_tag = SER_communism
							has_cosmetic_tag = SER_YUG_communism
							has_cosmetic_tag = YUG_communism
							has_cosmetic_tag = BUL_socialism
							has_cosmetic_tag = BEL_communism
							has_cosmetic_tag = BEL_netherlands_cosmetic_tag_communism
							has_cosmetic_tag = BEL_benelux_cosmetic_tag_communism
							has_cosmetic_tag = HOL_BAT
							has_cosmetic_tag = SPR_socialism
							has_cosmetic_tag = SWE_socialism
							has_cosmetic_tag = SCA_communism
							has_cosmetic_tag = NOR_socialism
							has_cosmetic_tag = DEN_socialism
							has_cosmetic_tag = ALB_socialism
							has_cosmetic_tag = ARM_SOV
							has_cosmetic_tag = DON_communism
							has_cosmetic_tag = ORE_communism
							has_cosmetic_tag = AMU_communism
							has_cosmetic_tag = USS_communism
							has_cosmetic_tag = FER_communism
							AND = {
								NOT = {
									has_government = democratic
								}
								has_cosmetic_tag = RUS_eser
							}
						}
					}
					drop_cosmetic_tag = yes
				}
				else_if = {
					limit = {
						original_tag = RUS
					}	
					if = {
						limit = {
							OR = {
								has_cosmetic_tag = RUS_socialism
								has_cosmetic_tag = SOV
							}
						}	
						if = {
							limit = {
								OR = {
									has_country_leader  = {
										character = RUS_nikolai_ii
										ruling_only  = no 
									}
									has_country_leader  = {
										character = RUS_mikhail_ii
										ruling_only  = no 
									}
									has_country_leader  = {
										character = RUS_nikolai_nikolaevich_romanov
										ruling_only  = no
									}
									has_country_leader = {
										character = RUS_kirill_vladimirovich_romanov
										ruling_only  = no 
									}	
									has_country_leader = {
										character = RUS_dmitriy_pavlovich_romanov
										ruling_only  = no 
									}
								}
							}
							set_cosmetic_tag = RUS
							else_if = {
								limit = {
									has_country_flag = RUS_federation
								}
								set_cosmetic_tag = RUS_federation
								else = {
									set_cosmetic_tag = RUS_republic
								}					
							}	
						}					
					}	
					if = {
						limit = {
							tag = URA
							has_cosmetic_tag = URA_communism
						}	
						set_cosmetic_tag = URA
					}
					if = {
						limit = {
							tag = SIB							
						}	
						if = {
							limit = {
								NOT = {
									has_cosmetic_tag = RUS_socialism
								}
								OR = {
									AND = {
										has_cosmetic_tag = POLITCENTRE
										NOT = {
											has_government = democratic
										}
									}
									has_cosmetic_tag = RUS_state_communism
									AND = {
										has_cosmetic_tag = SIB_communism
										has_country_flag = RUS_state
									}
								}																
							}
							set_cosmetic_tag = RUS_state
							else_if = {
								limit = { has_cosmetic_tag = SIB_communism }
								set_cosmetic_tag = SIB
							}
						}
					}
					else_if = {
						limit = {
							tag = TRC
							has_cosmetic_tag = TRC_communism
						}	
						set_cosmetic_tag = TRC
					}
					else_if = {
						limit = {
							tag = PRI
							has_cosmetic_tag = PRI_communism
						}	
						set_cosmetic_tag = PRI
					}
					else_if = {
						limit = {
							tag = STV
							has_cosmetic_tag = STV_communism
						}	
						set_cosmetic_tag = STV
					}	
				}
				else_if = {
					limit = {
						original_tag = KUB						
					}
					if = {
						limit = {
							has_cosmetic_tag = BSR_communism
						}
						set_cosmetic_tag = BSR
						else_if = {
							limit = {
								has_cosmetic_tag = KUB_north_caucasus_communism
							}
							set_cosmetic_tag = KUB_north_caucasus
							else = {
								set_cosmetic_tag = KUB
							}
						}
					}		
				}
				else_if = {
					limit = {
						tag = CER
						has_cosmetic_tag = CER_communism
					}	
					if = {
						limit = {
							CHI = {
								has_country_flag = xinhai_victory
							}
						}
						set_cosmetic_tag = CER_xinhai
						else = {
							drop_cosmetic_tag = yes
						}
					}				
				}
				else_if = {
					limit = {
						tag = TER
						has_cosmetic_tag = TER_communism
					}	
					if = {
						limit = {
							has_country_flag = TER_dagestan
						}	
						set_cosmetic_tag = TER_dagestan
						else = {
							drop_cosmetic_tag = yes
						}
					}	
				}
				else_if = {
					limit = {
						tag = RUC
					}
					if = {
						limit = {
							has_cosmetic_tag = RUC_communism
						}
						set_cosmetic_tag = RUC
						else_if = {
							limit = {
								has_cosmetic_tag = OSR_communism
							}
							set_cosmetic_tag = OSR
						}
					}	
				}
				else_if = {
					limit = {
						tag = DKR
					}
					set_cosmetic_tag = DKR
				}
				else_if = {
					limit = {
						original_tag = TBK
						has_cosmetic_tag = TBK_communism
					}
					if = {
						limit = {
							has_country_flag = TBK_okraina
						}
						set_cosmetic_tag = TBK_okraina
						else = {
							drop_cosmetic_tag = yes
						}
					}	
				}
				else_if = {
					limit = {
						original_tag = CRI
						OR = {					
							has_cosmetic_tag = CRI_taurida 
							has_cosmetic_tag = CRI_communism
						}	
					}	
					set_cosmetic_tag = CRI
				}
				else_if = {
					limit = {
						original_tag = ITA
						OR = {
							has_cosmetic_tag = ITA_socialism
							has_cosmetic_tag = SRI
						}
					}	
					if = {
						limit = {						
							OR = {
								has_country_leader  = {
									character = ITA_vittorio_emanuele_iii
									ruling_only  = no 
								}
								has_country_leader  = {
									character = ITA_umberto_ii
									ruling_only  = no 
								}
							}
						}
						drop_cosmetic_tag = yes
						else = {
							set_cosmetic_tag = ROI
						}				
					}				
				}
				else_if = {
					limit = {
						original_tag = FRA			
					}
					if = {
						limit = { has_subject = BLE }
						end_puppet = BLE
					}
					if = {
						limit = { has_cosmetic_tag = AEF_communism }
						set_cosmetic_tag = AEF
					}
					else_if = {
						limit = { has_cosmetic_tag = AOF_communism }
						set_cosmetic_tag = AOF
					}			
				}
				else_if = {
					limit = {
						original_tag = BEL
						has_country_leader  = {
							character = BEL_adalbert
							ruling_only  = no 
						}
						NOT = {
							has_cosmetic_tag = BEL_flanders_wallonia
						}						
					}
					set_cosmetic_tag = BEL_flanders_wallonia
				}
				else_if= {
					limit = {
						original_tag = POL
						has_country_leader = { character = POL_jozef_pilsudski ruling_only = yes }
					}
					POL_jozef_pilsudski = {
						set_portraits = {
							civilian = {
								large="gfx/leaders/POL/POL_jozef_pilsudski.png"
							}
						}
					}
				}
				else_if = {
					limit = {
						has_cosmetic_tag = GEO_TSCN_communism
					}
					set_cosmetic_tag = GEO_TSCN
				}
				else_if = {
					limit = {
						original_tag = GRE
						OR = {
							has_cosmetic_tag = GRE_communism
							has_cosmetic_tag = GRE_fascism
							has_cosmetic_tag = GRE_democratic
						}				
					}
					if = {
						limit = {
							is_greece_a_monarchy = no
						}
						set_cosmetic_tag = GRE_republic
						else = {
							set_cosmetic_tag = GRE
						}
					}			
				}
				else_if = {
					limit = {
						original_tag = POR
						has_cosmetic_tag = POR_socialism
					}
					if = {
						limit = {
							has_country_flag = portuguese_republic
						}
						set_cosmetic_tag = POR_REP
					}
					else = {
						drop_cosmetic_tag = yes
					}
				}
				else_if = {
					limit = {
						original_tag = AZR
						has_cosmetic_tag = AZR_BAK_communism
					}
					set_cosmetic_tag = AZR_BAK
				}
				else_if = {
					limit = {
						original_tag = MEX
						has_cosmetic_tag = MEX_communism
					}
					if = {
						limit = {
							has_country_flag = MXM
						}
						set_cosmetic_tag = MXM
						else_if = {
							limit = {
								has_country_flag = MXC
							}
							set_cosmetic_tag = MXC
							else_if = {
								limit = {
									has_country_flag = MEX_third_federal_republic
								}
								set_cosmetic_tag = MEX_third_federal_republic
								else = {
									set_cosmetic_tag = MEX
								}
							}
						}					
					}
				}
				else_if = {
					limit = {
						OR = {
							has_cosmetic_tag = CSR
							has_cosmetic_tag = CSR_color
						}
					}
					if = {
						limit = {
							has_country_flag = reunited_china
						}
						reunited_chinese_name = yes
					}
					else = {
						drop_cosmetic_tag = yes
					}
				}
				else_if = {
					limit = {
						original_tag = BRA
					}	
					if = {
						limit = {
							has_cosmetic_tag = BRA_communism
						}
						if = {
							limit = {
								has_country_flag = vargas_era
							}
							set_cosmetic_tag = BRA_vargas
							else = {
								drop_cosmetic_tag = yes
							}
						}
					}
					if = {
						limit = {
							has_cosmetic_tag = KPB_luso_brazilian_empire_communism
						}
						set_cosmetic_tag = KPB_luso_brazilian_empire
					}
				}
				else_if = {
					limit = {
						original_tag = GRE						
					}
					if = {
						limit = {
							has_cosmetic_tag = GRE_republic
							is_greece_a_monarchy = yes
						}
						set_cosmetic_tag = GRE
					}
					if = {
						limit = {
							is_greece_a_monarchy = no
							NOT = {
								has_cosmetic_tag = GRE_national_defense
								has_cosmetic_tag = GRE_balkan_federation
								has_cosmetic_tag = BYZ
								has_cosmetic_tag = GRE_TUR
							}
						}
						set_cosmetic_tag = GRE_republic
					}
				}
				else_if = {
					limit = {
						original_tag = AST
					}
					if = {
						limit = {
							has_cosmetic_tag = AST_australasia_communism
						}
						set_cosmetic_tag = AST_australasia
					}
					else_if = {
						limit = {
							has_cosmetic_tag = AST_communism
						}
						drop_cosmetic_tag = yes
					}
				}
				else_if = {
					limit = {
						original_tag = ROM
						has_cosmetic_tag = ROM_socialism
					}	
					if = {
						limit = {						
							has_country_flag = ROM_collaborationist_tag
							has_civil_war = yes
						}
						set_cosmetic_tag = RMC
						else = {
							set_cosmetic_tag = ROM
						}				
					}				
				}
				else_if = {
					limit = {
						original_tag = AUS	
					}
					if = {
						limit = {
							has_cosmetic_tag = AUH_communism		
						}
						set_cosmetic_tag = AUH
						else_if = {
							limit = { 
								has_cosmetic_tag = AUR_communism		
							}
							set_cosmetic_tag = AUR
							else_if = {
								limit = { 
									has_cosmetic_tag = AUS_USGA_communism			
								}
								set_cosmetic_tag = AUS_USGA
								else_if = {
									limit = { 
										has_cosmetic_tag = AUS_HRE_communism	
									}
									set_cosmetic_tag = AUS_HRE
									else_if = {
										limit = {
											has_cosmetic_tag = AUS_communism
										}
										drop_cosmetic_tag = yes
									}
								}
							}				
						}
					}			
				}
				else_if = {
					limit = {
						original_tag = HUN		
						has_cosmetic_tag = HUN_socialism			
					}
					if = {
						limit = {
							has_country_flag = HUN_republic
						}
						set_cosmetic_tag = HUN_republic
						else_if = {
							limit = {
								has_country_flag = HUN_archkingdom
							}
							set_cosmetic_tag = HUN_archkingdom
							else = {
								drop_cosmetic_tag = yes
							}
						}	
					}				
				}
				else_if = {
					limit = {
						original_tag = GER
					}	
					if = {
						limit = {
							OR = {
								has_cosmetic_tag = GER_socialism
								has_cosmetic_tag = GER_ruhr_revolt
							}		
						}
						if = {
							limit = {
								is_GER_a_monarchy = yes
							}
							drop_cosmetic_tag = yes
							else = {
								set_cosmetic_tag = GER_republic
							}
						}
					}
					if = {
						limit = {
							has_cosmetic_tag = KPB_luso_brazilian_empire_communism
						}
						set_cosmetic_tag = KPB_luso_brazilian_empire
					}
				}
			}
			if = {
				limit = {
					has_government = fascism
				}
				if = {
					limit = {
						original_tag = FRA
						NOT = {
							has_cosmetic_tag = FRA_proto_fascism
							has_cosmetic_tag = NFA
							has_cosmetic_tag = FRA_THIRD_EMPIRE		
							has_country_flag = AEF
							has_country_flag = AOF			
						}
					}
					set_cosmetic_tag = FRA_proto_fascism
				}
				else_if = {
					limit = {
						original_tag = JAP
						NOT = {
							has_cosmetic_tag = JAP_KOR_original
							has_cosmetic_tag = JAP_KOR_social					
						}
					}
					set_cosmetic_tag = JAP_fascism_color
				}
				else_if = {
					limit = {
						tag = BEL
						is_subject_of = FRA
						NOT = {
							has_cosmetic_tag = COG_belgium_in_exile
						}	
					}
					BEL_jules_jacques_de_dixmude = {
						promote_leader = yes
						add_country_leader_role = {
							country_leader = {
								ideology = stratocracy
								traits = { ENG_haig_the_butcher war_industrialist }
							}
						}
						promote_character = stratocracy
					}
					set_party_name = {
						ideology = fascism 
						name = BEL_army_party
						long_name = BEL_army_party
					}	
					set_cosmetic_tag = BEL_neutrality 
				}
				else_if = {
					limit = {
						original_tag = KEN
					}
					set_cosmetic_tag = KEN_colonial				
				}
				else_if = {
					limit = {
						original_tag = GRE
						NOT = {
							has_cosmetic_tag = GRE_national_defense
							has_cosmetic_tag = GRE_balkan_federation	
							has_cosmetic_tag = BYZ	
							has_cosmetic_tag = GRE_TUR	
						}
					}
					set_cosmetic_tag = GRE_fascism
				}
				else_if = {
					limit = {
						tag = PRI
						OR = {
							has_cosmetic_tag = PRI
							has_cosmetic_tag = PRI_communism
						}	
						has_country_leader = {
							character = RUS_sergey_rozanov
						}
					}
					set_cosmetic_tag = PRI_rozanov
				}
				else_if = {
					limit = {
						original_tag = SAF
					}
					set_cosmetic_tag = SAF_fascism 
				}
				else_if = {
					limit = {
						original_tag = AUS					
					}	
					if = {
						limit = {
							has_cosmetic_tag = AUR
							has_country_flag = AUR_vaterland		
						}
						set_cosmetic_tag = AUR_vaterland
						else_if = {
							limit = {
								has_cosmetic_tag = AUH
								has_country_flag = AUH_conrad
							}
							set_cosmetic_tag = AUH_conrad
						}	
					}
				}
				else_if = {
					limit = {
						original_tag = GER
					}	
					if = {
						limit = {
							OR = {
								has_cosmetic_tag = GER_republic
								has_country_flag = GER_provisional
							}			
						}
						drop_cosmetic_tag = yes
						else_if = {
							limit = {
								has_country_leader_ideology = nazism
							}
							set_cosmetic_tag = GER_nazi
						}
					}
				}
			}
			else = {
				# limit = {
				# 	NOT = {
				# 		has_government = fascism
				# 	}
				# }
				if = {
					limit = {
						OR = {
							has_cosmetic_tag = FRA_proto_fascism
							has_cosmetic_tag = BUL_neutrality
							has_cosmetic_tag = JAP_fascism_color
						}
					}
					drop_cosmetic_tag = yes
				}
				else_if = {
					limit = {
						tag = BEL
						has_cosmetic_tag = BEL_neutrality
					}
					drop_cosmetic_tag = yes
					BEL_august_borms = {
						promote_character = nazism
					}						
					set_party_name = {
						ideology = fascism 
						name = BEL_fascism_party
						long_name = BEL_fascism_party
					}				
				}
				else_if = {
					limit = {
						tag = PRI
						has_cosmetic_tag = PRI_rozanov
					}
					set_cosmetic_tag = PRI
				}
				else_if = {
					limit = {
						original_tag = SAF
						has_cosmetic_tag = SAF_fascism
					}
					if = {
						limit = {
							has_country_flag = SAF_ENG
						}
						set_cosmetic_tag = SAF_ENG
						else_if = {
							limit = {
								has_country_flag = SAF_1912
							}
							set_cosmetic_tag = SAF_1912
							else_if = {
								limit = {
									has_country_flag = SAF_1928
								}
								set_cosmetic_tag = SAF_1928	
								else = {
									drop_cosmetic_tag = yes
								}
							}						
						}
					}
				}
				else_if = {
					limit = {
						original_tag = GER
						has_cosmetic_tag = GER_nazi
					}	
					if = {
						limit = {
							is_GER_a_monarchy = yes
						}
						drop_cosmetic_tag = yes
						else_if = {
							limit = {
								NOT = {
									has_government = communism
								}
							}
							set_cosmetic_tag = GER_republic
						}
					}
				}
			}								
			if = {
				limit = {
					has_government = democratic
				}
				if = {
					limit = {
						original_tag = KEN
						has_cosmetic_tag = KEN_colonial
					}
					drop_cosmetic_tag = yes
					retire_ideology_leader = democratic
					retire_ideology_leader = communism
				}
			}
			if = {
				limit = {
					has_government = neutrality
				}
				if = {
					limit = {
						original_tag = KEN
					}
					set_cosmetic_tag = KEN_colonial			
				}
				else_if = {
					limit = {
						original_tag = GER
						is_GER_a_monarchy = yes
						OR = {
							has_cosmetic_tag = GER_republic
							has_cosmetic_tag = GER_provisional
						}
					}
					drop_cosmetic_tag = yes	
				}
			}
			if = {
				limit = {
					OR = {
						original_tag = RUS
						original_tag = SIA
					}					
				}
				if = {
					limit = {
						OR = {
							is_russia_a_monarchy = no
							SIA = {
								NOT = {
									has_government = neutrality
								}	
							}	
						}					
					}
					RUS = {
						diplomatic_relation = {
							country = SIA
							relation = guarantee
							active = no
						}
						remove_opinion_modifier = {
							target = SIA
							modifier = personal_friendship
						}	
					}
					SIA = {
						remove_opinion_modifier = {
							target = RUS
							modifier = personal_friendship
						}					
					}	
				}
				else = {
					RUS = {
						diplomatic_relation = {
							country = SIA
							relation = guarantee
							active = yes
						}
						add_opinion_modifier = {
							target = SIA
							modifier = personal_friendship
						}
					}	
					SIA = {
						add_opinion_modifier = {
							target = RUS
							modifier = personal_friendship
						}
					}
				}
			}
			if = {
				limit = {
					OR = {
						has_focus_tree = generic_focus
						has_focus_tree = white_guard_focus
					}	
				}
				mark_focus_tree_layout_dirty = yes
			}
			if = {
				limit = {
					is_in_faction = yes
					has_war = no			
					OR = {
						has_autonomy_state = autonomy_tgwr_protectorate
						has_autonomy_state = autonomy_tgwr_informal_protectorate
						has_autonomy_state = autonomy_tgwr_ottoman_emirate
						has_autonomy_state = autonomy_tgwr_concession
					}					
				}
				leave_faction = yes
				OVERLORD = {
					diplomatic_relation = {
						country = PREV
						relation = military_access
						active = yes
					}
				}
			}
			log = "[GetDateText]: [ROOT.GetName] has changed ruling party from [ROOT.old_ideology_token] to [ROOT.GetRulingIdeologyName]"
		}
	}
	on_join_faction = {
		effect = {
			if = {
				limit = {
					original_tag = BEL
					has_war = no
					NOT = {
						is_in_faction_with = ENG
						ENG = {
							has_completed_focus = ENG_Pax_Britannica
						}
					}
				}
				ENG = {
					country_event = ww1_england.165
				}
			}
			if = {
				limit = {
					original_tag = ANC
					faction_leader = {
						is_qing_monarchy = yes
					}
					is_kuomintang_state = no
					NOT = {
						has_government = communism
						has_country_flag = reunited_china
					}
				}
				set_cosmetic_tag = ANC_QIN
			}
			if = {
				limit = {
					original_tag = FNG
					faction_leader = {
						is_qing_monarchy = yes
					}
					is_kuomintang_state = no
					NOT = {
						has_government = communism
						has_country_flag = reunited_china
					}
				}
				set_cosmetic_tag = FNG_QIN
			}
			if = {
				limit = {
					original_tag = GDC
					faction_leader = {
						is_qing_monarchy = yes
					}
					is_kuomintang_state = no
					NOT = {
						has_government = communism
						has_country_flag = reunited_china
					}
				}
				set_cosmetic_tag = GDC_QIN
			}
			if = {
				limit = {
					original_tag = GXC
					faction_leader = {
						is_qing_monarchy = yes
					}
					is_kuomintang_state = no
					NOT = {
						has_government = communism
						has_country_flag = reunited_china
					}
				}
				set_cosmetic_tag = GXC_QIN
			}
			if = {
				limit = {
					original_tag = GZC
					faction_leader = {
						is_qing_monarchy = yes
					}
					is_kuomintang_state = no
					NOT = {
						has_government = communism
						has_country_flag = reunited_china
					}
				}
				set_cosmetic_tag = GZC_QIN
			}
			if = {
				limit = {
					original_tag = JNC
					faction_leader = {
						is_qing_monarchy = yes
					}
					is_kuomintang_state = no
					NOT = {
						has_government = communism
						has_country_flag = reunited_china
					}
				}
				set_cosmetic_tag = JNC_QIN
			}
			if = {
				limit = {
					original_tag = JXC
					faction_leader = {
						is_qing_monarchy = yes
					}
					is_kuomintang_state = no
					NOT = {
						has_government = communism
						has_country_flag = reunited_china
					}
				}
				set_cosmetic_tag = JXC_QIN
			}
			if = {
				limit = {
					original_tag = SCC
					faction_leader = {
						is_qing_monarchy = yes
					}
					is_kuomintang_state = no
					NOT = {
						has_government = communism
						has_country_flag = reunited_china
					}
				}
				set_cosmetic_tag = SCC_QIN
			}
			if = {
				limit = {
					original_tag = SDC
					faction_leader = {
						is_qing_monarchy = yes
					}
					is_kuomintang_state = no
					NOT = {
						has_government = communism
						has_country_flag = reunited_china
					}
				}
				set_cosmetic_tag = SDC_QIN
			}
			if = {
				limit = {
					original_tag = SHN
					faction_leader = {
						is_qing_monarchy = yes
					}
					is_kuomintang_state = no
					NOT = {
						has_government = communism
						has_country_flag = reunited_china
					}
				}
				set_cosmetic_tag = SHN_QIN
			}
			if = {
				limit = {
					original_tag = YUN
					faction_leader = {
						is_qing_monarchy = yes
					}
					is_kuomintang_state = no
					NOT = {
						has_government = communism
						has_country_flag = reunited_china
					}
				}
				set_cosmetic_tag = YUN_QIN
			}
			if = {
				limit = {
					original_tag = ZHE
					faction_leader = {
						is_qing_monarchy = yes
					}
					is_kuomintang_state = no
					NOT = {
						has_government = communism
						has_country_flag = reunited_china
					}
				}
				set_cosmetic_tag = ZHE_QIN
			}
			if = {
				limit = {
					original_tag = XSM
					faction_leader = {
						is_qing_monarchy = yes
					}
					is_kuomintang_state = no
					NOT = {
						has_government = communism
						has_country_flag = reunited_china
					}
				}
				set_cosmetic_tag = XSM_QIN
			}
			if = {
				limit = {
					tag = TUR
					is_subject = no		
					NOT = { has_global_flag = great_war_ends }			
				}
				if = {
					limit = { FROM = { tag = GER } }
					news_event = { id = kis_news.112 hours = 1 }
				}
				else_if = {
					limit = { FROM = { tag = FRA } }
					news_event = { id = kis_news.113 hours = 1 }
				}			
			}
			every_subject_country = {
				limit = {
					has_war = no
					OR = {
						has_autonomy_state = autonomy_tgwr_protectorate
						has_autonomy_state = autonomy_tgwr_informal_protectorate
						has_autonomy_state = autonomy_tgwr_ottoman_emirate
						has_autonomy_state = autonomy_tgwr_concession
					}
				}
				leave_faction = yes
				OVERLORD = {
					diplomatic_relation = {
						country = PREV
						relation = military_access
						active = yes
					}
				}
				country_event = { id = ww1_political.7 hours = 1 } #needed if the faction leader is at war, don't ask
			}
			log = "[GetDateText]: [ROOT.GetName] has joined [FROM.GetFactionName] which leader is [FROM.GetName]"
		}
	}
	on_leave_faction = {
		effect = {
			if = {
				limit = {
					OR = {
						original_tag = ANC
						original_tag = FNG
						original_tag = GDC
						original_tag = GXC
						original_tag = GZC
						original_tag = JNC
						original_tag = JXC
						original_tag = SCC
						original_tag = SDC
						original_tag = SHN
						original_tag = YUN
						original_tag = ZHE
						original_tag = XSM
					}
					OR = {
						has_cosmetic_tag = ANC_QIN
						has_cosmetic_tag = FNG_QIN
						has_cosmetic_tag = GDC_QIN
						has_cosmetic_tag = GXC_QIN
						has_cosmetic_tag = GZC_QIN
						has_cosmetic_tag = JNC_QIN
						has_cosmetic_tag = JXC_QIN
						has_cosmetic_tag = SCC_QIN
						has_cosmetic_tag = SDC_QIN
						has_cosmetic_tag = SHN_QIN
						has_cosmetic_tag = YUN_QIN
						has_cosmetic_tag = ZHE_QIN
						has_cosmetic_tag = XSM_QIN
					}
					OR = {
						is_qing_monarchy = no
						NOT = {
							is_in_faction_with = QIN
							any_allied_country = {
								is_qing_monarchy = yes
							}
						}
					}
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					has_country_flag = entente_leader
					is_great_war_ongoing = yes
				}
				clr_country_flag = entente_leader
				FROM = {
					set_country_flag = entente_leader
				}
			}
			log = "[GetDateText]: [ROOT.GetName] has left [FROM.GetFactionName] which leader is [FROM.GetName]"
		}
	}
	on_war = {
		effect = {
			# Check for puppets at war with their overlord
			if = {
				limit = {
					is_subject = yes
					any_enemy_country = {
						has_subject = ROOT
					}
				}
				overlord = {
					set_autonomy = {
						target = ROOT
						autonomy_state = autonomy_free
					}
				}
			}
			if = {
				limit = {
					tag = RUS
					has_country_leader = {
						character = RUS_nikolai_ii
						ruling_only = yes
					}
					any_enemy_country = {
						OR = {
							is_major = yes
							original_tag = RUS
						}
					}
					RUS_nikolai_ii = {
						NOT = {
							has_character_flag = RUS_nicholas_romanov_dictator
							has_character_flag = RUS_nicholas_romanov_democratic
						}
					}
				}
				RUS_nikolai_ii = {
					set_portraits = {
						civilian = {
							large="gfx/leaders/RUS/RUS_nicholas_romanov_war.png"
						}
					}
				}				
			}
			if = {
				limit = {
					tag = RUS
					has_war_with = FRA
					has_idea = free_trade
					FRA = {
						NOT = {
							has_country_flag = great_war_loser
						}
						is_major = yes
					}
				}
				swap_ideas = {
					remove_idea = free_trade
					add_idea = export_focus
				}
			}
			if = {
				limit = {
					tag = GER
					has_war_with = ENG
					has_idea = free_trade
					ENG = {
						NOT = {
							has_country_flag = great_war_loser
						}
						is_major = yes
					}
				}
				swap_ideas = {
					remove_idea = free_trade
					add_idea = export_focus
				}
			}
			if = {
				limit = {
					tag = BUL
					has_country_flag = lozengradska_operacija
					NOT = {
						has_idea = BUL_idea_lozengradska_operacija
					}
					has_war_with = TUR
				}
				clr_country_flag = lozengradska_operacija
				add_ideas = BUL_idea_lozengradska_operacija
			}
			country_event = ww1_firstbalkan.100 #adding major status during war
			if = {
				limit = {
					NOT = {
						has_global_flag = GER_capitulation
						has_global_flag = FRA_capitulation
						has_global_flag = FRA_capitulation_alone
						has_global_flag = great_war_ends
					}
					any_enemy_country = {
						is_major = yes
					}
					ENG = {
						OR = {
							is_in_faction_with = ROOT
							has_guaranteed = ROOT
						}
						is_subject = no
						has_war_with_major = no
						NOT = {
							has_idea = ENG_idea_not_ready_yet
						}
					}
				}
				ENG = {
					add_timed_idea = {
						idea = ENG_idea_not_ready_yet
						days = 100
					}
				}
			}
		}
	}
	on_war_relation_added = {
		effect = {
			# Great War
			if = {
				limit = {
					NOT = {
						has_global_flag = great_war
					}
					OR = {
						AND = {
							ROOT = { original_tag = GER }
							FROM = {
								OR = {
									original_tag = RUS
									original_tag = ENG
									original_tag = FRA
								}
							}						
						}
						AND = {
							FROM = { original_tag = GER }
							ROOT = {
								OR = {
									original_tag = RUS
									original_tag = ENG
									original_tag = FRA
								}
							}	
						}
					}
				}
				set_global_flag = great_war
				ROOT = {
					news_event = kis_news.1
				}
				GER = {
					country_event = ww1_germanrework.40
					country_event = { id = ww1_germanrework.49 days = 7 }
				}
			}
			# Check for puppets at war with their overlord
			if = {
				limit = {
					is_subject = yes
					any_enemy_country = {
						has_subject = ROOT
					}
				}
				overlord = {
					set_autonomy = {
						target = ROOT
						autonomy_state = autonomy_free
					}
				}
			}
			if = {
				limit = {
					OR = {
						AND = {
							FROM = { original_tag = BUL }
							ROOT = { original_tag = ROM }
						}
						AND = {
							FROM = { original_tag = ROM }
							ROOT = { original_tag = BUL }
						}
					}
				}
				ROM = { set_country_flag = ROM_has_had_war_with_BUL }
			}
			if = {
				limit = {
					OR = {
						AND = {
							FROM = { original_tag = TUR }
							ROOT = { original_tag = ROM }
						}
						AND = {
							FROM = { original_tag = ROM }
							ROOT = { original_tag = TUR }
						}
					}
				}
				ROM = { set_country_flag = ROM_has_had_war_with_TUR }
			}
			if = {
				limit = {
					OR = {
						AND = {
							FROM = { original_tag = SER }
							ROOT = { original_tag = ROM }
						}
						AND = {
							FROM = { original_tag = ROM }
							ROOT = { original_tag = SER }
						}
					}
				}
				ROM = { set_country_flag = ROM_has_had_war_with_SER }
			}
			if = {
				limit = {
					OR = {
						AND = {
							FROM = { original_tag = MNT }
							ROOT = { original_tag = ROM }
						}
						AND = {
							FROM = { original_tag = ROM }
							ROOT = { original_tag = MNT }
						}
					}
				}
				ROM = { set_country_flag = ROM_has_had_war_with_MNT }
			}
			if = {
				limit = {
					OR = {
						AND = {
							FROM = { original_tag = GRE }
							ROOT = { original_tag = ROM }
						}
						AND = {
							FROM = { original_tag = ROM }
							ROOT = { original_tag = GRE }
						}
					}
				}
				ROM = { set_country_flag = ROM_has_had_war_with_GRE }
			}
			if = {
				limit = {
					FROM = {
						original_tag = LUX
						is_subject = no
						has_idea = LUX_london_treaty
						NOT = {
							has_government = communism
						}	
					}
					ROOT = { 
						original_tag = GER
						is_subject = no
						NOT = {
							has_government = communism
						}
					}
					has_global_flag = great_war
					NOT = {
						has_global_flag = luxembourg_submitted
						has_global_flag = GER_capitulation
						has_global_flag = FRA_capitulation
					}			
				}			
				ROOT = {
					LUX = { 
						country_event = { id = ww1_luxembourg.5 days = 1 } 
					}
				}
					
			}
			log = "[GetDateText]: [ROOT.GetName] has entered a state of war with [FROM.GetName]"
		}
	}	
	on_declare_war = {
		effect = {
			#Germany has started a war - allies should try to contain Germany
			if = {
				limit = {
					ROOT = {
						TAG = GER
					}
					NOT = {
						has_global_flag = GER_has_started_war
					}
				}
				set_global_flag = GER_has_started_war
			}
			#if France and UK are not in faction but just in defensive pact, France can just join anyway to fuck germans
			if = {
				limit = {
					ROOT = {
						tag = ENG
						is_guaranteed_by = FRA
					}
					FROM = {
						tag = GER
					}
					FRA = {
						has_war_with_major = no
					}
				}
				FRA = {
					country_event = {
						id = ww1_france.625
						days = 7
					}
				}
			}
			#same if Russia attack germany : UK can join despite just being in defensive pact
			if = {
				limit = {
					ROOT = {
						tag = RUS
						OR = {
							is_guaranteed_by = ENG
							any_allied_country = {
								is_guaranteed_by = ENG
							}
						}
					}
					FROM = {
						tag = GER
					}
					ENG = {
						has_war_with_major = no
					}
				}
				ENG = {
					country_event = {
						id = ww1_england.276
						days = 14
					}
				}
			}
			#finaly if France attack germany and is not in faction with UK
			if = {
				limit = {
					ROOT = {
						tag = FRA
						OR = {
							is_guaranteed_by = ENG
							any_allied_country = {
								is_guaranteed_by = ENG
							}
						}
					}
					FROM = {
						tag = GER
					}
					ENG = {
						has_war_with_major = no
					}
				}
				ENG = {
					country_event = {
						id = ww1_england.278
						days = 14
					}
				}
			}
			if = {
				limit = {
					ROOT = {
						tag = SER
					}
					FROM = {
						tag = AUS
					}	
					has_global_flag = brothers_war
					NOT = {
						has_global_flag = brothers_war_end
					}
					BOS = {
						has_war_with = AUS
					}
				}
				hidden_effect = {
					SER = {
						country_event = ww1_bruderkrieg.18
					}
				}
			}
			if = {
				limit = {
					ROOT = {
						OR = {
							tag = FRA
							tag = IND
						}
						has_country_flag = FRA_war_on_hainan_flag
					}
					FROM = {
						owns_state = 591
					}
				}
				set_global_flag = FRA_IND_CHI_hainan_war
				news_event = ww1_france.460
			}
			if = {
				limit = {
					ROOT = {
						tag = ENG
					}
					FROM = {
						tag = DEN
					}
					NOT = { GER = { is_in_faction_with = DEN } }
				}
				GER = {
					country_event = { id = ww1_england.232 hours = 3 }
				}
			}
			if = {
				limit = {
					tag = BUL
					has_global_flag = balkan_league_fail
					NOT = {
						has_global_flag = great_war
						is_in_faction_with = SER
						is_in_faction_with = GRE
						is_in_faction_with = MNT
					}
					FROM = {
						tag = TUR
						NOT = {
							has_war_with = SER
							has_global_flag = kis_firstbalkanwar_victory
						}
					}
				}
				news_event = {
					id = ww1_firstbalkan.116
					hours = 3
				}
			}
		}
	}
	on_offer_join_faction = {
		effect = {
			FROM = {
				country_event = ww1_firstbalkan.101 #disable BL major status
			}
			FROM = {			
				every_subject_country = {
					limit = {
						has_war = no
						OR = {
							has_autonomy_state = autonomy_tgwr_protectorate
							has_autonomy_state = autonomy_tgwr_informal_protectorate
							has_autonomy_state = autonomy_tgwr_ottoman_emirate
							has_autonomy_state = autonomy_tgwr_concession
						}
					}
					OVERLORD = {
						diplomatic_relation = {
							country = PREV
							relation = military_access
							active = yes
						}
					}
					country_event = { id = ww1_political.7 hours = 1 } #needed if the faction leader is at war, don't ask
				}
			}		
			if = {
				limit = {
					FROM = {
						tag = TUR
						is_subject = no
					}		
					NOT = { has_global_flag = great_war_ends }			
				}
				if = {
					limit = { ROOT = { tag = GER } }
					news_event = { id = kis_news.112 hours = 1 }
				}
				else_if = {
					limit = { ROOT = { tag = FRA } }
					news_event = { id = kis_news.113 hours = 1 }
				}			
			}
			log = "[GetDateText]: [ROOT.GetName] has been offered to join [FROM.GetFactionName] which leader is [FROM.GetName]"
		}
	}	
	
	#ROOT is new controller #FROM is old controller #FROM.FROM is state ID
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					FROM.FROM = { state = 2 }					
				}
				if = {
					limit = {
						ROOT = {			
							original_tag = ITA
							NOT = {
								has_idea = ITA_roman_question
								has_country_flag = pope_killed 
							}
						}
					}	
					ROOT = { add_ideas = ITA_roman_question }
				}
				if = {
					limit = {
						FROM = {				
							original_tag = ITA
							has_idea = ITA_roman_question
						}
					}	
					FROM = { remove_ideas = ITA_roman_question }
				}
			}
			#Bulgaria get Solun
			if = {
				limit = {
					FROM.FROM = {
						state = 345
					}				
				}
				if = {
					limit = {
						ROOT = {
							original_tag = BUL
						}
						FROM = {
							original_tag = TUR
							owns_state = 345
						}
						OR = {
							BUL = {
								OR = {
									is_ai = no
									has_completed_focus = BUL_lone_liberator
								}	
							}
							GRE = {
								is_ai = no
							}
							is_historical_focus_on = no
						}
						has_global_flag = kis_firstbalkan_war
						NOT = {
							has_global_flag = kis_firstbalkanwar_victory
						}
					}
					set_global_flag = bulgarian_solun
				}
			}
			if = {
				limit = {
					tag = GER
					has_country_flag = germany_war_return_kaiser
					has_government = neutrality
					FROM = {
						original_tag = HOL
						has_country_flag = netherlands_refused_return_kaiser
					}
					OR = {
						7 = { is_controlled_by = GER }
						HOL = { is_subject_of = GER }
					}
				}
				country_event = { id = wtt_germany.6 }
			}
			if = {
				limit = {
					FROM.FROM = { state = 608 }
				}
				if = {
					limit = {
						ROOT = {
							is_china_or_warlord = yes
						}
					}
					if = {
						limit = {
							is_qing_monarchy = no
							has_global_flag = abdicated_qing_imperial_family_allowed
							NOT = {
								has_global_flag = abdicated_qing_imperial_family_banned
								has_idea = QIN_abdicated_qing_imperial_family
							}
						}
						add_ideas = QIN_abdicated_qing_imperial_family
					}
				}
				if = {
					limit = {
						ROOT = {
							original_tag = CHI
							598 = {
								is_owned_by = PREV
							}
							608 = {
								is_owned_by = PREV
								is_capital = no
							}
							OR = {
								has_idea = CHI_idea_beiyang_government
								has_idea = CHI_idea_beiyang_government2
							}
						}
					}
					ROOT = {
						set_capital = { state = 608 }
					}
				}
			}
			if = {
				limit = {
					FROM.FROM = { state = 2 }
				}
				if = {
					limit = {
						ROOT = {
							original_tag = ITA
						}
					}
					if = {
						limit = {
							NOT = {
								has_global_flag = ITA_lateran_treaty
								has_war_with = PAP
								has_idea = ITA_lateran_treaty
								has_idea = ITA_roman_question
							}
							OR = {
								PAP = { has_idea = PAP_captivus_vaticani }
								NOT = { country_exists = PAP }
							}
						}
						add_ideas = ITA_roman_question
					}
					if = {
						limit = {
							NOT = {
								has_war_with = PAP
								has_idea = ITA_lateran_treaty
								has_idea = ITA_roman_question
							}
							has_global_flag = ITA_lateran_treaty
							is_neighbor_of = PAP
						}
						add_ideas = ITA_lateran_treaty
					}
				}
			}
			# Transcaucasia autonomies
			if = {
				limit = {
					ROOT = {
						OR = {
							NOT = {
								has_cosmetic_tag = GEO_TSCN
								has_cosmetic_tag = GEO_TSCN_commissariat
								has_cosmetic_tag = GEO_TSCN_communism
								has_cosmetic_tag = GEO_TSCN_committee
							}
							FROM.FROM = {
								is_core_of = ROOT
							}
						}
					}
					FROM.FROM = {
						has_dynamic_modifier = { modifier = GEO_transcaucasia_modifier }
					}
				}
				FROM.FROM = {
					remove_dynamic_modifier = { modifier = GEO_transcaucasia_modifier }
				}
			}
			if = {
				limit = {
					ROOT = {
						OR = {
							has_cosmetic_tag = GEO_TSCN
							has_cosmetic_tag = GEO_TSCN_commissariat
							has_cosmetic_tag = GEO_TSCN_communism
							has_cosmetic_tag = GEO_TSCN_committee
						}
					}
					FROM.FROM = {
						NOT = { is_core_of = ROOT }
						OR = {
							is_core_of = AZR
							is_core_of = ARM
						}
					}
				}
				FROM.FROM = {
					add_dynamic_modifier = { modifier = GEO_transcaucasia_modifier }
				}
			}
			# China minority modifiers
			if = {
				limit = {
					ROOT = {
						is_china_or_warlord_no_tt = yes
					}
					FROM.FROM = {
						is_core_of = ROOT
					}
				}
				FROM.FROM = {
					if = {
						limit = {					
							region = 115
							NOT = {
								has_dynamic_modifier = {
									modifier = mongolian_banners_modifier
								}
								has_dynamic_modifier = {
									modifier = gando_modifier
								}
							}
						}
						add_dynamic_modifier = {
							modifier = mongolian_banners_modifier
						}
					}	
					else_if = {
						limit = {
							is_core_of = MON
							NOT = {
								has_dynamic_modifier = {
									modifier = xinjiang_modifier
								}
							}	
						}
						add_dynamic_modifier = {
							modifier = mongolian_banners_modifier
						}
					}
					else_if = {
						limit = {
							state = 604
						}
						add_dynamic_modifier = {
							modifier = qinghai_modifier
						}
					}
					else_if = {
						limit = {
							region = 145
							NOT = {
								state = 619
								has_dynamic_modifier = {
									modifier = mongolian_banners_modifier
								}
							}	
						}
						add_dynamic_modifier = {
							modifier = xinjiang_modifier
						}
					}
					else_if = {
						limit = {
							state = 619
							NOT = { has_state_flag = kumul_abolished }
						}
						add_dynamic_modifier = {
							modifier = kumul_modifier
						}
					}
					else_if = {
						limit = {
							OR = {
								state = 325
								state = 599
								state = 601
								state = 603
								state = 1065
								state = 1066
							}
						}
						add_dynamic_modifier = {
							modifier = xinan_modifier
						}
					}
				}
			}
		}
	}
	on_unit_leader_created = { # This uses the UNIT LEADER sub scope of a character, FROM == country
		effect = {
			character = {
				if = {
					limit = {	
						FROM = { has_cosmetic_tag = RAJ_UK }
					}	
					ROOT = {
						add_unit_leader_trait = trait_royalist
					}					
				}
			}
		}	
	}

#	on_weekly = {
#		effect = {
#			# unit limit calculations
#			country_event = ww1_political.4
#		}
#	}

	on_monthly = {
		effect = {

			# maintain list of guarantors
			if = {
				limit = {
					has_global_flag = tgwr_Economy_Logging
					is_debug = yes
				}

				#unit limits logging
				log = "tgwr_Unit_Limit_Metrics;[GetDateText];[Root.GetTag];[?num_actual_divisions];[?max_divisions]"
			}

			##TGWR PIN : check for demobilization on monthly basis
			#Demobilization check for the AI
			if = {
				limit = {
					is_ai = yes
				}
				country_event = { id = ww1_political.5 days = 6 }
			}

			#Reduce units check for the AI
			if = {
				limit = {
					is_ai = yes
					NOT = { has_country_flag = has_reduce_units_check }
				}
				set_country_flag = has_reduce_units_check
					
			}
		}
	}

	on_peaceconference_started = {
		effect = {
			if = {
				limit = {
					FROM = {
						tag = BNT
						is_in_faction = no
						is_subject = no
					}
					ROOT = {
						tag = SER
						has_country_flag = SER_war_on_BNT
						owns_state = 107
					}
				}
				SER = {
					annex_country = {
						target = BNT
						transfer_troops = no
					}
					set_country_flag = SER_annexation_of_BNT
					every_state = {
						limit = {
							OR = {
								is_core_of = BNT
								is_claimed_by = BNT
							}							
						}
						remove_claim_by = BNT
						remove_core_of = BNT
					}
					country_event = {
						id = ww1_serbia.150
					}
				}
			}
		}
	}
	on_subject_autonomy_level_change = {
		effect = {
			if = {
				limit = {
					is_in_faction = yes
					has_war = no				
					OR = {
						has_autonomy_state = autonomy_tgwr_protectorate
						has_autonomy_state = autonomy_tgwr_informal_protectorate
						has_autonomy_state = autonomy_tgwr_ottoman_emirate
						has_autonomy_state = autonomy_tgwr_concession
					}
				}
				leave_faction = yes
				OVERLORD = {
					diplomatic_relation = {
						country = PREV
						relation = military_access
						active = yes
					}
				}
			}
			else_if = {
				limit = {
					is_subject = yes
					is_in_faction = no
					OVERLORD = {
						is_in_faction = yes
					}
				}
				OVERLORD = {
					add_to_faction = ROOT
				}
			}
		}
	}
	#FROM is the one that joins the faction
	on_create_faction = {
		effect = {
			every_subject_country = {
				limit = {
					has_war = no				
					OR = {
						has_autonomy_state = autonomy_tgwr_protectorate
						has_autonomy_state = autonomy_tgwr_informal_protectorate
						has_autonomy_state = autonomy_tgwr_ottoman_emirate
						has_autonomy_state = autonomy_tgwr_concession
					}
				}
				leave_faction = yes
				OVERLORD = {
					diplomatic_relation = {
						country = PREV
						relation = military_access
						active = yes
					}
				}
				country_event = { id = ww1_political.7 hours = 1 } #needed if the faction leader is at war, don't ask
			}
			FROM = {
				if = {
					limit = {
						has_war = no				
						OR = {
							has_autonomy_state = autonomy_tgwr_protectorate
							has_autonomy_state = autonomy_tgwr_informal_protectorate
							has_autonomy_state = autonomy_tgwr_ottoman_emirate
							has_autonomy_state = autonomy_tgwr_concession
						}
					}
					leave_faction = yes
					OVERLORD = {
						diplomatic_relation = {
							country = PREV
							relation = military_access
							active = yes
						}
					}
					country_event = { id = ww1_political.7 hours = 1 } #needed if the faction leader is at war, don't ask
				}
			}
		}
	}
	#ROOT is the government in exile, FROM is the country that is hosting the government in exile.
	on_government_exiled = {
		effect = {
			log = "[GetDateText]: [ROOT.GetName] has been exiled to [FROM.GetName]"
		}
	}
	#ROOT is sender, FROM is receiver.
	on_send_volunteers = {
		effect = {
			log = "[GetDateText]: [ROOT.GetName] has sent volunteers to [FROM.GetName]"
		}
	}
	#ROOT is the country that sent, FROM is the country that accepted.
	on_send_expeditionary_force = {
		effect = {
			log = "[GetDateText]: [ROOT.GetName] has sent an expeditionary force to [FROM.GetName]"
		}
	}
	#ROOT is the country that is lending, FROM is the country that is receiving.
	on_lend_lease = {
		effect = {
			log = "[GetDateText]: [ROOT.GetName] has lent equipment to [FROM.GetName]"
		}
	}
	#ROOT is the country which guarantees, FROM is the country that is guaranteed.
	on_guarantee = {
		effect = {
			log = "[GetDateText]: [ROOT.GetName] has guaranteed [FROM.GetName]"
		}
	}
	#ROOT is the wargoal owner, FROM is the wargoal target
	on_generate_wargoal = {
		effect = {
			log = "[GetDateText]: [ROOT.GetName] has generated a wargoal against [FROM.GetName]"
		}
	}
	#ROOT is the new faction leader FROM is the old faction leader
	on_assume_faction_leadership = {
		effect = {
			# Entente leader transfer
			if = {
				limit = {
					FROM = { has_country_flag = entente_leader }
					is_great_war_ongoing = yes
				}
				FROM = {
					clr_country_flag = entente_leader
				}
				set_country_flag = entente_leader
			}
			log = "[GetDateText]: [ROOT.GetName] has assumed the leadership of [ROOT.GetFactionName] from [FROM.GetName]"
		}
	}
}
